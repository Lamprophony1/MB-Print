'use strict';

const React = require('react');

const q = require('q');

const Isvg = require('react-inlinesvg');

const R = require('ramda');

const DOM = React.DOM;
const ce = React.createElement;

const AdvancedSettingsModal = require('../ui/views/printSettings/advancedSettingsModal');

const LinkClickUtils = require('../utils/linkClick');

const UrlConst = require('../constants/urls').url;

const {
  Actions
} = require('../constants/print_settings');

const printSettingsActions = {
  toggleProp(key) {
    this.dispatch('MB_TOGGLE_PROP', {
      key
    });
  },

  bulkToggleProp(active) {
    this.dispatch('MB_BULK_TOGGLE_PROPS', {
      active
    });
  },

  resetToDefault(key) {
    this.dispatch('MB_RESET_TO_DEFAULT', {
      key
    });
  },

  resetAllToDefault() {
    this.dispatch('MB_RESET_ALL_TO_DEFAULT');
  },

  removeAllSettings() {
    this.dispatch('MB_REMOVE_ALL_SETTINGS');
  },

  getExtruderTypes(extruderSchema, authenticated) {
    this.dispatch('GET_EXTRUDER_TYPES', {
      extruderSchema,
      authenticated
    });
  },

  getSupportedConfigurations() {
    this.dispatch('GET_SUPPORTED_CONFIGURATIONS');
  },

  loadSchema(payload) {
    /**
     * Requires printer id to avoid unnecessary changes to
     * PrintSettingsStore state. Only update the store given the
     * printer id matches the currently selected printer id
     *
     * payload
     *  id:         printer id
     *  addDelay:   an option to add a delay of ~3 seconds to allow time
     *              for the RFID reader to read the spool tags. (Only
     *              used in makerbot-printer.js' updateSpoolMaterialsFrom-
     *              SystemInfo)
     *
     * -- Ray
     **/
    const currentPrinter = this.flux.store('PrinterStore').getSelectedPrinter(); // For archetype printers, exit out of loadSchema
    // Later note: This doesn't actually work, and moreover, it really shouldn't.
    // I don't see a reason why an archetype printer's schema shouldn't be loaded,
    // Leaving this here for now, in case removing it breaks something,
    // but will have to look into the necessity of this line in the future
    // xoxo Leor
    // Discovered this seems to help when loading old project versions

    if (!currentPrinter) return;

    if (payload && payload.id === currentPrinter.getId()) {
      if (payload.spoolsInfo) {
        return q().delay(0).then(() => this.dispatch('MB_GET_PRINTER_SCHEMA', {
          spoolsInfo: payload.spoolsInfo
        }));
      }

      return q().delay(0).then(() => this.dispatch('MB_GET_PRINTER_SCHEMA', {}));
    }
  },

  launchAdvSettingsModal(flux, extraProps) {
    this.dispatch('MB_PRINT_MODE_MENU_OPENED');
    flux.getService('ModalService').show(ce(AdvancedSettingsModal, R.merge(extraProps, {
      flux
    })), {
      title: DOM.a({
        className: 'supportLink',
        onClick: () => {
          LinkClickUtils.clickAction(flux, 'custom_print_modes_link_clicked', UrlConst.customPrintModes);
        }
      }, extraProps.i18n('mb:printSettings.advancedSettings.title'), ce(Isvg, {
        className: 'helperLinkIcon',
        src: 'icons/helpful-link-white.svg'
      })),
      modalClass: 'narrow-padding advanced-settings-modal-container'
    });
  },

  closeAdvSettingsModal(flux, selectedPreset) {
    flux.getService('ModalService').hide();
    this.dispatch(Actions.CloseModal, {
      selectedPreset
    });
  },

  // create a preset in memory and save it to user_config
  createPreset(name, originalPrintMode) {
    const store = this.flux.store('PrintSettingsStore');
    const deferred = q.defer();
    const errorMsg = R.cond([[R.isNil, R.always('Preset needs a name')], [store.hasPresetWithName, R.always('Preset with that name already exists')], [R.T, R.always('Unknown error')]]);

    if (name && !store.hasPresetWithName(name)) {
      this.dispatch(Actions.CreatePreset, {
        name,
        originalPrintMode
      });
      deferred.resolve();
    } else {
      const error = errorMsg(name);
      this.dispatch(Actions.PresetError, {
        error
      });
      deferred.reject(error);
    }

    return deferred.promise;
  },

  // edit the currently enabled in-memory preset and save it to user_config
  updatePreset(name) {
    this.dispatch(Actions.UpdatePreset, {
      name
    });
  },

  // export the current preset to a file
  writePreset(name) {
    this.dispatch(Actions.WritePreset, {
      name
    });
  },

  destroyPreset(name) {
    this.dispatch(Actions.DestroyPreset, {
      name
    });
  },

  readPresets() {
    this.dispatch(Actions.ReadPresets);
  },

  applyPreset(name) {
    this.dispatch(Actions.ApplyPreset, {
      name
    });
  },

  unapplyPreset() {
    this.dispatch(Actions.UnapplyPreset);
  },

  renamePreset(name) {
    this.dispatch(Actions.RenamePreset, {
      name
    });
  },

  revertChanges() {
    this.dispatch(Actions.RevertChanges);
  },

  updateExtruder() {
    this.dispatch(Actions.UpdateExtruder);
  },

  updateExtruderPair() {
    this.dispatch(Actions.UpdateExtruderPair);
  },

  updateMaterial(index, val) {
    this.dispatch(Actions.UpdateMaterial, {
      index,
      val
    });
  },

  updateMaterials(payload) {
    this.dispatch(Actions.UpdateMaterials, payload);
  },

  updateSupports(supportExtruder, supportType) {
    this.dispatch(Actions.UpdateSupports, {
      supportExtruder,
      supportType
    });
  },

  updatePrintMode(printMode) {
    this.dispatch(Actions.UpdatePrintMode, printMode);
  },

  updatePurgeWallCenter(purgeWallCenter) {
    // cancel builds (aka. slices) when moving purge tower around
    const viewerStore = this.flux.store('ViewerStore');
    const activeTray = viewerStore.getActiveTray();
    this.flux.actions.printer.cancelBuildsForTray(activeTray.getId());
    this.dispatch(Actions.UpdatePurgeWallCenter, purgeWallCenter);
    this.dispatch('PURGE_TOWER_CHANGED');
  },

  updatePurgeWall() {
    this.dispatch('PURGE_TOWER_CHANGED');
  }

};
module.exports = printSettingsActions;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByaW50U2V0dGluZ3NBY3Rpb25zLmpzIl0sIm5hbWVzIjpbIlJlYWN0IiwicmVxdWlyZSIsInEiLCJJc3ZnIiwiUiIsIkRPTSIsImNlIiwiY3JlYXRlRWxlbWVudCIsIkFkdmFuY2VkU2V0dGluZ3NNb2RhbCIsIkxpbmtDbGlja1V0aWxzIiwiVXJsQ29uc3QiLCJ1cmwiLCJBY3Rpb25zIiwicHJpbnRTZXR0aW5nc0FjdGlvbnMiLCJ0b2dnbGVQcm9wIiwia2V5IiwiZGlzcGF0Y2giLCJidWxrVG9nZ2xlUHJvcCIsImFjdGl2ZSIsInJlc2V0VG9EZWZhdWx0IiwicmVzZXRBbGxUb0RlZmF1bHQiLCJyZW1vdmVBbGxTZXR0aW5ncyIsImdldEV4dHJ1ZGVyVHlwZXMiLCJleHRydWRlclNjaGVtYSIsImF1dGhlbnRpY2F0ZWQiLCJnZXRTdXBwb3J0ZWRDb25maWd1cmF0aW9ucyIsImxvYWRTY2hlbWEiLCJwYXlsb2FkIiwiY3VycmVudFByaW50ZXIiLCJmbHV4Iiwic3RvcmUiLCJnZXRTZWxlY3RlZFByaW50ZXIiLCJpZCIsImdldElkIiwic3Bvb2xzSW5mbyIsImRlbGF5IiwidGhlbiIsImxhdW5jaEFkdlNldHRpbmdzTW9kYWwiLCJleHRyYVByb3BzIiwiZ2V0U2VydmljZSIsInNob3ciLCJtZXJnZSIsInRpdGxlIiwiYSIsImNsYXNzTmFtZSIsIm9uQ2xpY2siLCJjbGlja0FjdGlvbiIsImN1c3RvbVByaW50TW9kZXMiLCJpMThuIiwic3JjIiwibW9kYWxDbGFzcyIsImNsb3NlQWR2U2V0dGluZ3NNb2RhbCIsInNlbGVjdGVkUHJlc2V0IiwiaGlkZSIsIkNsb3NlTW9kYWwiLCJjcmVhdGVQcmVzZXQiLCJuYW1lIiwib3JpZ2luYWxQcmludE1vZGUiLCJkZWZlcnJlZCIsImRlZmVyIiwiZXJyb3JNc2ciLCJjb25kIiwiaXNOaWwiLCJhbHdheXMiLCJoYXNQcmVzZXRXaXRoTmFtZSIsIlQiLCJDcmVhdGVQcmVzZXQiLCJyZXNvbHZlIiwiZXJyb3IiLCJQcmVzZXRFcnJvciIsInJlamVjdCIsInByb21pc2UiLCJ1cGRhdGVQcmVzZXQiLCJVcGRhdGVQcmVzZXQiLCJ3cml0ZVByZXNldCIsIldyaXRlUHJlc2V0IiwiZGVzdHJveVByZXNldCIsIkRlc3Ryb3lQcmVzZXQiLCJyZWFkUHJlc2V0cyIsIlJlYWRQcmVzZXRzIiwiYXBwbHlQcmVzZXQiLCJBcHBseVByZXNldCIsInVuYXBwbHlQcmVzZXQiLCJVbmFwcGx5UHJlc2V0IiwicmVuYW1lUHJlc2V0IiwiUmVuYW1lUHJlc2V0IiwicmV2ZXJ0Q2hhbmdlcyIsIlJldmVydENoYW5nZXMiLCJ1cGRhdGVFeHRydWRlciIsIlVwZGF0ZUV4dHJ1ZGVyIiwidXBkYXRlRXh0cnVkZXJQYWlyIiwiVXBkYXRlRXh0cnVkZXJQYWlyIiwidXBkYXRlTWF0ZXJpYWwiLCJpbmRleCIsInZhbCIsIlVwZGF0ZU1hdGVyaWFsIiwidXBkYXRlTWF0ZXJpYWxzIiwiVXBkYXRlTWF0ZXJpYWxzIiwidXBkYXRlU3VwcG9ydHMiLCJzdXBwb3J0RXh0cnVkZXIiLCJzdXBwb3J0VHlwZSIsIlVwZGF0ZVN1cHBvcnRzIiwidXBkYXRlUHJpbnRNb2RlIiwicHJpbnRNb2RlIiwiVXBkYXRlUHJpbnRNb2RlIiwidXBkYXRlUHVyZ2VXYWxsQ2VudGVyIiwicHVyZ2VXYWxsQ2VudGVyIiwidmlld2VyU3RvcmUiLCJhY3RpdmVUcmF5IiwiZ2V0QWN0aXZlVHJheSIsImFjdGlvbnMiLCJwcmludGVyIiwiY2FuY2VsQnVpbGRzRm9yVHJheSIsIlVwZGF0ZVB1cmdlV2FsbENlbnRlciIsInVwZGF0ZVB1cmdlV2FsbCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLE1BQU1BLEtBQUssR0FBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBckI7O0FBQ0EsTUFBTUMsQ0FBQyxHQUFHRCxPQUFPLENBQUMsR0FBRCxDQUFqQjs7QUFDQSxNQUFNRSxJQUFJLEdBQUdGLE9BQU8sQ0FBQyxpQkFBRCxDQUFwQjs7QUFDQSxNQUFNRyxDQUFDLEdB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SixPQUFPLENBQUNxRixlQUF0QixFQUF1Q3RFLE9BQXZDO0FBQ0gsR0F0S3dCOztBQXdLekJ1RSxFQUFBQSxjQUFjLENBQUNDLGVBQUQsRUFBa0JDLFdBQWxCLEVBQStCO0FBQ3pDLFNBQUtwRixRQUFMLENBQWNKLE9BQU8sQ0FBQ3lGLGNBQXRCLEVBQXNDO0FBQUVGLE1BQUFBLGVBQUY7QUFBbUJDLE1BQUFBO0FBQW5CLEtBQXRDO0FBQ0gsR0ExS3dCOztBQTRLekJFLEVBQUFBLGVBQWUsQ0FBQ0MsU0FBRCxFQUFZO0FBQ3ZCLFNBQUt2RixRQUFMLENBQWNKLE9BQU8sQ0FBQzRGLGVBQXRCLEVBQXVDRCxTQUF2QztBQUNILEdBOUt3Qjs7QUErS3pCRSxFQUFBQSxxQkFBcUIsQ0FBQ0MsZUFBRCxFQUFrQjtBQUNuQztBQUNBLFVBQU1DLFdBQVcsR0FBRyxLQUFLOUUsSUFBTCxDQUFVQyxLQUFWLENBQWdCLGFBQWhCLENBQXBCO0FBQ0EsVUFBTThFLFVBQVUsR0FBR0QsV0FBVyxDQUFDRSxhQUFaLEVBQW5CO0FBQ0EsU0FBS2hGLElBQUwsQ0FBVWlGLE9BQVYsQ0FBa0JDLE9BQWxCLENBQTBCQyxtQkFBMUIsQ0FBOENKLFVBQVUsQ0FBQzNFLEtBQVgsRUFBOUM7QUFFQSxTQUFLakIsUUFBTCxDQUFjSixPQUFPLENBQUNxRyxxQkFBdEIsRUFBNkNQLGVBQTdDO0FBQ0EsU0FBSzFGLFFBQUwsQ0FBYyxxQkFBZDtBQUNILEdBdkx3Qjs7QUF3THpCa0csRUFBQUEsZUFBZSxHQUFHO0FBQ2QsU0FBS2xHLFFBQUwsQ0FBYyxxQkFBZDtBQUNIOztBQTFMd0IsQ0FBN0I7QUE2TEFtRyxNQUFNLENBQUNDLE9BQVAsR0FBaUJ2RyxvQkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG5jb25zdCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XHJcbmNvbnN0IHEgPSByZXF1aXJlKCdxJyk7XHJcbmNvbnN0IElzdmcgPSByZXF1aXJlKCdyZWFjdC1pbmxpbmVzdmcnKTtcclxuY29uc3QgUiA9IHJlcXVpcmUoJ3JhbWRhJyk7XHJcblxyXG5jb25zdCBET00gPSBSZWFjdC5ET007XHJcbmNvbnN0IGNlID0gUmVhY3QuY3JlYXRlRWxlbWVudDtcclxuY29uc3QgQWR2YW5jZWRTZXR0aW5nc01vZGFsID0gcmVxdWlyZSgnLi4vdWkvdmlld3MvcHJpbnRTZXR0aW5ncy9hZHZhbmNlZFNldHRpbmdzTW9kYWwnKTtcclxuY29uc3QgTGlua0NsaWNrVXRpbHMgPSByZXF1aXJlKCcuLi91dGlscy9saW5rQ2xpY2snKTtcclxuY29uc3QgVXJsQ29uc3QgPSByZXF1aXJlKCcuLi9jb25zdGFudHMvdXJscycpLnVybDtcclxuY29uc3QgeyBBY3Rpb25zIH0gPSByZXF1aXJlKCcuLi9jb25zdGFudHMvcHJpbnRfc2V0dGluZ3MnKTtcclxuXHJcbmNvbnN0IHByaW50U2V0dGluZ3NBY3Rpb25zID0ge1xyXG4gICAgdG9nZ2xlUHJvcChrZXkpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoKCdNQl9UT0dHTEVfUFJPUCcsIHsga2V5IH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBidWxrVG9nZ2xlUHJvcChhY3RpdmUpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoKCdNQl9CVUxLX1RPR0dMRV9QUk9QUycsIHsgYWN0aXZlIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICByZXNldFRvRGVmYXVsdChrZXkpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoKCdNQl9SRVNFVF9UT19ERUZBVUxUJywgeyBrZXkgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlc2V0QWxsVG9EZWZhdWx0KCkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goJ01CX1JFU0VUX0FMTF9UT19ERUZBVUxUJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbW92ZUFsbFNldHRpbmdzKCkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goJ01CX1JFTU9WRV9BTExfU0VUVElOR1MnKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0RXh0cnVkZXJUeXBlcyhleHRydWRlclNjaGVtYSwgYXV0aGVudGljYXRlZCkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goJ0dFVF9FWFRSVURFUl9UWVBFUycsIHsgZXh0cnVkZXJTY2hlbWEsIGF1dGhlbnRpY2F0ZWQgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldFN1cHBvcnRlZENvbmZpZ3VyYXRpb25zKCkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goJ0dFVF9TVVBQT1JURURfQ09ORklHVVJBVElPTlMnKTtcclxuICAgIH0sXHJcblxyXG4gICAgbG9hZFNjaGVtYShwYXlsb2FkKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmVxdWlyZXMgcHJpbnRlciBpZCB0byBhdm9pZCB1bm5lY2Vzc2FyeSBjaGFuZ2VzIHRvXHJcbiAgICAgICAgICogUHJpbnRTZXR0aW5nc1N0b3JlIHN0YXRlLiBPbmx5IHVwZGF0ZSB0aGUgc3RvcmUgZ2l2ZW4gdGhlXHJcbiAgICAgICAgICogcHJpbnRlciBpZCBtYXRjaGVzIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgcHJpbnRlciBpZFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogcGF5bG9hZFxyXG4gICAgICAgICAqICBpZDogICAgICAgICBwcmludGVyIGlkXHJcbiAgICAgICAgICogIGFkZERlbGF5OiAgIGFuIG9wdGlvbiB0byBhZGQgYSBkZWxheSBvZiB+MyBzZWNvbmRzIHRvIGFsbG93IHRpbWVcclxuICAgICAgICAgKiAgICAgICAgICAgICAgZm9yIHRoZSBSRklEIHJlYWRlciB0byByZWFkIHRoZSBzcG9vbCB0YWdzLiAoT25seVxyXG4gICAgICAgICAqICAgICAgICAgICAgICB1c2VkIGluIG1ha2VyYm90LXByaW50ZXIuanMnIHVwZGF0ZVNwb29sTWF0ZXJpYWxzRnJvbS1cclxuICAgICAgICAgKiAgICAgICAgICAgICAgU3lzdGVtSW5mbylcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIC0tIFJheVxyXG4gICAgICAgICAqKi9cclxuICAgICAgICBjb25zdCBjdXJyZW50UHJpbnRlciA9IHRoaXMuZmx1eC5zdG9yZSgnUHJpbnRlclN0b3JlJykuZ2V0U2VsZWN0ZWRQcmludGVyKCk7XHJcbiAgICAgICAgLy8gRm9yIGFyY2hldHlwZSBwcmludGVycywgZXhpdCBvdXQgb2YgbG9hZFNjaGVtYVxyXG4gICAgICAgIC8vIExhdGVyIG5vdGU6IFRoaXMgZG9lc24ndCBhY3R1YWxseSB3b3JrLCBhbmQgbW9yZW92ZXIsIGl0IHJlYWxseSBzaG91bGRuJ3QuXHJcbiAgICAgICAgLy8gSSBkb24ndCBzZWUgYSByZWFzb24gd2h5IGFuIGFyY2hldHlwZSBwcmludGVyJ3Mgc2NoZW1hIHNob3VsZG4ndCBiZSBsb2FkZWQsXHJcbiAgICAgICAgLy8gTGVhdmluZyB0aGlzIGhlcmUgZm9yIG5vdywgaW4gY2FzZSByZW1vdmluZyBpdCBicmVha3Mgc29tZXRoaW5nLFxyXG4gICAgICAgIC8vIGJ1dCB3aWxsIGhhdmUgdG8gbG9vayBpbnRvIHRoZSBuZWNlc3NpdHkgb2YgdGhpcyBsaW5lIGluIHRoZSBmdXR1cmVcclxuICAgICAgICAvLyB4b3hvIExlb3JcclxuICAgICAgICAvLyBEaXNjb3ZlcmVkIHRoaXMgc2VlbXMgdG8gaGVscCB3aGVuIGxvYWRpbmcgb2xkIHByb2plY3QgdmVyc2lvbnNcclxuICAgICAgICBpZiAoIWN1cnJlbnRQcmludGVyKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmIChwYXlsb2FkICYmIHBheWxvYWQuaWQgPT09IGN1cnJlbnRQcmludGVyLmdldElkKCkpIHtcclxuICAgICAgICAgICAgaWYgKHBheWxvYWQuc3Bvb2xzSW5mbykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHEoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5kZWxheSgwKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goJ01CX0dFVF9QUklOVEVSX1NDSEVNQScsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwb29sc0luZm86IHBheWxvYWQuc3Bvb2xzSW5mbyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcSgpXHJcbiAgICAgICAgICAgICAgICAuZGVsYXkoMClcclxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHRoaXMuZGlzcGF0Y2goJ01CX0dFVF9QUklOVEVSX1NDSEVNQScsIHt9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBsYXVuY2hBZHZTZXR0aW5nc01vZGFsKGZsdXgsIGV4dHJhUHJvcHMpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoKCdNQl9QUklOVF9NT0RFX01FTlVfT1BFTkVEJyk7XHJcbiAgICAgICAgZmx1eC5nZXRTZXJ2aWNlKCdNb2RhbFNlcnZpY2UnKS5zaG93KGNlKEFkdmFuY2VkU2V0dGluZ3NNb2RhbCwgUi5tZXJnZShleHRyYVByb3BzLCB7IGZsdXggfSkpLCB7XHJcbiAgICAgICAgICAgIHRpdGxlOiBET00uYShcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzdXBwb3J0TGluaycsXHJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljazogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rQ2xpY2tVdGlscy5jbGlja0FjdGlvbihmbHV4LCAnY3VzdG9tX3ByaW50X21vZGVzX2xpbmtfY2xpY2tlZCcsIFVybENvbnN0LmN1c3RvbVByaW50TW9kZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXh0cmFQcm9wcy5pMThuKCdtYjpwcmludFNldHRpbmdzLmFkdmFuY2VkU2V0dGluZ3MudGl0bGUnKSxcclxuICAgICAgICAgICAgICAgIGNlKElzdmcsIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdoZWxwZXJMaW5rSWNvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgc3JjOiAnaWNvbnMvaGVscGZ1bC1saW5rLXdoaXRlLnN2ZycsXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBtb2RhbENsYXNzOiAnbmFycm93LXBhZGRpbmcgYWR2YW5jZWQtc2V0dGluZ3MtbW9kYWwtY29udGFpbmVyJyxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xvc2VBZHZTZXR0aW5nc01vZGFsKGZsdXgsIHNlbGVjdGVkUHJlc2V0KSB7XHJcbiAgICAgICAgZmx1eC5nZXRTZXJ2aWNlKCdNb2RhbFNlcnZpY2UnKS5oaWRlKCk7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaChBY3Rpb25zLkNsb3NlTW9kYWwsIHsgc2VsZWN0ZWRQcmVzZXQgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIGNyZWF0ZSBhIHByZXNldCBpbiBtZW1vcnkgYW5kIHNhdmUgaXQgdG8gdXNlcl9jb25maWdcclxuICAgIGNyZWF0ZVByZXNldChuYW1lLCBvcmlnaW5hbFByaW50TW9kZSkge1xyXG4gICAgICAgIGNvbnN0IHN0b3JlID0gdGhpcy5mbHV4LnN0b3JlKCdQcmludFNldHRpbmdzU3RvcmUnKTtcclxuICAgICAgICBjb25zdCBkZWZlcnJlZCA9IHEuZGVmZXIoKTtcclxuICAgICAgICBjb25zdCBlcnJvck1zZyA9IFIuY29uZChbXHJcbiAgICAgICAgICAgIFtSLmlzTmlsLCBSLmFsd2F5cygnUHJlc2V0IG5lZWRzIGEgbmFtZScpXSxcclxuICAgICAgICAgICAgW3N0b3JlLmhhc1ByZXNldFdpdGhOYW1lLCBSLmFsd2F5cygnUHJlc2V0IHdpdGggdGhhdCBuYW1lIGFscmVhZHkgZXhpc3RzJyldLFxyXG4gICAgICAgICAgICBbUi5ULCBSLmFsd2F5cygnVW5rbm93biBlcnJvcicpXSxcclxuICAgICAgICBdKTtcclxuXHJcbiAgICAgICAgaWYgKG5hbWUgJiYgIXN0b3JlLmhhc1ByZXNldFdpdGhOYW1lKG5hbWUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goQWN0aW9ucy5DcmVhdGVQcmVzZXQsIHsgbmFtZSwgb3JpZ2luYWxQcmludE1vZGUgfSk7XHJcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IGVycm9yTXNnKG5hbWUpO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoKEFjdGlvbnMuUHJlc2V0RXJyb3IsIHsgZXJyb3IgfSk7XHJcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gZWRpdCB0aGUgY3VycmVudGx5IGVuYWJsZWQgaW4tbWVtb3J5IHByZXNldCBhbmQgc2F2ZSBpdCB0byB1c2VyX2NvbmZpZ1xyXG4gICAgdXBkYXRlUHJlc2V0KG5hbWUpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoKEFjdGlvbnMuVXBkYXRlUHJlc2V0LCB7IG5hbWUgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIGV4cG9ydCB0aGUgY3VycmVudCBwcmVzZXQgdG8gYSBmaWxlXHJcbiAgICB3cml0ZVByZXNldChuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaChBY3Rpb25zLldyaXRlUHJlc2V0LCB7IG5hbWUgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGRlc3Ryb3lQcmVzZXQobmFtZSkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goQWN0aW9ucy5EZXN0cm95UHJlc2V0LCB7IG5hbWUgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlYWRQcmVzZXRzKCkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goQWN0aW9ucy5SZWFkUHJlc2V0cyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGFwcGx5UHJlc2V0KG5hbWUpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoKEFjdGlvbnMuQXBwbHlQcmVzZXQsIHsgbmFtZSB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgdW5hcHBseVByZXNldCgpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoKEFjdGlvbnMuVW5hcHBseVByZXNldCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbmFtZVByZXNldChuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaChBY3Rpb25zLlJlbmFtZVByZXNldCwgeyBuYW1lIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICByZXZlcnRDaGFuZ2VzKCkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goQWN0aW9ucy5SZXZlcnRDaGFuZ2VzKTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlRXh0cnVkZXIoKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaChBY3Rpb25zLlVwZGF0ZUV4dHJ1ZGVyKTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlRXh0cnVkZXJQYWlyKCkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goQWN0aW9ucy5VcGRhdGVFeHRydWRlclBhaXIpO1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVNYXRlcmlhbChpbmRleCwgdmFsKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaChBY3Rpb25zLlVwZGF0ZU1hdGVyaWFsLCB7IGluZGV4LCB2YWwgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZU1hdGVyaWFscyhwYXlsb2FkKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaChBY3Rpb25zLlVwZGF0ZU1hdGVyaWFscywgcGF5bG9hZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZVN1cHBvcnRzKHN1cHBvcnRFeHRydWRlciwgc3VwcG9ydFR5cGUpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoKEFjdGlvbnMuVXBkYXRlU3VwcG9ydHMsIHsgc3VwcG9ydEV4dHJ1ZGVyLCBzdXBwb3J0VHlwZSB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlUHJpbnRNb2RlKHByaW50TW9kZSkge1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goQWN0aW9ucy5VcGRhdGVQcmludE1vZGUsIHByaW50TW9kZSk7XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlUHVyZ2VXYWxsQ2VudGVyKHB1cmdlV2FsbENlbnRlcikge1xyXG4gICAgICAgIC8vIGNhbmNlbCBidWlsZHMgKGFrYS4gc2xpY2VzKSB3aGVuIG1vdmluZyBwdXJnZSB0b3dlciBhcm91bmRcclxuICAgICAgICBjb25zdCB2aWV3ZXJTdG9yZSA9IHRoaXMuZmx1eC5zdG9yZSgnVmlld2VyU3RvcmUnKTtcclxuICAgICAgICBjb25zdCBhY3RpdmVUcmF5ID0gdmlld2VyU3RvcmUuZ2V0QWN0aXZlVHJheSgpO1xyXG4gICAgICAgIHRoaXMuZmx1eC5hY3Rpb25zLnByaW50ZXIuY2FuY2VsQnVpbGRzRm9yVHJheShhY3RpdmVUcmF5LmdldElkKCkpO1xyXG5cclxuICAgICAgICB0aGlzLmRpc3BhdGNoKEFjdGlvbnMuVXBkYXRlUHVyZ2VXYWxsQ2VudGVyLCBwdXJnZVdhbGxDZW50ZXIpO1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2goJ1BVUkdFX1RPV0VSX0NIQU5HRUQnKTtcclxuICAgIH0sXHJcbiAgICB1cGRhdGVQdXJnZVdhbGwoKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaCgnUFVSR0VfVE9XRVJfQ0hBTkdFRCcpO1xyXG4gICAgfSxcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcHJpbnRTZXR0aW5nc0FjdGlvbnM7XHJcbiJdfQ==
