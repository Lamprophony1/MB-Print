'use strict';

class PutFileJob {
  constructor(printer, transferId, args) {
    this._printer = printer;
    this._transferId = transferId;
    this._args = args;
    this._cancelled = false;
    this._promise = null;
  }

  start() {
    this._promise = this._printer.invoke('Put', [this._transferId].concat(this._args)).catch(err => {
      if (!this._cancelled) throw err;
    });
    return this._promise;
  }

  cancel() {
    return this._printer.invoke('cancelPut', [this._transferId]).then(() => {
      this._cancelled = true;
    });
  }

  isPending() {
    if (this._promise) return this._promise.isPending();else return false;
  }

}

class FileTransferHelper {
  constructor(printer) {
    this._printer = printer;
    this._transferId = 0;
  }

  _increTransferId() {
    return this._transferId++ % 10000;
  }

  putFileJob(localPath, remotePath, blockSize, progressCallback) {
    return new PutFileJob(this._printer, this._increTransferId(), [localPath, remotePath, blockSize, progressCallback]);
  }

}

module.exports = FileTransferHelper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGVfdHJhbnNmZXJfaGVscGVyLmpzIl0sIm5hbWVzIjpbIlB1dEZpbGVKb2IiLCJjb25zdHJ1Y3RvciIsInByaW50ZXIiLCJ0cmFuc2ZlcklkIiwiYXJncyIsIl9wcmludGVyIiwiX3RyYW5zZmVySWQiLCJfYXJncyIsIl9jYW5jZWxsZWQiLCJfcHJvbWlzZSIsInN0YXJ0IiwiaW52b2tlIiwiY29uY2F0IiwiY2F0Y2giLCJlcnIiLCJjYW5jZWwiLCJ0aGVuIiwiaXNQZW5kaW5nIiwiRmlsZVRyYW5zZmVySGVscGVyIiwiX2luY3JlVHJhbnNmZXJJZCIsInB1dEZpbGVKb2IiLCJsb2NhbFBhdGgiLCJyZW1vdGVQYXRoIiwiYmxvY2tTaXplIiwicHJvZ3Jlc3NDYWxsYmFjayIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLE1BQU1BLFVBQU4sQ0FBaUI7QUFDYkMsRUFBQUEsV0FBVyxDQUFDQyxPQUFELEVBQVVDLFVBQVYsRUFBc0JDLElBQXRCLEVBQTRCO0FBQ25DLFNBQUtDLFFBQUwsR0FBZ0JILE9BQWhCO0FBQ0EsU0FBS0ksV0FBTCxHQUFtQkgsVUFBbkI7QUFDQSxTQUFLSSxLQUFMLEdBQWFILElBQWI7QUFDQSxTQUFLSSxVQUFMLEdBQWtCLEtBQWxCO0FBRUEsU0FBS0MsUUFBTCxHQUFnQixJQUFoQjtBQUNIOztBQUVEQyxFQUFBQSxLQUFLLEdBQUc7QUFDSixTQUFLRCxRQUFMLEdBQWdCLEtBQUtKLFFBQUwsQ0FBY00sTUFBZCxDQUFxQixLQUFyQixFQUE0QixDQUFDLEtBQUtMLFdBQU4sRUFBbUJNLE1BQW5CLENBQTBCLEtBQUtMLEtBQS9CLENBQTVCLEVBQW1FTSxLQUFuRSxDQUF5RUMsR0FBRyxJQUFJO0FBQzVGLFVBQUksQ0FBQyxLQUFLTixVQUFWLEVBQXNCLE1BQU1NLEdBQU47QUFDekIsS0FGZSxDQUFoQjtBQUlBLFdBQU8sS0FBS0wsUUFBWjtBQUNIOztBQUVETSxFQUFBQSxNQUFNLEdBQUc7QUFDTCxXQUFPLEtBQUtWLFFBQUwsQ0FBY00sTUFBZCxDQUFxQixXQUFyQixFQUFrQyxDQUFDLEtBQUtMLFdBQU4sQ0FBbEMsRUFBc0RVLElBQXRELENBQTJELE1BQU07QUFDcEUsV0FBS1IsVUFBTCxHQUFrQixJQUFsQjtBQUNILEtBRk0sQ0FBUDtBQUdIOztBQUVEUyxFQUFBQSxTQUFTLEdBQUc7QUFDUixRQUFJLEtBQUtSLFFBQVQsRUFBbUIsT0FBTyxLQUFLQSxRQUFMLENBQWNRLFNBQWQsRUFBUCxDQUFuQixLQUNLLE9BQU8sS0FBUDtBQUNSOztBQTNCWTs7QUE4QmpCLE1BQU1DLGtCQUFOLENBQXlCO0FBQ3JCakIsRUFBQUEsV0FBVyxDQUFDQyxPQUFELEVBQVU7QUFDakIsU0FBS0csUUFBTCxHQUFnQkgsT0FBaEI7QUFDQSxTQUFLSSxXQUFMLEdBQW1CLENBQW5CO0FBQ0g7O0FBRURhLEVBQUFBLGdCQUFnQixHQUFHO0FBQ2YsV0FBTyxLQUFLYixXQUFMLEtBQXFCLEtBQTVCO0FBQ0g7O0FBRURjLEVBQUFBLFVBQVUsQ0FBQ0MsU0FBRCxFQUFZQyxVQUFaLEVBQXdCQyxTQUF4QixFQUFtQ0MsZ0JBQW5DLEVBQXFEO0FBQzNELFdBQU8sSUFBSXhCLFVBQUosQ0FBZSxLQUFLSyxRQUFwQixFQUE4QixLQUFLYyxnQkFBTCxFQUE5QixFQUF1RCxDQUMxREUsU0FEMEQsRUFFMURDLFVBRjBELEVBRzFEQyxTQUgwRCxFQUkxREMsZ0JBSjBELENBQXZELENBQVA7QUFNSDs7QUFqQm9COztBQW9CekJDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQlIsa0JBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxuY2xhc3MgUHV0RmlsZUpvYiB7XHJcbiAgICBjb25zdHJ1Y3RvcihwcmludGVyLCB0cmFuc2ZlcklkLCBhcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fcHJpbnRlciA9IHByaW50ZXI7XHJcbiAgICAgICAgdGhpcy5fdHJhbnNmZXJJZCA9IHRyYW5zZmVySWQ7XHJcbiAgICAgICAgdGhpcy5fYXJncyA9IGFyZ3M7XHJcbiAgICAgICAgdGhpcy5fY2FuY2VsbGVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuX3Byb21pc2UgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMuX3Byb21pc2UgPSB0aGlzLl9wcmludGVyLmludm9rZSgnUHV0JywgW3RoaXMuX3RyYW5zZmVySWRdLmNvbmNhdCh0aGlzLl9hcmdzKSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9jYW5jZWxsZWQpIHRocm93IGVycjtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb21pc2U7XHJcbiAgICB9XHJcblxyXG4gICAgY2FuY2VsKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wcmludGVyLmludm9rZSgnY2FuY2VsUHV0JywgW3RoaXMuX3RyYW5zZmVySWRdKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fY2FuY2VsbGVkID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpc1BlbmRpbmcoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Byb21pc2UpIHJldHVybiB0aGlzLl9wcm9taXNlLmlzUGVuZGluZygpO1xyXG4gICAgICAgIGVsc2UgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBGaWxlVHJhbnNmZXJIZWxwZXIge1xyXG4gICAgY29uc3RydWN0b3IocHJpbnRlcikge1xyXG4gICAgICAgIHRoaXMuX3ByaW50ZXIgPSBwcmludGVyO1xyXG4gICAgICAgIHRoaXMuX3RyYW5zZmVySWQgPSAwO1xyXG4gICAgfVxyXG5cclxuICAgIF9pbmNyZVRyYW5zZmVySWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zZmVySWQrKyAlIDEwMDAwO1xyXG4gICAgfVxyXG5cclxuICAgIHB1dEZpbGVKb2IobG9jYWxQYXRoLCByZW1vdGVQYXRoLCBibG9ja1NpemUsIHByb2dyZXNzQ2FsbGJhY2spIHtcclxuICAgICAgICByZXR1cm4gbmV3IFB1dEZpbGVKb2IodGhpcy5fcHJpbnRlciwgdGhpcy5faW5jcmVUcmFuc2ZlcklkKCksIFtcclxuICAgICAgICAgICAgbG9jYWxQYXRoLFxyXG4gICAgICAgICAgICByZW1vdGVQYXRoLFxyXG4gICAgICAgICAgICBibG9ja1NpemUsXHJcbiAgICAgICAgICAgIHByb2dyZXNzQ2FsbGJhY2ssXHJcbiAgICAgICAgXSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRmlsZVRyYW5zZmVySGVscGVyO1xyXG4iXX0=
