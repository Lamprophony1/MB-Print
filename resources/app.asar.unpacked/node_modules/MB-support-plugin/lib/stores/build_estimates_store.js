/**
 * @module BuildEstimateStore
 * @desc
 * The Build Estimate Store:
 * - listens to TOOLPATH_UNZIPPED action & opens the estimates modal here in the store.
 *
 * NOTE : BuildEstimateStore is mb only & is different from eagle-print/stores/buildStore's BUILD_TYPES.ESTIMATE
 *
 *
 * @author Ritika Shandilya
 */
'use strict';

const Fluxxor = require('fluxxor');

const Store = Fluxxor.createStore({
  actions: {
    TOOLPATH_UNZIPPED: 'onToolPathUnzipped',
    IMPORT_TOOLPATH_UNZIPPED: 'onToolPathUnzipped',
    CLEAR_BUILDS: 'onClearBuilds'
  },

  /**
   * @typedef {Object} BuildEstimateStore
   */
  initialize() {
    this._currentEstimate = null;
  },

  getCurrentEstimate() {
    return this._currentEstimate;
  },

  setCurrentEstimate(newEstimate) {
    this._currentEstimate = newEstimate;
  },

  onToolPathUnzipped(payload) {
    const extrusionDistances = payload.unzipped.metaData.extrusion_distances_mm;
    const extruderCount = extrusionDistances.length < 2 || extrusionDistances[1] <= 0 ? 1 : extrusionDistances.length;
    const estimateInfo = {
      time: payload.unzipped.metaData.duration_s,
      mass: payload.unzipped.metaData.extrusion_masses_g,
      distance: payload.unzipped.metaData.extrusion_distances_mm,
      botType: payload.unzipped.metaData.bot_type,
      material: payload.unzipped.metaData.materials,
      extruderCount
    };
    this.setCurrentEstimate({
      estimateInfo,
      task: payload.task
    });
  },

  onClearBuilds() {
    this.setCurrentEstimate(null);
  }

});
module.exports = Store;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1aWxkX2VzdGltYXRlc19zdG9yZS5qcyJdLCJuYW1lcyI6WyJGbHV4eG9yIiwicmVxdWlyZSIsIlN0b3JlIiwiY3JlYXRlU3RvcmUiLCJhY3Rpb25zIiwiVE9PTFBBVEhfVU5aSVBQRUQiLCJJTVBPUlRfVE9PTFBBVEhfVU5aSVBQRUQiLCJDTEVBUl9CVUlMRFMiLCJpbml0aWFsaXplIiwiX2N1cnJlbnRFc3RpbWF0ZSIsImdldEN1cnJlbnRFc3RpbWF0ZSIsInNldEN1cnJlbnRFc3RpbWF0ZSIsIm5ld0VzdGltYXRlIiwib25Ub29sUGF0aFVuemlwcGVkIiwicGF5bG9hZCIsImV4dHJ1c2lvbkRpc3RhbmNlcyIsInVuemlwcGVkIiwibWV0YURhdGEiLCJleHRydXNpb25fZGlzdGFuY2VzX21tIiwiZXh0cnVkZXJDb3VudCIsImxlbmd0aCIsImVzdGltYXRlSW5mbyIsInRpbWUiLCJkdXJhdGlvbl9zIiwibWFzcyIsImV4dHJ1c2lvbl9tYXNzZXNfZyIsImRpc3RhbmNlIiwiYm90VHlwZSIsImJvdF90eXBlIiwibWF0ZXJpYWwiLCJtYXRlcmlhbHMiLCJ0YXNrIiwib25DbGVhckJ1aWxkcyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFELENBQXZCOztBQUNBLE1BQU1DLEtBQUssR0FBR0YsT0FBTyxDQUFDRyxXQUFSLENBQW9CO0FBQzlCQyxFQUFBQSxPQUFPLEVBQUU7QUFDTEMsSUFBQUEsaUJBQWlCLEVBQUUsb0JBRGQ7QUFFTEMsSUFBQUEsd0JBQXdCLEVBQUUsb0JBRnJCO0FBR0xDLElBQUFBLFlBQVksRUFBRTtBQUhULEdBRHFCOztBQU85QjtBQUNKO0FBQ0E7QUFFSUMsRUFBQUEsVUFBVSxHQUFHO0FBQ1QsU0FBS0MsZ0JBQUwsR0FBd0IsSUFBeEI7QUFDSCxHQWI2Qjs7QUFlOUJDLEVBQUFBLGtCQUFrQixHQUFHO0FBQ2pCLFdBQU8sS0FBS0QsZ0JBQVo7QUFDSCxHQWpCNkI7O0FBbUI5QkUsRUFBQUEsa0JBQWtCLENBQUNDLFdBQUQsRUFBYztBQUM1QixTQUFLSCxnQkFBTCxHQUF3QkcsV0FBeEI7QUFDSCxHQXJCNkI7O0FBdUI5QkMsRUFBQUEsa0JBQWtCLENBQUNDLE9BQUQsRUFBVTtBQUN4QixVQUFNQyxrQkFBa0IsR0FBR0QsT0FBTyxDQUFDRSxRQUFSLENBQWlCQyxRQUFqQixDQUEwQkMsc0JBQXJEO0FBQ0EsVUFBTUMsYUFBYSxHQUNmSixrQkFBa0IsQ0FBQ0ssTUFBbkIsR0FBNEIsQ0FBNUIsSUFBaUNMLGtCQUFrQixDQUFDLENBQUQsQ0FBbEIsSUFBeUIsQ0FBMUQsR0FBOEQsQ0FBOUQsR0FBa0VBLGtCQUFrQixDQUFDSyxNQUR6RjtBQUVBLFVBQU1DLFlBQVksR0FBRztBQUNqQkMsTUFBQUEsSUFBSSxFQUFFUixPQUFPLENBQUNFLFFBQVIsQ0FBaUJDLFFBQWpCLENBQTBCTSxVQURmO0FBRWpCQyxNQUFBQSxJQUFJLEVBQUVWLE9BQU8sQ0FBQ0UsUUFBUixDQUFpQkMsUUFBakIsQ0FBMEJRLGtCQUZmO0FBR2pCQyxNQUFBQSxRQUFRLEVBQUVaLE9BQU8sQ0FBQ0UsUUFBUixDQUFpQkMsUUFBakIsQ0FBMEJDLHNCQUhuQjtBQUlqQlMsTUFBQUEsT0FBTyxFQUFFYixPQUFPLENBQUNFLFFBQVIsQ0FBaUJDLFFBQWpCLENBQTBCVyxRQUpsQjtBQUtqQkMsTUFBQUEsUUFBUSxFQUFFZixPQUFPLENBQUNFLFFBQVIsQ0FBaUJDLFFBQWpCLENBQTBCYSxTQUxuQjtBQU1qQlgsTUFBQUE7QUFOaUIsS0FBckI7QUFTQSxTQUFLUixrQkFBTCxDQUF3QjtBQUFFVSxNQUFBQSxZQUFGO0FBQWdCVSxNQUFBQSxJQUFJLEVBQUVqQixPQUFPLENBQUNpQjtBQUE5QixLQUF4QjtBQUNILEdBckM2Qjs7QUF1QzlCQyxFQUFBQSxhQUFhLEdBQUc7QUFDWixTQUFLckIsa0JBQUwsQ0FBd0IsSUFBeEI7QUFDSDs7QUF6QzZCLENBQXBCLENBQWQ7QUE0Q0FzQixNQUFNLENBQUNDLE9BQVAsR0FBaUJoQyxLQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbW9kdWxlIEJ1aWxkRXN0aW1hdGVTdG9yZVxyXG4gKiBAZGVzY1xyXG4gKiBUaGUgQnVpbGQgRXN0aW1hdGUgU3RvcmU6XHJcbiAqIC0gbGlzdGVucyB0byBUT09MUEFUSF9VTlpJUFBFRCBhY3Rpb24gJiBvcGVucyB0aGUgZXN0aW1hdGVzIG1vZGFsIGhlcmUgaW4gdGhlIHN0b3JlLlxyXG4gKlxyXG4gKiBOT1RFIDogQnVpbGRFc3RpbWF0ZVN0b3JlIGlzIG1iIG9ubHkgJiBpcyBkaWZmZXJlbnQgZnJvbSBlYWdsZS1wcmludC9zdG9yZXMvYnVpbGRTdG9yZSdzIEJVSUxEX1RZUEVTLkVTVElNQVRFXHJcbiAqXHJcbiAqXHJcbiAqIEBhdXRob3IgUml0aWthIFNoYW5kaWx5YVxyXG4gKi9cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuY29uc3QgRmx1eHhvciA9IHJlcXVpcmUoJ2ZsdXh4b3InKTtcclxuY29uc3QgU3RvcmUgPSBGbHV4eG9yLmNyZWF0ZVN0b3JlKHtcclxuICAgIGFjdGlvbnM6IHtcclxuICAgICAgICBUT09MUEFUSF9VTlpJUFBFRDogJ29uVG9vbFBhdGhVbnppcHBlZCcsXHJcbiAgICAgICAgSU1QT1JUX1RPT0xQQVRIX1VOWklQUEVEOiAnb25Ub29sUGF0aFVuemlwcGVkJyxcclxuICAgICAgICBDTEVBUl9CVUlMRFM6ICdvbkNsZWFyQnVpbGRzJyxcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBCdWlsZEVzdGltYXRlU3RvcmVcclxuICAgICAqL1xyXG5cclxuICAgIGluaXRpYWxpemUoKSB7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudEVzdGltYXRlID0gbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0Q3VycmVudEVzdGltYXRlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50RXN0aW1hdGU7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldEN1cnJlbnRFc3RpbWF0ZShuZXdFc3RpbWF0ZSkge1xyXG4gICAgICAgIHRoaXMuX2N1cnJlbnRFc3RpbWF0ZSA9IG5ld0VzdGltYXRlO1xyXG4gICAgfSxcclxuXHJcbiAgICBvblRvb2xQYXRoVW56aXBwZWQocGF5bG9hZCkge1xyXG4gICAgICAgIGNvbnN0IGV4dHJ1c2lvbkRpc3RhbmNlcyA9IHBheWxvYWQudW56aXBwZWQubWV0YURhdGEuZXh0cnVzaW9uX2Rpc3RhbmNlc19tbTtcclxuICAgICAgICBjb25zdCBleHRydWRlckNvdW50ID1cclxuICAgICAgICAgICAgZXh0cnVzaW9uRGlzdGFuY2VzLmxlbmd0aCA8IDIgfHwgZXh0cnVzaW9uRGlzdGFuY2VzWzFdIDw9IDAgPyAxIDogZXh0cnVzaW9uRGlzdGFuY2VzLmxlbmd0aDtcclxuICAgICAgICBjb25zdCBlc3RpbWF0ZUluZm8gPSB7XHJcbiAgICAgICAgICAgIHRpbWU6IHBheWxvYWQudW56aXBwZWQubWV0YURhdGEuZHVyYXRpb25fcyxcclxuICAgICAgICAgICAgbWFzczogcGF5bG9hZC51bnppcHBlZC5tZXRhRGF0YS5leHRydXNpb25fbWFzc2VzX2csXHJcbiAgICAgICAgICAgIGRpc3RhbmNlOiBwYXlsb2FkLnVuemlwcGVkLm1ldGFEYXRhLmV4dHJ1c2lvbl9kaXN0YW5jZXNfbW0sXHJcbiAgICAgICAgICAgIGJvdFR5cGU6IHBheWxvYWQudW56aXBwZWQubWV0YURhdGEuYm90X3R5cGUsXHJcbiAgICAgICAgICAgIG1hdGVyaWFsOiBwYXlsb2FkLnVuemlwcGVkLm1ldGFEYXRhLm1hdGVyaWFscyxcclxuICAgICAgICAgICAgZXh0cnVkZXJDb3VudCxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLnNldEN1cnJlbnRFc3RpbWF0ZSh7IGVzdGltYXRlSW5mbywgdGFzazogcGF5bG9hZC50YXNrIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkNsZWFyQnVpbGRzKCkge1xyXG4gICAgICAgIHRoaXMuc2V0Q3VycmVudEVzdGltYXRlKG51bGwpO1xyXG4gICAgfSxcclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFN0b3JlO1xyXG4iXX0=
