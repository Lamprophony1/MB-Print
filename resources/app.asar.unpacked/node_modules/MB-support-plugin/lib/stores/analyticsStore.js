'use strict';

const Fluxxor = require('fluxxor');

const JOB_TYPE = require('eagle-print/stores/buildStore').JOB_TYPE;

const R = require('ramda');

const {
  Dispatch
} = require('../constants/printerDetails');

const BotLogsActions = require('../constants/copyBotLogs').Actions;

const PrintSettingsActions = require('../constants/print_settings').Actions;

module.exports = Fluxxor.createStore({
  actions: {
    PREPARE_PRINT: 'onPreparePrint',
    BUILD_FAILED: 'onBuildFailed',
    BUILD_SUCCEEDED: 'onBuildSucceeded',
    EXPORT_TOOLPATH: 'onExportToolpath',
    EXPORT_TOOLPATH_COMPLETE: 'onExportToolpathComplete',
    NEW_PROJECT: 'onNewProject',
    TRAY_CREATED: 'onTrayCreated',
    TRAY_DELETED: 'onTrayDeleted',
    ADD_PRINTER: 'onAddPrinter',
    MB_RESET_TO_DEFAULT: 'onResetPrintSettingToDefault',
    MB_RESET_ALL_TO_DEFAULT: 'onResetAllPrintSettingsToDefault',
    MB_REMOVE_ALL_SETTINGS: 'onRemoveAllPrintSettings',
    MB_CLICK_ACCOUNT_ICON: 'onAccountIconClick',
    MB_PRINT_MODE_MENU_OPENED: 'onPrintModeMenuOpened',
    MB_LOG_IN: 'onLogIn',
    [Dispatch.AcknowledgeCompleted]: 'onAcknowledgePrintCompleted',
    [Dispatch.Suspend]: 'onPrintSuspend',
    [Dispatch.Resume]: 'onPrintResume',
    [Dispatch.Cancel]: 'onPrintCancel',
    [Dispatch.PrintAgain]: 'onPrintAgain',
    [BotLogsActions.CopyStart]: 'onBotLogsCopyStart',
    [BotLogsActions.CopySuccess]: 'onBotLogsCopySuccess',
    [PrintSettingsActions.CloseModal]: 'onCloseModal',
    [PrintSettingsActions.DestroyPreset]: 'onDestroyPreset',
    [PrintSettingsActions.UpdatePreset]: 'onUpdatePreset',
    [PrintSettingsActions.CreatePreset]: 'onCreatePreset',
    [PrintSettingsActions.ReadPresets]: 'onReadPresets',
    [PrintSettingsActions.WritePreset]: 'onWritePreset',
    [PrintSettingsActions.RenamePreset]: 'onRenamePreset',
    [PrintSettingsActions.ToggleProp]: 'onAdvancedToggle'
  },

  getTrackingService() {
    return this.flux.getService('TrackingService');
  },

  getPrinter() {
    return this.flux.store('PrinterStore').getSelectedPrinter();
  },

  onPreparePrint({
    jobType,
    filteredSettings
  }) {
    switch (jobType) {
      case JOB_TYPE.PRINT:
        this.getTrackingService().addEvent(R.merge({
          name: 'Print Slice Started'
        }, filteredSettings));
        break;

      case JOB_TYPE.EXPORT:
        this.getTrackingService().addEvent(R.merge({
          name: 'Export Started'
        }, filteredSettings));
        break;

      default:
        this.getTrackingService().addEvent({
          name: 'Preview Slice Started'
        });
    }
  },

  onBuildFailed({
    jobType,
    filteredSettings,
    err
  }) {
    if (err && err.type === 'cancel') {
      switch (jobType) {
        case JOB_TYPE.PRINT:
          this.getTrackingService().addEvent(R.merge({
            name: 'Print Slice Cancelled Automatic'
          }, filteredSettings));
          break;

        case JOB_TYPE.EXPORT:
          this.getTrackingService().addEvent(R.merge({
            name: 'Export Cancelled Automatic'
          }, filteredSettings));
          break;

        default:
          this.getTrackingService().addEvent({
            name: 'Preview Slice Cancelled Automatic'
          });
      }
    } else {
      switch (jobType) {
        case JOB_TYPE.PRINT:
          this.getTrackingService().addEvent(R.merge({
            name: 'Print Slice Failed',
            error: err
          }, filteredSettings));
          break;

        case JOB_TYPE.EXPORT:
          this.getTrackingService().addEvent(R.merge({
            name: 'Export Failed',
            error: err
          }, filteredSettings));
          break;

        default:
          this.getTrackingService().addEvent({
            name: 'Preview Slice Failed',
            error: err
          });
      }
    }
  },

  onBuildSucceeded({
    jobType,
    filteredSettings
  }) {
    switch (jobType) {
      case JOB_TYPE.PRINT:
        this.getTrackingService().addEvent(R.merge({
          name: 'Print Slice Completed'
        }, filteredSettings));
        break;

      case JOB_TYPE.EXPORT:
        this.getTrackingService().addEvent(R.merge({
          name: 'Export Completed'
        }, filteredSettings));
        break;

      default:
        this.getTrackingService().addEvent({
          name: 'Preview Slice Completed'
        });
    }
  },

  onExportToolpath({
    filteredSettings
  }) {
    this.getTrackingService().addEvent(R.merge({
      name: 'Export Started'
    }, filteredSettings));
  },

  onExportToolpathComplete({
    filteredSettings,
    error
  }) {
    const err = error ? {
      error
    } : {};
    this.getTrackingService().addEvent(R.mergeAll([{
      name: `Export ${error ? 'Failed' : 'Completed'}`
    }, filteredSettings, err]));
  },

  onNewProject() {
    this.getTrackingService().addEvent({
      name: 'New Project Created'
    });
  },

  onTrayCreated() {
    this.getTrackingService().addEvent({
      name: 'New Tray Added'
    });
  },

  onTrayDeleted() {
    this.getTrackingService().addEvent({
      name: 'Tray Deleted'
    });
  },

  onAddPrinter() {
    this.getTrackingService().addEvent({
      name: 'Add Printer From Network Printers Panel'
    });
  },

  onAcknowledgePrintCompleted({
    printer
  }) {
    this.getTrackingService().addEvent(R.merge({
      name: 'Print Done Clicked'
    }, printer.getTrackingInfo()));
  },

  onPrintSuspend({
    printer
  }) {
    this.getTrackingService().addEvent(R.merge({
      name: 'Print Paused'
    }, printer.getTrackingInfo()));
  },

  onPrintResume({
    printer
  }) {
    this.getTrackingService().addEvent(R.merge({
      name: 'Print Resumed'
    }, printer.getTrackingInfo()));
  },

  onPrintCancel({
    printer,
    currentProcess
  }) {
    this.getTrackingService().addEvent(R.merge({
      name: `${currentProcess.name} Cancelled`
    }, printer.getTrackingInfo()));
  },

  onPrintAgain({
    printer
  }) {
    this.getTrackingService().addEvent(R.merge({
      name: 'Print Again'
    }, printer.getTrackingInfo()));
  },

  onBotLogsCopyStart() {
    this.getTrackingService().addEvent({
      name: 'Copy Printer Logs Started'
    });
  },

  onBotLogsCopySuccess() {
    this.getTrackingService().addEvent({
      name: 'Copy Printer Logs Completed'
    });
  },

  onResetPrintSettingToDefault({
    key
  }) {
    this.getTrackingService().addEvent({
      name: 'Reset To Default',
      setting: key
    });
  },

  onResetAllPrintSettingsToDefault() {
    this.getTrackingService().addEvent(R.merge({
      name: 'Reset All Settings to Default'
    }, this.getPrinter().getTrackingInfo()));
  },

  onRemoveAllPrintSettings() {
    this.getTrackingService().addEvent(R.merge({
      name: 'Remove All Settings'
    }, this.getPrinter().getTrackingInfo()));
  },

  onAccountIconClick() {
    this.getTrackingService().addEvent({
      name: 'Sidebar Link Clicked Account'
    });
  },

  onPrintModeMenuOpened() {
    this.getTrackingService().addEvent({
      name: 'Print Mode Menu Opened'
    });
  },

  onLogIn({
    userId
  }) {
    this.getTrackingService().setUserId(userId);
    this.getTrackingService().addEvent({
      name: 'Log In'
    });
  },

  onCloseModal() {
    const {
      printMode,
      currentPreset
    } = this.flux.store('PrintSettingsStore').getState();
    const currentPrintMode = currentPreset || printMode.selected;
    this.getTrackingService().addEvent({
      name: 'Print Mode Selected',
      printMode: currentPrintMode,
      isCustomPrintMode: currentPreset != null
    });
  },

  onDestroyPreset({
    name
  }) {
    this.getTrackingService().addEvent({
      name: 'Print Mode Removed',
      printMode: name
    });
  },

  onUpdatePreset({
    name
  }) {
    this.getTrackingService().addEvent({
      name: 'Print Mode Saved',
      printMode: name
    });
  },

  onCreatePreset({
    name,
    originalPrintMode
  }) {
    this.getTrackingService().addEvent({
      name: 'Print Mode Created',
      printMode: name,
      originalPrintMode
    });
  },

  onReadPresets() {
    this.getTrackingService().addEvent({
      name: 'Print Mode Imported'
    });
  },

  onWritePreset({
    name
  }) {
    this.getTrackingService().addEvent({
      name: 'Print Mode Exported',
      printMode: name
    });
  },

  onRenamePreset({
    name
  }) {
    this.getTrackingService().addEvent({
      name: 'Print Mode Renamed',
      printMode: name
    });
  },

  onAdvancedToggle({
    key
  }) {
    const PrintSettingsStore = this.flux.store('PrintSettingsStore');
    const prevValue = R.propOr(false, key, PrintSettingsStore.getVisibleSettings());
    const eventName = `Setting Visibility ${prevValue ? 'Enabled' : 'Disabled'}`;
    this.getTrackingService().addEvent({
      name: eventName,
      setting: key
    });
  }

});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuYWx5dGljc1N0b3JlLmpzIl0sIm5hbWVzIjpbIkZsdXh4b3IiLCJyZXF1aXJlIiwiSk9CX1RZUEUiLCJSIiwiRGlzcGF0Y2giLCJCb3RMb2dzQWN0aW9ucyIsIkFjdGlvbnMiLCJQcmludFNldHRpbmdzQWN0aW9ucyIsIm1vZHVsZSIsImV4cG9ydHMiLCJjcmVhdGVTdG9yZSIsImFjdGlvbnMiLCJQUkVQQVJFX1BSSU5UIiwiQlVJTERfRkFJTEVEIiwiQlVJTERfU1VDQ0VFREVEIiwiRVhQT1JUX1RPT0xQQVRIIiwiRVhQT1JUX1RPT0xQQVRIX0NPTVBMRVRFIiwiTkVXX1BST0pFQ1QiLCJUUkFZX0NSRUFURUQiLCJUUkFZX0RFTEVURUQiLCJBRERfUFJJTlRFUiIsIk1CX1JFU0VUX1RPX0RFRkFVTFQiLCJNQl9SRVNFVF9BTExfVE9fREVGQVVMVCIsIk1CX1JFTU9WRV9BTExfU0VUVElOR1MiLCJNQl9DTElDS19BQ0NPVU5UX0lDT04iLCJNQl9QUklOVF9NT0RFX01FTlVfT1BFTkVEIiwiTUJfTE9HX0lOIiwiQWNrbm93bGVkZ2VDb21wbGV0ZWQiLCJTdXNwZW5kIiwiUmVzdW1lIiwiQ2FuY2VsIiwiUHJpbnRBZ2FpbiIsIkNvcHlTdGFydCIsIkNvcHlTdWNjZXNzIiwiQ2xvc2VNb2RhbCIsIkRlc3Ryb3lQcmVzZXQiLCJVcGRhdGVQcmVzZXQiLCJDcmVhdGVQcmVzZXQiLCJSZWFkUHJlc2V0cyIsIldyaXRlUHJlc2V0IiwiUmVuYW1lUHJlc2V0IiwiVG9nZ2xlUHJvcCIsImdldFRyYWNraW5nU2VydmljZSIsImZsdXgiLCJnZXRTZXJ2aWNlIiwiZ2V0UHJpbnRlciIsInN0b3JlIiwiZ2V0U2VsZWN0ZWRQcmludGVyIiwib25QcmVwYXJlUHJpbnQiLCJqb2JUeXBlIiwiZmlsdGVyZWRTZXR0aW5ncyIsIlBSSU5UIiwiYWRkRXZlbnQiLCJtZXJnZSIsIm5hbWUiLCJFWFBPUlQiLCJvbkJ1aWxkRmFpbGVkIiwiZXJyIiwidHlwZSIsImVycm9yIiwib25CdWlsZFN1Y2NlZWRlZCIsIm9uRXhwb3J0VG9vbHBhdGgiLCJvbkV4cG9ydFRvb2xwYXRoQ29tcGxldGUiLCJtZXJnZUFsbCIsIm9uTmV3UHJvamVjdCIsIm9uVHJheUNyZWF0ZWQiLCJvblRyYXlEZWxldGVkIiwib25BZGRQcmludGVyIiwib25BY2tub3dsZWRnZVByaW50Q29tcGxldGVkIiwicHJpbnRlciIsImdldFRyYWNraW5nSW5mbyIsIm9uUHJpbnRTdXNwZW5kIiwib25QcmludFJlc3VtZSIsIm9uUHJpbnRDYW5jZWwiLCJjdXJyZW50UHJvY2VzcyIsIm9uUHJpbnRBZ2FpbiIsIm9uQm90TG9nc0NvcHlTdGFydCIsIm9uQm90TG9nc0NvcHlTdWNjZXNzIiwib25SZXNldFByaW50U2V0dGluZ1RvRGVmYXVsdCIsImtleSIsInNldHRpbmciLCJvblJlc2V0QWxsUHJpbnRTZXR0aW5nc1RvRGVmYXVsdCIsIm9uUmVtb3ZlQWxsUHJpbnRTZXR0aW5ncyIsIm9uQWNjb3VudEljb25DbGljayIsIm9uUHJpbnRNb2RlTWVudU9wZW5lZCIsIm9uTG9nSW4iLCJ1c2VySWQiLCJzZXRVc2VySWQiLCJvbkNsb3NlTW9kYWwiLCJwcmludE1vZGUiLCJjdXJyZW50UHJlc2V0IiwiZ2V0U3RhdGUiLCJjdXJyZW50UHJpbnRNb2RlIiwic2VsZWN0ZWQiLCJpc0N1c3RvbVByaW50TW9kZSIsIm9uRGVzdHJveVByZXNldCIsIm9uVXBkYXRlUHJlc2V0Iiwib25DcmVhdGVQcmVzZXQiLCJvcmlnaW5hbFByaW50TW9kZSIsIm9uUmVhZFByZXNldHMiLCJvbldyaXRlUHJlc2V0Iiwib25SZW5hbWVQcmVzZXQiLCJvbkFkdmFuY2VkVG9nZ2xlIiwiUHJpbnRTZXR0aW5nc1N0b3JlIiwicHJldlZhbHVlIiwicHJvcE9yIiwiZ2V0VmlzaWJsZVNldHRpbmdzIiwiZXZlbnROYW1lIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFELENBQXZCOztBQUNBLE1BQU1DLFFBQVEs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LEtBQUs1RCxJQUFMLENBQVVHLEtBQVYsQ0FBZ0Isb0JBQWhCLENBQTNCO0FBQ0EsVUFBTTBELFNBQVMsR0FBR3JHLENBQUMsQ0FBQ3NHLE1BQUYsQ0FBUyxLQUFULEVBQWdCMUIsR0FBaEIsRUFBcUJ3QixrQkFBa0IsQ0FBQ0csa0JBQW5CLEVBQXJCLENBQWxCO0FBQ0EsVUFBTUMsU0FBUyxHQUFJLHNCQUFxQkgsU0FBUyxHQUFHLFNBQUgsR0FBZSxVQUFXLEVBQTNFO0FBRUEsU0FBSzlELGtCQUFMLEdBQTBCVSxRQUExQixDQUFtQztBQUMvQkUsTUFBQUEsSUFBSSxFQUFFcUQsU0FEeUI7QUFFL0IzQixNQUFBQSxPQUFPLEVBQUVEO0FBRnNCLEtBQW5DO0FBSUg7O0FBblhnQyxDQUFwQixDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuXHJcbmNvbnN0IEZsdXh4b3IgPSByZXF1aXJlKCdmbHV4eG9yJyk7XHJcbmNvbnN0IEpPQl9UWVBFID0gcmVxdWlyZSgnZWFnbGUtcHJpbnQvc3RvcmVzL2J1aWxkU3RvcmUnKS5KT0JfVFlQRTtcclxuY29uc3QgUiA9IHJlcXVpcmUoJ3JhbWRhJyk7XHJcblxyXG5jb25zdCB7IERpc3BhdGNoIH0gPSByZXF1aXJlKCcuLi9jb25zdGFudHMvcHJpbnRlckRldGFpbHMnKTtcclxuY29uc3QgQm90TG9nc0FjdGlvbnMgPSByZXF1aXJlKCcuLi9jb25zdGFudHMvY29weUJvdExvZ3MnKS5BY3Rpb25zO1xyXG5jb25zdCBQcmludFNldHRpbmdzQWN0aW9ucyA9IHJlcXVpcmUoJy4uL2NvbnN0YW50cy9wcmludF9zZXR0aW5ncycpLkFjdGlvbnM7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEZsdXh4b3IuY3JlYXRlU3RvcmUoe1xyXG4gICAgYWN0aW9uczoge1xyXG4gICAgICAgIFBSRVBBUkVfUFJJTlQ6ICdvblByZXBhcmVQcmludCcsXHJcbiAgICAgICAgQlVJTERfRkFJTEVEOiAnb25CdWlsZEZhaWxlZCcsXHJcbiAgICAgICAgQlVJTERfU1VDQ0VFREVEOiAnb25CdWlsZFN1Y2NlZWRlZCcsXHJcbiAgICAgICAgRVhQT1JUX1RPT0xQQVRIOiAnb25FeHBvcnRUb29scGF0aCcsXHJcbiAgICAgICAgRVhQT1JUX1RPT0xQQVRIX0NPTVBMRVRFOiAnb25FeHBvcnRUb29scGF0aENvbXBsZXRlJyxcclxuICAgICAgICBORVdfUFJPSkVDVDogJ29uTmV3UHJvamVjdCcsXHJcbiAgICAgICAgVFJBWV9DUkVBVEVEOiAnb25UcmF5Q3JlYXRlZCcsXHJcbiAgICAgICAgVFJBWV9ERUxFVEVEOiAnb25UcmF5RGVsZXRlZCcsXHJcbiAgICAgICAgQUREX1BSSU5URVI6ICdvbkFkZFByaW50ZXInLFxyXG4gICAgICAgIE1CX1JFU0VUX1RPX0RFRkFVTFQ6ICdvblJlc2V0UHJpbnRTZXR0aW5nVG9EZWZhdWx0JyxcclxuICAgICAgICBNQl9SRVNFVF9BTExfVE9fREVGQVVMVDogJ29uUmVzZXRBbGxQcmludFNldHRpbmdzVG9EZWZhdWx0JyxcclxuICAgICAgICBNQl9SRU1PVkVfQUxMX1NFVFRJTkdTOiAnb25SZW1vdmVBbGxQcmludFNldHRpbmdzJyxcclxuICAgICAgICBNQl9DTElDS19BQ0NPVU5UX0lDT046ICdvbkFjY291bnRJY29uQ2xpY2snLFxyXG4gICAgICAgIE1CX1BSSU5UX01PREVfTUVOVV9PUEVORUQ6ICdvblByaW50TW9kZU1lbnVPcGVuZWQnLFxyXG4gICAgICAgIE1CX0xPR19JTjogJ29uTG9nSW4nLFxyXG4gICAgICAgIFtEaXNwYXRjaC5BY2tub3dsZWRnZUNvbXBsZXRlZF06ICdvbkFja25vd2xlZGdlUHJpbnRDb21wbGV0ZWQnLFxyXG4gICAgICAgIFtEaXNwYXRjaC5TdXNwZW5kXTogJ29uUHJpbnRTdXNwZW5kJyxcclxuICAgICAgICBbRGlzcGF0Y2guUmVzdW1lXTogJ29uUHJpbnRSZXN1bWUnLFxyXG4gICAgICAgIFtEaXNwYXRjaC5DYW5jZWxdOiAnb25QcmludENhbmNlbCcsXHJcbiAgICAgICAgW0Rpc3BhdGNoLlByaW50QWdhaW5dOiAnb25QcmludEFnYWluJyxcclxuICAgICAgICBbQm90TG9nc0FjdGlvbnMuQ29weVN0YXJ0XTogJ29uQm90TG9nc0NvcHlTdGFydCcsXHJcbiAgICAgICAgW0JvdExvZ3NBY3Rpb25zLkNvcHlTdWNjZXNzXTogJ29uQm90TG9nc0NvcHlTdWNjZXNzJyxcclxuICAgICAgICBbUHJpbnRTZXR0aW5nc0FjdGlvbnMuQ2xvc2VNb2RhbF06ICdvbkNsb3NlTW9kYWwnLFxyXG4gICAgICAgIFtQcmludFNldHRpbmdzQWN0aW9ucy5EZXN0cm95UHJlc2V0XTogJ29uRGVzdHJveVByZXNldCcsXHJcbiAgICAgICAgW1ByaW50U2V0dGluZ3NBY3Rpb25zLlVwZGF0ZVByZXNldF06ICdvblVwZGF0ZVByZXNldCcsXHJcbiAgICAgICAgW1ByaW50U2V0dGluZ3NBY3Rpb25zLkNyZWF0ZVByZXNldF06ICdvbkNyZWF0ZVByZXNldCcsXHJcbiAgICAgICAgW1ByaW50U2V0dGluZ3NBY3Rpb25zLlJlYWRQcmVzZXRzXTogJ29uUmVhZFByZXNldHMnLFxyXG4gICAgICAgIFtQcmludFNldHRpbmdzQWN0aW9ucy5Xcml0ZVByZXNldF06ICdvbldyaXRlUHJlc2V0JyxcclxuICAgICAgICBbUHJpbnRTZXR0aW5nc0FjdGlvbnMuUmVuYW1lUHJlc2V0XTogJ29uUmVuYW1lUHJlc2V0JyxcclxuICAgICAgICBbUHJpbnRTZXR0aW5nc0FjdGlvbnMuVG9nZ2xlUHJvcF06ICdvbkFkdmFuY2VkVG9nZ2xlJyxcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0VHJhY2tpbmdTZXJ2aWNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZsdXguZ2V0U2VydmljZSgnVHJhY2tpbmdTZXJ2aWNlJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldFByaW50ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmx1eC5zdG9yZSgnUHJpbnRlclN0b3JlJykuZ2V0U2VsZWN0ZWRQcmludGVyKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uUHJlcGFyZVByaW50KHsgam9iVHlwZSwgZmlsdGVyZWRTZXR0aW5ncyB9KSB7XHJcbiAgICAgICAgc3dpdGNoIChqb2JUeXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgSk9CX1RZUEUuUFJJTlQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICAgICAgICAgIFIubWVyZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdQcmludCBTbGljZSBTdGFydGVkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRTZXR0aW5nc1xyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBKT0JfVFlQRS5FWFBPUlQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICAgICAgICAgIFIubWVyZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdFeHBvcnQgU3RhcnRlZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkU2V0dGluZ3NcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnUHJldmlldyBTbGljZSBTdGFydGVkJyxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgb25CdWlsZEZhaWxlZCh7IGpvYlR5cGUsIGZpbHRlcmVkU2V0dGluZ3MsIGVyciB9KSB7XHJcbiAgICAgICAgaWYgKGVyciAmJiBlcnIudHlwZSA9PT0gJ2NhbmNlbCcpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChqb2JUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEpPQl9UWVBFLlBSSU5UOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFIubWVyZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1ByaW50IFNsaWNlIENhbmNlbGxlZCBBdXRvbWF0aWMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkU2V0dGluZ3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEpPQl9UWVBFLkVYUE9SVDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBSLm1lcmdlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdFeHBvcnQgQ2FuY2VsbGVkIEF1dG9tYXRpYycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRTZXR0aW5nc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdQcmV2aWV3IFNsaWNlIENhbmNlbGxlZCBBdXRvbWF0aWMnLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3dpdGNoIChqb2JUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEpPQl9UWVBFLlBSSU5UOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFIubWVyZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1ByaW50IFNsaWNlIEZhaWxlZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZFNldHRpbmdzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBKT0JfVFlQRS5FWFBPUlQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudChcclxuICAgICAgICAgICAgICAgICAgICAgICAgUi5tZXJnZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnRXhwb3J0IEZhaWxlZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZFNldHRpbmdzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1ByZXZpZXcgU2xpY2UgRmFpbGVkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycixcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgb25CdWlsZFN1Y2NlZWRlZCh7IGpvYlR5cGUsIGZpbHRlcmVkU2V0dGluZ3MgfSkge1xyXG4gICAgICAgIHN3aXRjaCAoam9iVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIEpPQl9UWVBFLlBSSU5UOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudChcclxuICAgICAgICAgICAgICAgICAgICBSLm1lcmdlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnUHJpbnQgU2xpY2UgQ29tcGxldGVkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRTZXR0aW5nc1xyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBKT0JfVFlQRS5FWFBPUlQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICAgICAgICAgIFIubWVyZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdFeHBvcnQgQ29tcGxldGVkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRTZXR0aW5nc1xyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoe1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdQcmV2aWV3IFNsaWNlIENvbXBsZXRlZCcsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG9uRXhwb3J0VG9vbHBhdGgoeyBmaWx0ZXJlZFNldHRpbmdzIH0pIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICBSLm1lcmdlKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdFeHBvcnQgU3RhcnRlZCcsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZmlsdGVyZWRTZXR0aW5nc1xyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25FeHBvcnRUb29scGF0aENvbXBsZXRlKHsgZmlsdGVyZWRTZXR0aW5ncywgZXJyb3IgfSkge1xyXG4gICAgICAgIGNvbnN0IGVyciA9IGVycm9yID8geyBlcnJvciB9IDoge307XHJcbiAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudChcclxuICAgICAgICAgICAgUi5tZXJnZUFsbChbeyBuYW1lOiBgRXhwb3J0ICR7ZXJyb3IgPyAnRmFpbGVkJyA6ICdDb21wbGV0ZWQnfWAgfSwgZmlsdGVyZWRTZXR0aW5ncywgZXJyXSlcclxuICAgICAgICApO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbk5ld1Byb2plY3QoKSB7XHJcbiAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudCh7IG5hbWU6ICdOZXcgUHJvamVjdCBDcmVhdGVkJyB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25UcmF5Q3JlYXRlZCgpIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KHsgbmFtZTogJ05ldyBUcmF5IEFkZGVkJyB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25UcmF5RGVsZXRlZCgpIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KHsgbmFtZTogJ1RyYXkgRGVsZXRlZCcgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uQWRkUHJpbnRlcigpIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KHtcclxuICAgICAgICAgICAgbmFtZTogJ0FkZCBQcmludGVyIEZyb20gTmV0d29yayBQcmludGVycyBQYW5lbCcsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uQWNrbm93bGVkZ2VQcmludENvbXBsZXRlZCh7IHByaW50ZXIgfSkge1xyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoXHJcbiAgICAgICAgICAgIFIubWVyZ2UoXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1ByaW50IERvbmUgQ2xpY2tlZCcsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcHJpbnRlci5nZXRUcmFja2luZ0luZm8oKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25QcmludFN1c3BlbmQoeyBwcmludGVyIH0pIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICBSLm1lcmdlKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdQcmludCBQYXVzZWQnLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHByaW50ZXIuZ2V0VHJhY2tpbmdJbmZvKClcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uUHJpbnRSZXN1bWUoeyBwcmludGVyIH0pIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICBSLm1lcmdlKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdQcmludCBSZXN1bWVkJyxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBwcmludGVyLmdldFRyYWNraW5nSW5mbygpXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfSxcclxuXHJcbiAgICBvblByaW50Q2FuY2VsKHsgcHJpbnRlciwgY3VycmVudFByb2Nlc3MgfSkge1xyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoXHJcbiAgICAgICAgICAgIFIubWVyZ2UoXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogYCR7Y3VycmVudFByb2Nlc3MubmFtZX0gQ2FuY2VsbGVkYCxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBwcmludGVyLmdldFRyYWNraW5nSW5mbygpXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfSxcclxuXHJcbiAgICBvblByaW50QWdhaW4oeyBwcmludGVyIH0pIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICBSLm1lcmdlKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdQcmludCBBZ2FpbicsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcHJpbnRlci5nZXRUcmFja2luZ0luZm8oKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25Cb3RMb2dzQ29weVN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoe1xyXG4gICAgICAgICAgICBuYW1lOiAnQ29weSBQcmludGVyIExvZ3MgU3RhcnRlZCcsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uQm90TG9nc0NvcHlTdWNjZXNzKCkge1xyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoe1xyXG4gICAgICAgICAgICBuYW1lOiAnQ29weSBQcmludGVyIExvZ3MgQ29tcGxldGVkJyxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25SZXNldFByaW50U2V0dGluZ1RvRGVmYXVsdCh7IGtleSB9KSB7XHJcbiAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudCh7XHJcbiAgICAgICAgICAgIG5hbWU6ICdSZXNldCBUbyBEZWZhdWx0JyxcclxuICAgICAgICAgICAgc2V0dGluZzoga2V5LFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBvblJlc2V0QWxsUHJpbnRTZXR0aW5nc1RvRGVmYXVsdCgpIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICBSLm1lcmdlKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdSZXNldCBBbGwgU2V0dGluZ3MgdG8gRGVmYXVsdCcsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRQcmludGVyKCkuZ2V0VHJhY2tpbmdJbmZvKClcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uUmVtb3ZlQWxsUHJpbnRTZXR0aW5ncygpIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KFxyXG4gICAgICAgICAgICBSLm1lcmdlKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdSZW1vdmUgQWxsIFNldHRpbmdzJyxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFByaW50ZXIoKS5nZXRUcmFja2luZ0luZm8oKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25BY2NvdW50SWNvbkNsaWNrKCkge1xyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoe1xyXG4gICAgICAgICAgICBuYW1lOiAnU2lkZWJhciBMaW5rIENsaWNrZWQgQWNjb3VudCcsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uUHJpbnRNb2RlTWVudU9wZW5lZCgpIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KHtcclxuICAgICAgICAgICAgbmFtZTogJ1ByaW50IE1vZGUgTWVudSBPcGVuZWQnLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvZ0luKHsgdXNlcklkIH0pIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLnNldFVzZXJJZCh1c2VySWQpO1xyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoe1xyXG4gICAgICAgICAgICBuYW1lOiAnTG9nIEluJyxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25DbG9zZU1vZGFsKCkge1xyXG4gICAgICAgIGNvbnN0IHsgcHJpbnRNb2RlLCBjdXJyZW50UHJlc2V0IH0gPSB0aGlzLmZsdXguc3RvcmUoJ1ByaW50U2V0dGluZ3NTdG9yZScpLmdldFN0YXRlKCk7XHJcbiAgICAgICAgY29uc3QgY3VycmVudFByaW50TW9kZSA9IGN1cnJlbnRQcmVzZXQgfHwgcHJpbnRNb2RlLnNlbGVjdGVkO1xyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoe1xyXG4gICAgICAgICAgICBuYW1lOiAnUHJpbnQgTW9kZSBTZWxlY3RlZCcsXHJcbiAgICAgICAgICAgIHByaW50TW9kZTogY3VycmVudFByaW50TW9kZSxcclxuICAgICAgICAgICAgaXNDdXN0b21QcmludE1vZGU6IGN1cnJlbnRQcmVzZXQgIT0gbnVsbCxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25EZXN0cm95UHJlc2V0KHsgbmFtZSB9KSB7XHJcbiAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudCh7XHJcbiAgICAgICAgICAgIG5hbWU6ICdQcmludCBNb2RlIFJlbW92ZWQnLFxyXG4gICAgICAgICAgICBwcmludE1vZGU6IG5hbWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uVXBkYXRlUHJlc2V0KHsgbmFtZSB9KSB7XHJcbiAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudCh7XHJcbiAgICAgICAgICAgIG5hbWU6ICdQcmludCBNb2RlIFNhdmVkJyxcclxuICAgICAgICAgICAgcHJpbnRNb2RlOiBuYW1lLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkNyZWF0ZVByZXNldCh7IG5hbWUsIG9yaWdpbmFsUHJpbnRNb2RlIH0pIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KHtcclxuICAgICAgICAgICAgbmFtZTogJ1ByaW50IE1vZGUgQ3JlYXRlZCcsXHJcbiAgICAgICAgICAgIHByaW50TW9kZTogbmFtZSxcclxuICAgICAgICAgICAgb3JpZ2luYWxQcmludE1vZGUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uUmVhZFByZXNldHMoKSB7XHJcbiAgICAgICAgdGhpcy5nZXRUcmFja2luZ1NlcnZpY2UoKS5hZGRFdmVudCh7IG5hbWU6ICdQcmludCBNb2RlIEltcG9ydGVkJyB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25Xcml0ZVByZXNldCh7IG5hbWUgfSkge1xyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoe1xyXG4gICAgICAgICAgICBuYW1lOiAnUHJpbnQgTW9kZSBFeHBvcnRlZCcsXHJcbiAgICAgICAgICAgIHByaW50TW9kZTogbmFtZSxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25SZW5hbWVQcmVzZXQoeyBuYW1lIH0pIHtcclxuICAgICAgICB0aGlzLmdldFRyYWNraW5nU2VydmljZSgpLmFkZEV2ZW50KHtcclxuICAgICAgICAgICAgbmFtZTogJ1ByaW50IE1vZGUgUmVuYW1lZCcsXHJcbiAgICAgICAgICAgIHByaW50TW9kZTogbmFtZSxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25BZHZhbmNlZFRvZ2dsZSh7IGtleSB9KSB7XHJcbiAgICAgICAgY29uc3QgUHJpbnRTZXR0aW5nc1N0b3JlID0gdGhpcy5mbHV4LnN0b3JlKCdQcmludFNldHRpbmdzU3RvcmUnKTtcclxuICAgICAgICBjb25zdCBwcmV2VmFsdWUgPSBSLnByb3BPcihmYWxzZSwga2V5LCBQcmludFNldHRpbmdzU3RvcmUuZ2V0VmlzaWJsZVNldHRpbmdzKCkpO1xyXG4gICAgICAgIGNvbnN0IGV2ZW50TmFtZSA9IGBTZXR0aW5nIFZpc2liaWxpdHkgJHtwcmV2VmFsdWUgPyAnRW5hYmxlZCcgOiAnRGlzYWJsZWQnfWA7XHJcblxyXG4gICAgICAgIHRoaXMuZ2V0VHJhY2tpbmdTZXJ2aWNlKCkuYWRkRXZlbnQoe1xyXG4gICAgICAgICAgICBuYW1lOiBldmVudE5hbWUsXHJcbiAgICAgICAgICAgIHNldHRpbmc6IGtleSxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbn0pO1xyXG4iXX0=
