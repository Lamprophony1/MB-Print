'use strict';

var _react = _interopRequireDefault(require("react"));

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

var _flux_component = _interopRequireDefault(require("eagle-print/views/flux_component"));

var _printMaterialBadge = _interopRequireDefault(require("./printMaterialBadge"));

var _loadingPlaceholder = _interopRequireDefault(require("./loadingPlaceholder"));

var _uiUtils = require("./utilities/timeAndEstimates/uiUtils");

var _util = require("../../util");

var _constants = require("../../constants");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class Estimates extends _flux_component.default {
  constructor(props) {
    super(props);
    this._i18n = this.props.flux.getService('TranslationService');
  }

  _isNil(value) {
    return value === null || value === undefined;
  }

  getMaterialEstimates(bayIndex = 0) {
    const materialResults = {};
    materialResults.gram = (0, _uiUtils.formatMaterialAmount)(this.props.estimateInfo.mass[bayIndex], 2);
    materialResults.distance = this.props.estimateInfo.distance[bayIndex];
    /**
     * derive stock material length for offline estimates & create supplemental text about < 6th gen spool size...
     * 6th gen: check bot type & toolpath material estimate in each bayIndex -> assign stock material length
     * in a way we can use to compare with toolpath's extrusion_distance
     * 5th gen: check if bot is a mini or standard size -> assign stock pla length
     * TODO: abstract supplemental spool text into separate function to clean up logic
     **/

    const botType = this.props.estimateInfo.botType;
    const material = this.props.estimateInfo.material[bayIndex];

    if (this.props.printer.isSixthGen()) {
      materialResults.spoolLength = _constants.StockMaterialLength.makerbot_generation6[material];
    } else if (botType === _constants.BotTypeEnum.sketch) {
      materialResults.spoolLength = _constants.StockMaterialLength.makerbot_sketch[material];
    } else if (botType === _constants.BotTypeEnum.mini_8) {
      materialResults.spoolLength = _constants.StockMaterialLength.makerbot_generation5.pla_small;

      if (materialResults.gram < 73) {
        materialResults.spoolFraction = this._i18n.t('mb:estimates.material_estimates.small_spool.1/3');
      } else if (materialResults.gram < 145) {
        materialResults.spoolFraction = this._i18n.t('mb:estimates.material_estimates.small_spool.2/3');
      } else if (materialResults.gram < 210) {
        materialResults.spoolFraction = this._i18n.t('mb:estimates.material_estimates.small_spool.3/3');
      } else {
        materialResults.spoolFraction = this._i18n.t('mb:estimates.material_estimates.small_spool.3+/3');
      }
    } else {
      materialResults.spoolLength = _constants.StockMaterialLength.makerbot_generation5.pla_large;

      if (materialResults.gram < 302) {
        materialResults.spoolFraction = this._i18n.t('mb:estimates.material_estimates.large_spool.1/3');
      } else if (materialResults.gram < 604) {
        materialResults.spoolFraction = this._i18n.t('mb:estimates.material_estimates.large_spool.2/3');
      } else if (materialResults.gram < 909) {
        materialResults.spoolFraction = this._i18n.t('mb:estimates.material_estimates.large_spool.3/3');
      } else {
        materialResults.spoolFraction = this._i18n.t('mb:estimates.material_estimates.large_spool.3+/3');
      }
    }

    return materialResults;
  }

  getTimeAMPM(date) {
    let hours = date.getHours();
    let minutes = date.getMinutes();
    const ampm = hours >= 12 ? 'pm' : 'am';
    hours = hours % 12;
    hours = hours ? hours : 12; // the hour '0' should be '12'

    minutes = minutes < 10 ? `0${minutes}` : `${minutes}`;
    const strTime = `${hours}:${minutes}`;
    return {
      strTime,
      ampm
    };
  }

  getDuration(seconds) {
    const days = Math.floor(seconds / (3600 * 24));
    seconds = seconds - days * 3600 * 24;
    const hours = Math.floor(seconds / 3600);
    seconds = seconds - hours * 3600;
    const minutes = Math.floor(seconds / 60);
    let duration = '';

    if (days > 0) {
      duration += `${days}d `;
    }

    if (hours > 0) {
      duration += `${hours}h `;
    }

    return `${duration + minutes}m`;
  }

  getTimeEstimates() {
    const timeResults = {};
    const now = new Date();
    const estimateDate = new Date(now.getTime() + 1000 * this.props.estimateInfo.time); //DAY i.e. today, tomorrow or whatever day of the week

    if (now.getDay() == estimateDate.getDay() && this.props.estimateInfo.time < 24 * 60 * 60) {
      // same day as today & less than 24 hours
      timeResults.day = this._i18n.t('mb:estimates.time_estimates.today');
    } else if (now.getDay() + 1 == estimateDate.getDay() && this.props.estimateInfo.time < 48 * 60 * 60) {
      // same day as tomorrow & less than 48 hours
      timeResults.day = this._i18n.t('mb:estimates.time_estimates.tomorrow');
    } else {
      timeResults.day = this._i18n.t(`mb:estimates.time_estimates.${estimateDate.getDay()}`);
    } //TIME hh:mm


    timeResults.time = this.getTimeAMPM(estimateDate); //DURATION d h m

    timeResults.duration = this.getDuration(this.props.estimateInfo.time);
    return timeResults;
  }

  getMaterialInfo(spool, bayIndex) {
    /**
     * Check spool for smart or dumb data -> otherwise default to 5th gen.
     * Pull material color from spool, and process that info to create needed color.
     * If no material type or color are present(dumb spool), show fallback.
     * For a 6th-gen LABS extruder, we ignore the loaded spool material, and show
     * the user-selected material.
     **/
    const hasSmartSpool = spool && spool.tag_uid !== null;

    const hasLabsExtruder = this.props.printer.getAttachedExtruders()[0] === _constants.ExtruderTypeEnum.mk14_e;

    const materialInfoResults = {};

    if (hasSmartSpool && !hasLabsExtruder) {
      materialInfoResults.type = spool.material_type ? _constants.SliceConfigStringsToPrettyStrings[spool.material_name] : _constants.SliceConfigStringsToPrettyStrings['generic_model'];
      materialInfoResults.materialColorName = spool.material_color_name !== '' ? spool.material_color_name : `Color ${_constants.MaterialDefaults.detection_error}`;
      materialInfoResults.remainingColor = (0, _uiUtils.formatMaterialColor)(spool).remainingColor;
      materialInfoResults.neededColor = (0, _uiUtils.formatMaterialColor)(spool).neededColor;
      return materialInfoResults;
    } else {
      bayIndex = !this._isNil(bayIndex) ? bayIndex : 0;
      const material = this.props.estimateInfo.material[bayIndex];
      materialInfoResults.type = _constants.SliceConfigStringsToPrettyStrings[material];
      materialInfoResults.neededColor = _constants.MaterialDefaults.colors[material];
      return materialInfoResults;
    }
  }

  constructPayload(spool, bayIndex) {
    return {
      showSpoolFraction: !this.props.spoolInfo,
      remainingMaterialAmount: spool && spool.amount_remaining >= 0 ? (0, _util.filamentLengthToMass)(spool.amount_remaining, spool.linear_density) : null,
      materialInfo: this.getMaterialInfo(spool, bayIndex),
      spool
    };
  }

  renderOneMaterialEstimate(payload, bayIndex) {
    const {
      materialInfo,
      showSpoolFraction,
      remainingMaterialAmount,
      spool
    } = payload;

    const hasLabsExtruder = this.props.printer.getAttachedExtruders()[bayIndex] === _constants.ExtruderTypeEnum.mk14_e; // Material estimate info


    const materialEstimates = this.getMaterialEstimates(bayIndex);

    const neededGram = this._i18n.t('mb:estimates.material_estimates.g', {
      g: materialEstimates.gram
    });

    const remainingGram = this._i18n.t('mb:estimates.material_estimates.g', {
      g: remainingMaterialAmount !== null ? Math.floor(remainingMaterialAmount) : null
    }); // Filament color, passed to the small filament circles


    const remainingMaterialDonutStyle = {
      borderColor: materialInfo.remainingColor
    };
    const neededMaterialDonutStyle = {
      borderColor: materialInfo.neededColor
    };

    const remainingMaterialDonut = /*#__PURE__*/_react.default.createElement("span", {
      className: "primary-donut",
      style: remainingMaterialDonutStyle
    });

    const neededMaterialDonut = /*#__PURE__*/_react.default.createElement("span", {
      className: "secondary-donut",
      style: neededMaterialDonutStyle
    });

    const materialRemainingPercentage = spool && spool.original_amount > 0 ? Math.ceil(spool.amount_remaining / spool.original_amount * 100) : null;
    const materialNeededPercentage = spool && spool.original_amount > 0 ? Math.ceil(materialEstimates.distance / spool.original_amount * 100) : Math.ceil(materialEstimates.distance / materialEstimates.spoolLength * 100); // this accounts for dumb spools where we don't have spool original_value

    const isSixthGen = this.props.printer.isSixthGen();
    const hasSmartSpool = spool && spool.tag_uid !== null;
    const materialError = spool && (spool.amount_remaining === 0 || materialNeededPercentage >= materialRemainingPercentage);
    const spoolCount = Math.ceil(materialEstimates.distance / materialEstimates.spoolLength);
    const PrintMaterialBadgeProps = {
      printer: this.props.estimateInfo.botType,
      printerIsConnected: this.props.printerIsConnected,
      materialRemainingPercentage,
      materialNeededPercentage,
      remainingMaterialColor: materialInfo.remainingColor,
      neededMaterialColor: materialInfo.neededColor,
      showMaterialError: isSixthGen && hasSmartSpool && materialError,
      showSpoolCount: spoolCount > 1 ? spoolCount : null,
      strokeWidth: 5.67,
      r: 24
    };

    const neededMaterial = /*#__PURE__*/_react.default.createElement("div", null, neededMaterialDonut, neededGram, /*#__PURE__*/_react.default.createElement("span", {
      style: {
        marginLeft: '3px'
      }
    }, this._i18n.t('mb:estimates.material_estimates.status.needed')));

    const remainingMaterial = // For a 6th-gen LABS extruder, we ignore the loaded spool
    !hasLabsExtruder && (!this._isNil(materialRemainingPercentage) || materialRemainingPercentage >= 0) ? /*#__PURE__*/_react.default.createElement("div", null, remainingMaterialDonut, remainingGram, /*#__PURE__*/_react.default.createElement("span", {
      style: {
        marginLeft: '3px'
      }
    }, this._i18n.t('mb:estimates.material_estimates.status.remaining'))) : null;

    const renderMaterialType = () => /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-title"
    }, materialInfo.type);

    const renderMaterialColorName = () => /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-title"
    }, materialInfo.materialColorName);

    const renderNeededMaterial = () => /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-subtitle"
    }, neededMaterial);

    const renderRemainingMaterial = () => /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-subtitle"
    }, hasSmartSpool && remainingMaterial ? remainingMaterial : null);

    const rendershowSpoolFraction = () => /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-subtitle"
    }, showSpoolFraction ? materialEstimates.spoolFraction : null);

    return /*#__PURE__*/_react.default.createElement("div", {
      className: "material-info-wrapper",
      key: `materialEstimate_${bayIndex}`
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "spool"
    }, /*#__PURE__*/_react.default.createElement(_printMaterialBadge.default, PrintMaterialBadgeProps)), /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-details"
    }, renderMaterialType(), renderMaterialColorName(), renderNeededMaterial(), rendershowSpoolFraction(), renderRemainingMaterial()));
  }

  renderMaterial() {
    const spoolInfo = this.props.spoolInfo;
    const estTitle = 'mb:estimates.material_estimates.title';
    const estTitlePlural = 'mb:estimates.material_estimates.title_plural';
    let payload;
    return /*#__PURE__*/_react.default.createElement("div", {
      className: "material-estimate"
    }, /*#__PURE__*/_react.default.createElement("span", {
      className: "estimate-title-modal"
    }, spoolInfo ? this._i18n.t(estTitlePlural) : this._i18n.t(estTitle)), spoolInfo ? spoolInfo.map((spool, bayIndex) => {
      payload = this.constructPayload(spool, bayIndex);
      return this.renderOneMaterialEstimate(payload, bayIndex);
    }) : (payload = this.constructPayload(), this.renderOneMaterialEstimate(payload)));
  }

  renderTime() {
    const timeEstimates = this.getTimeEstimates();
    return /*#__PURE__*/_react.default.createElement("div", {
      className: "time-estimate"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "ready-by"
    }, this._i18n.t('mb:estimates.time_estimates.ready_by')), /*#__PURE__*/_react.default.createElement("div", {
      className: "calendar"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "calendar-details"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "estimated-day"
    }, timeEstimates.day), /*#__PURE__*/_react.default.createElement("div", {
      className: "time"
    }, timeEstimates.time.strTime), /*#__PURE__*/_react.default.createElement("div", {
      className: "ampm"
    }, timeEstimates.time.ampm)), /*#__PURE__*/_react.default.createElement("img", {
      className: "image-calendar",
      src: _path.default.resolve(__dirname, 'images/date-time.svg')
    })), /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-details"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-title"
    }, " ", this._i18n.t('mb:estimates.time_estimates.title')), /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-subtitle"
    }, timeEstimates.duration)));
  }

  render() {
    const isSixthGen = this.props.printer.isSixthGen(); // The estimateInfo may need time to catch up to the newly selected bot

    if (isSixthGen && (!this.props.spoolInfo || this.props.estimateInfo.mass.length < 2)) {
      return /*#__PURE__*/_react.default.createElement(_loadingPlaceholder.default, null);
    }

    return /*#__PURE__*/_react.default.createElement("div", {
      className: "estimate-widget"
    }, this.renderMaterial(), /*#__PURE__*/_react.default.createElement("div", {
      className: "mid-margin"
    }), this.renderTime());
  }

}

Estimates.displayName = 'Estimates';
Estimates.propTypes = _lodash.default.merge({}, _flux_component.default.propTypes, {
  flux: _react.default.PropTypes.object.isRequired,
  printer: _react.default.PropTypes.object.isRequired,
  estimateInfo: _react.default.PropTypes.object.isRequired //{time, mass, botType}

});
module.exports = Estimates;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVzdGltYXRlcy5qcyJdLCJuYW1lcyI6WyJFc3RpbWF0ZXMiLCJGbHV4Q29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsIl9pMThuIiwiZmx1eCIsImdldFNlcnZpY2UiLCJfaXNOaWwiLCJ2YWx1ZSIsInVuZGVmaW5lZCIsImdldE1hdGVyaWFsRXN0aW1hdGVzIiwiYmF5SW5kZXgiLCJtYXRlcmlhbFJlc3VsdHMiLCJncmFtIiwiZXN0aW1hdGVJbmZvIiwibWFzcyIsImRpc3RhbmNlIiwiYm90VHlwZSIsIm1hdGVyaWFsIiwicHJpbnRlciIsImlzU2l4dGhHZW4iLCJzcG9vbExlbmd0aCIsIlN0b2NrTWF0ZXJpYWxMZW5ndGgiLCJtYWtlcmJvdF9nZW5lcmF0aW9uNiIsIkJvdFR5cGVFbnVtIiwic2tldGNoIiwibWFrZXJib3Rfc2tldGNoIiwibWluaV84IiwibWFrZXJib3RfZ2VuZXJhdGlvbjUiLCJwbGFfc21hbGwiLCJzcG9vbEZyYWN0aW9uIiwidCIsInBsYV9sYXJnZSIsImdldFRpbWVBTVBNIiwiZGF0ZSIsImhvdXJzIiwiZ2V0SG91cnMiLCJtaW51dGVzIiwiZ2V0TWludXRlcyIsImFtcG0iLCJzdHJUaW1lIiwiZ2V0RHVyYXRpb24iLCJzZWNvbmRzIiwiZGF5cyIsIk1hdGgiLCJmbG9vciIsImR1cmF0aW9uIiwiZ2V0VGltZUVzdGltYXRlcyIsInRpbWVSZXN1bHRzIiwibm93IiwiRGF0ZSIsImVzdGltYXRlRGF0ZSIsImdldFRpbWUiLCJ0aW1lIiwiZ2V0RGF5IiwiZGF5IiwiZ2V0TWF0ZXJpYWxJbmZvIiwic3Bvb2wiLCJoYXNTbWFydFNwb29sIiwidGFnX3VpZCIsImhhc0xhYnNFeHRydWRlciIsImdldEF0dGFjaGVkRXh0cnVkZXJzIiwiRXh0cnVkZXJUeXBlRW51bSIsIm1rMTRfZSIsIm1hdGVyaWFsSW5mb1Jlc3VsdHMiLCJ0eXBlIiwibWF0ZXJpYWxfdHlwZSIsIlNsaWNlQ29uZmlnU3RyaW5nc1RvUHJldHR5U3RyaW5ncyIsIm1hdGVyaWFsX25hbWUiLCJtYXRlcmlhbENvbG9yTmFtZSIsIm1hdGVyaWFsX2NvbG9yX25hbWUiLCJNYXRlcmlhbERlZmF1bHRzIiwiZGV0ZWN0aW9uX2Vycm9yIiwicmVtYWluaW5nQ29sb3IiLCJuZWVkZWRDb2xvciIsImNvbG9ycyIsImNvbnN0cnVjdFBheWxvYWQiLCJzaG93U3Bvb2xGcmFjdGlvbiIsInNwb29sSW5mbyIsInJlbWFpbmluZ01hdGVyaWFsQW1vdW50IiwiYW1vdW50X3JlbWFpbmluZyIsImxpbmVhcl9kZW5zaXR5IiwibWF0ZXJpYWxJbmZvIiwicmVuZGVyT25lTWF0ZXJpYWxFc3RpbWF0ZSIsInBheWxvYWQiLCJtYXRlcmlhbEVzdGltYXRlcyIsIm5lZWRlZEdyYW0iLCJnIiwicmVtYWluaW5nR3JhbSIsInJlbWFpbmluZ01hdGVyaWFsRG9udXRTdHlsZSIsImJvcmRlckNvbG9yIiwibmVlZGVkTWF0ZXJpYWxEb251dFN0eWxlIiwicmVtYWluaW5nTWF0ZXJpYWxEb251dCIsIm5lZWRlZE1hdGVyaWFsRG9udXQiLCJtYXRlcmlhbFJlbWFpbmluZ1BlcmNlbnRhZ2UiLCJvcmlnaW5hbF9hbW91bnQiLCJjZWlsIiwibWF0ZXJpYWxOZWVkZWRQZXJjZW50YWdlIiwibWF0ZXJpYWxFcnJvciIsInNwb29sQ291bnQiLCJQcmludE1hdGVyaWFsQmFkZ2VQcm9wcyIsInByaW50ZXJJc0Nvbm5lY3RlZCIsInJlbWFpbmluZ01hdGVyaWFsQ29sb3IiLCJuZWVkZWRNYXRlcmlhbENvbG9yIiwic2hvd01hdGVyaWFsRXJyb3IiLCJzaG93U3Bvb2xDb3VudCIsInN0cm9rZVdpZHRoIiwiciIsIm5lZWRlZE1hdGVyaWFsIiwibWFyZ2luTGVmdCIsInJlbWFpbmluZ01hdGVyaWFsIiwicmVuZGVyTWF0ZXJpYWxUeXBlIiwicmVuZGVyTWF0ZXJpYWxDb2xvck5hbWUiLCJyZW5kZXJOZWVkZWRNYXRlcmlhbCIsInJlbmRlclJlbWFpbmluZ01hdGVyaWFsIiwicmVuZGVyc2hvd1Nwb29sRnJhY3Rpb24iLCJyZW5kZXJNYXRlcmlhbCIsImVzdFRpdGxlIiwiZXN0VGl0bGVQbHVyYWwiLCJtYXAiLCJyZW5kZXJUaW1lIiwidGltZUVzdGltYXRlcyIsInBhdGgiLCJyZXNvbHZlIiwiX19kaXJuYW1lIiwicmVuZGVyIiwibGVuZ3RoIiwiZGlzcGxheU5hbWUiLCJwcm9wVHlwZXMiLCJfIiwibWVyZ2UiLCJSZWFjdCIsIlByb3BUeXBlcyIsIm9iamVjdCIsImlzUmVxdWlyZWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQVFBLE1BQU1BLFNBQU4sU0FBd0JDLHVCQUF4QixDQUFzQztBQUNsQ0MsRUFBQUEsV0FBVyxDQUFDQyxLQUFELEVBQVE7QUFDZixVQUFNQSxLQUFOO0FBQ0EsU0FBS0MsS0FBTCxHQUFhLEtBQUtELEtBQUwsQ0FBV0UsSUFBWCxDQUFnQkMsVUFBaEIsQ0FBMkIsb0JBQTNCLENBQWI7QUFDSDs7QUFFREMsRUFBQUEsTUFBTSxDQUFDQyxLQUFELEVBQVE7QUFDVixXQUFPQSxLQUFLLEtBQUssSUFBVixJQUFrQkEsS0FBSyxLQUFLQyxTQUFuQztBQUNIOztBQUVEQyxFQUFBQSxvQkFBb0IsQ0FBQ0MsUUFBUSxHQUFHLENBQVosRUFBZTtBQUMvQixVQUFNQyxlQUFlLEdBQUcsRUFBeEI7QUFDQUEsSUFBQUEsZUFBZSxDQUFDQyxJQUFoQixHQUF1QixtQ0FBcUIsS0FBS1YsS0FBTCxDQUFXVyxZQUFYLENBQXdCQyxJQUF4QixDQUE2QkosUUFBN0IsQ0FBckIsRUFBNkQsQ0FBN0QsQ0FBdkI7QUFDQUMsSUFBQUEsZUFBZSxDQUFDSSxRQUFoQixHQUEyQixLQUFLYixLQUFMLENBQVdXLFlBQVgsQ0FBd0JFLFFBQXhCLENBQWlDTCxRQUFqQyxDQUEzQjtBQUVBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNRLFVBQU1NLE9BQU8sR0FBRyxLQUFLZCxLQUFMLENBQVdXLFlBQVgsQ0FBd0JHLE9BQXhDO0FBQ0EsVUFBTUMsUUFBUSxHQUFHLEtBQUtmLEtBQUwsQ0FBV1csWUFBWCxDQUF3QkksUUFBeEIsQ0FBaUNQLFFBQWpDLENBQWpCOztBQUNBLFFBQUksS0FBS1IsS0FBTCxDQUFXZ0IsT0FBWCxDQUFtQkMsVUFBbkIsRUFBSixFQUFxQztBQUNqQ1IsTUFBQUEsZUFBZSxDQUFDUyxXQUFoQixHQUE4QkMsK0JBQW9CQyxvQkFBcEIsQ0FBeUNMLFFBQXpDLENBQTlCO0FBQ0gsS0FGRCxNQUVPLElBQUlELE9BQU8sS0FBS08sdUJBQVlDLE1BQTVCLEVBQW9DO0FBQ3ZDYixNQUFBQSxlQUFlLENBQUNTLFdBQWhCLEdBQThCQywrQkFBb0JJLGVBQXBCLENBQW9DUixRQUFwQyxDQUE5QjtBQUNILEtBRk0sTUFFQSxJQUFJRCxPQUFPLEtBQUtPLHVCQUFZRyxNQUE1QixFQUFvQztBQUN2Q2YsTUFBQUEsZUFBZSxDQUFDUyxXQUFoQixHQUE4QkMsK0JBQW9CTSxvQkFBcEIsQ0FBeUNDLFNBQXZFOztBQUVBLFVBQUlqQixlQUFlLENBQUNDLElBQWhCLEdBQXVCLEVBQTNCLEVBQStCO0FBQzNCRCxRQUFBQSxlQUFlLENBQUNrQixhQUFoQixHQUFnQyxLQUFLMUIsS0FBTCxDQUFXMkIsQ0FBWCxDQUFhLGlEQUFiLENBQWhDO0FBQ0gsT0FGRCxNQUVPLElBQUluQixlQUFlLENBQUNDLElBQWhCLEdBQXVCLEdBQTNCLEVBQWdDO0FBQ25DRCxRQUFBQSxlQUFlLENBQUNrQixhQUFoQixHQUFnQyxLQUFLMUIsS0FBTCxDQUFXMkIsQ0FBWCxDQUFhLGlEQUFiLENBQWhDO0FBQ0gsT0FGTSxNQUVBLElBQUluQixlQUFlLENBQUNDLElBQWhCLEdBQXVCLEdBQTNCLEVBQWdDO0FBQ25DRCxRQUFBQSxlQUFlLENBQUNrQixhQUFoQixHQUFnQyxLQUFLMUIsS0FBTCxDQUFXMkIsQ0FBWCxDQUFhLGlEQUFiLENBQWhDO0FBQ0gsT0FGTSxNQUVBO0FBQ0huQixRQUFBQSxlQUFlLENBQUNrQixhQUFoQixHQUFnQyxLQUFLMUIsS0FBTCxDQUFXMkIsQ0FBWCxDQUFhLGtEQUFiLENBQWhDO0FBQ0g7QUFDSixLQVpNLE1BWUE7QUFDSG5CLE1BQUFBLGVBQWUsQ0FBQ1MsV0FBaEIsR0FBOEJDLCtCQUFvQk0sb0JBQXBCLENBQXlDSSxTQUF2RTs7QUFFQSxVQUFJcEIsZUFBZSxDQUFDQyxJQUFoQixHQUF1QixHQUEzQixFQUFnQztBQUM1QkQsUUFBQUEsZUFBZSxDQUFDa0IsYUFBaEIsR0FBZ0MsS0FBSzFCLEtBQUwsQ0FBVzJCLENBQVgsQ0FBYSxpREFBYixDQUFoQztBQUNILE9BRkQsTUFFTyxJQUFJbkIsZUFBZSxDQUFDQyxJQUFoQixHQUF1QixHQUEzQixFQUFnQztBQUNuQ0QsUUFBQUEsZUFBZSxDQUFDa0IsYUFBaEIsR0FBZ0MsS0FBSzFCLEtBQUwsQ0FBVzJCLENBQVgsQ0FBYSxpREFBYixDQUFoQztBQUNILE9BRk0sTUFFQSxJQUFJbkIsZUFBZSxDQUFDQyxJQUFoQixHQUF1QixHQUEzQixFQUFnQztBQUNuQ0QsUUFBQUEsZUFBZSxDQUFDa0IsYUFBaEIsR0FBZ0MsS0FBSzFCLEtBQUwsQ0FBVzJCLENBQVgsQ0FBYSxpREFBYixDQUFoQztBQUNILE9BRk0sTUFFQTtBQUNIbkIsUUFBQUEsZUFBZSxDQUFDa0IsYUFBaEIsR0FBZ0MsS0FBSzFCLEtBQUwsQ0FBVzJCLENBQVgsQ0FBYSxrREFBYixDQUFoQztBQUNIO0FBQ0o7O0FBRUQsV0FBT25CLGVBQVA7QUFDSDs7QUFFRHFCLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPO0FBQ2QsUUFBSUMsS0FBSyxHQUFHRCxJQUFJLENBQUNFLFFBQUwsRUFBWjtBQUNBLFFBQUlDLE9BQU8sR0FBR0gsSUFBSSxDQUFDSSxVQUFMLEVBQWQ7QUFDQSxVQUFNQyxJQUFJLEdBQUdKLEtBQUssSUFBSSxFQUFULEdBQWMsSUFBZCxHQUFxQixJQUFsQztBQUNBQSxJQUFBQSxLQUFLLEdBQUdBLEtBQUssR0FBRyxFQUFoQjtBQUNBQSxJQUFBQSxLQUFLLEdBQUdBLEtBQUssR0FBR0EsS0FBSCxHQUFXLEVBQXhCLENBTGMsQ0FLYzs7QUFDNUJFLElBQUFBLE9BQU8sR0FBR0EsT0FBTyxHQUFHLEVBQVYsR0FBZ0IsSUFBR0EsT0FBUSxFQUEzQixHQUFnQyxHQUFFQSxPQUFRLEVBQXBEO0FBQ0EsVUFBTUcsT0FBTyxHQUFJLEdBQUVMLEtBQU0sSUFBR0UsT0FBUSxFQUFwQztBQUVBLFdBQU87QUFBRUcsTUFBQUEsT0FBRjtBQUFXRCxNQUFBQTtBQUFYLEtBQVA7QUFDSDs7QUFFREUsRUFBQUEsV0FBVyxDQUFDQyxPQUFELEVBQVU7QUFDakIsVUFBTUMsSUFBSSxHQUFHQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0gsT0FBTyxJQUFJLE9BQU8sRUFBWCxDQUFsQixDQUFiO0FBQ0FBLElBQUFBLE9BQU8sR0FBR0EsT0FBTyxHQUFHQyxJQUFJLEdBQUcsSUFBUCxHQUFjLEVBQWxDO0FBQ0EsVUFBTVIsS0FBSyxHQUFHUyxJQUFJLENBQUNDLEtBQUwsQ0FBV0gsT0FBTyxHQUFHLElBQXJCLENBQWQ7QUFDQUEsSUFBQUEsT0FBTyxHQUFHQSxPQUFPLEdBQUdQLEtBQUssR0FBRyxJQUE1QjtBQUNBLFVBQU1FLE9BQU8sR0FBR08sSUFBSSxDQUFDQyxLQUFMLENBQVdILE9BQU8sR0FBRyxFQUFyQixDQUFoQjtBQUNBLFFBQUlJLFFBQVEsR0FBRyxFQUFmOztBQUNBLFFBQUlILElBQUksR0FBRyxDQUFYLEVBQWM7QUFDVkcsTUFBQUEsUUFBUSxJQUFLLEdBQUVILElBQUssSUFBcEI7QUFDSDs7QUFDRCxRQUFJUixLQUFLLEdBQUcsQ0FBWixFQUFlO0FBQ1hXLE1BQUFBLFFBQVEsSUFBSyxHQUFFWCxLQUFNLElBQXJCO0FBQ0g7O0FBRUQsV0FBUSxHQUFFVyxRQUFRLEdBQUdULE9BQVEsR0FBN0I7QUFDSDs7QUFFRFUsRUFBQUEsZ0JBQWdCLEdBQUc7QUFDZixVQUFNQyxXQUFXLEdBQUcsRUFBcEI7QUFDQSxVQUFNQyxHQUFHLEdBQUcsSUFBSUMsSUFBSixFQUFaO0FBQ0EsVUFBTUMsWUFBWSxHQUFHLElBQUlELElBQUosQ0FBU0QsR0FBRyxDQUFDRyxPQUFKLEtBQWdCLE9BQU8sS0FBS2pELEtBQUwsQ0FBV1csWUFBWCxDQUF3QnVDLElBQXhELENBQXJCLENBSGUsQ0FJZjs7QUFDQSxRQUFJSixHQUFHLENBQUNLLE1BQUosTUFBZ0JILFlBQVksQ0FBQ0csTUFBYixFQUFoQixJQUF5QyxLQUFLbkQsS0FBTCxDQUFXVyxZQUFYLENBQXdCdUMsSUFBeEIsR0FBK0IsS0FBSyxFQUFMLEdBQVUsRUFBdEYsRUFBMEY7QUFDdEY7QUFDQUwsTUFBQUEsV0FBVyxDQUFDTyxHQUFaLEdBQWtCLEtBQUtuRCxLQUFMLENBQVcyQixDQUFYLENBQWEsbUNBQWIsQ0FBbEI7QUFDSCxLQUhELE1BR08sSUFBSWtCLEdBQUcsQ0FBQ0ssTUFBSixLQUFlLENBQWYsSUFBb0JILFlBQVksQ0FBQ0csTUFBYixFQUFwQixJQUE2QyxLQUFLbkQsS0FBTCxDQUFXVyxZQUFYLENBQXdCdUMsSUFBeEIsR0FBK0IsS0FBSyxFQUFMLEdBQVUsRUFBMUYsRUFBOEY7QUFDakc7QUFDQUwsTUFBQUEsV0FBVyxDQUFDTyxHQUFaLEdBQWtCLEtBQUtuRCxLQUFMLENBQVcyQixDQUFYLENBQWEsc0NBQWIsQ0FBbEI7QUFDSCxLQUhNLE1BR0E7QUFDSGlCLE1BQUFBLFdBQVcsQ0FBQ08sR0FBWixHQUFrQixLQUFLbkQsS0FBTCxDQUFXMkIsQ0FBWCxDQUFjLCtCQUE4Qm9CLFlBQVksQ0FBQ0csTUFBYixFQUFzQixFQUFsRSxDQUFsQjtBQUNILEtBYmMsQ0FjZjs7O0FBQ0FOLElBQUFBLFdBQVcsQ0FBQ0ssSUFBWixHQUFtQixLQUFLcEIsV0FBTCxDQUFpQmtCLFlBQWpCLENBQW5CLENBZmUsQ0FnQmY7O0FBQ0FILElBQUFBLFdBQVcsQ0FBQ0YsUUFBWixHQUF1QixLQUFLTCxXQUFMLENBQWlCLEtBQUt0QyxLQUFMLENBQVdXLFlBQVgsQ0FBd0J1QyxJQUF6QyxDQUF2QjtBQUVBLFdBQU9MLFdBQVA7QUFDSDs7QUFFRFEsRUFBQUEsZUFBZSxDQUFDQyxLQUFELEVBQVE5QyxRQUFSLEVBQWtCO0FBQzdCO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1EsVUFBTStDLGFBQWEsR0FBR0QsS0FBSyxJQUFJQSxLQUFLLENBQUNFLE9BQU4sS0FBa0IsSUFBakQ7O0FBQ0EsVUFBTUMsZUFBZSxHQUFHLEtBQUt6RCxLQUFMLENBQVdnQixPQUFYLENBQW1CMEMsb0JBQW5CLEdBQTBDLENBQTFDLE1BQWlEQyw0QkFBaUJDLE1BQTFGOztBQUNBLFVBQU1DLG1CQUFtQixHQUFHLEVBQTVCOztBQUVBLFFBQUlOLGFBQWEsSUFBSSxDQUFDRSxlQUF0QixFQUF1QztBQUNuQ0ksTUFBQUEsbUJBQW1CLENBQUNDLElBQXBCLEdBQTJCUixLQUFLLENBQUNTLGFBQU4sR0FDckJDLDZDQUFrQ1YsS0FBSyxDQUFDVyxhQUF4QyxDQURxQixHQUVyQkQsNkNBQWtDLGVBQWxDLENBRk47QUFHQUgsTUFBQUEsbUJBQW1CLENBQUNLLGlCQUFwQixHQUNJWixLQUFLLENBQUNhLG1CQUFOLEtBQThCLEVBQTlCLEdBQ01iLEtBQUssQ0FBQ2EsbUJBRFosR0FFTyxTQUFRQyw0QkFBaUJDLGVBQWdCLEVBSHBEO0FBSUFSLE1BQUFBLG1CQUFtQixDQUFDUyxjQUFwQixHQUFxQyxrQ0FBb0JoQixLQUFwQixFQUEyQmdCLGNBQWhFO0FBQ0FULE1BQUFBLG1CQUFtQixDQUFDVSxXQUFwQixHQUFrQyxrQ0FBb0JqQixLQUFwQixFQUEyQmlCLFdBQTdEO0FBQ0EsYUFBT1YsbUJBQVA7QUFDSCxLQVhELE1BV087QUFDSHJELE1BQUFBLFFBQVEsR0FBRyxDQUFDLEtBQUtKLE1BQUwsQ0FBWUksUUFBWixDQUFELEdBQXlCQSxRQUF6QixHQUFvQyxDQUEvQztBQUNBLFlBQU1PLFFBQVEsR0FBRyxLQUFLZixLQUFMLENBQVdXLFlBQVgsQ0FBd0JJLFFBQXhCLENBQWlDUCxRQUFqQyxDQUFqQjtBQUVBcUQsTUFBQUEsbUJBQW1CLENBQUNDLElBQXBCLEdBQTJCRSw2Q0FBa0NqRCxRQUFsQyxDQUEzQjtBQUNBOEMsTUFBQUEsbUJBQW1CLENBQUNVLFdBQXBCLEdBQWtDSCw0QkFBaUJJLE1BQWpCLENBQXdCekQsUUFBeEIsQ0FBbEM7QUFFQSxhQUFPOEMsbUJBQVA7QUFDSDtBQUNKOztBQUVEWSxFQUFBQSxnQkFBZ0IsQ0FBQ25CLEtBQUQsRUFBUTlDLFFBQVIsRUFBa0I7QUFDOUIsV0FBTztBQUNIa0UsTUFBQUEsaUJBQWlCLEVBQUUsQ0FBQyxLQUFLMUUsS0FBTCxDQUFXMkUsU0FENUI7QUFFSEMsTUFBQUEsdUJBQXVCLEVBQ25CdEIsS0FBSyxJQUFJQSxLQUFLLENBQUN1QixnQkFBTixJQUEwQixDQUFuQyxHQUNNLGdDQUFxQnZCLEtBQUssQ0FBQ3VCLGdCQUEzQixFQUE2Q3ZCLEtBQUssQ0FBQ3dCLGNBQW5ELENBRE4sR0FFTSxJQUxQO0FBTUhDLE1BQUFBLFlBQVksRUFBRSxLQUFLMUIsZUFBTCxDQUFxQkMsS0FBckIsRUFBNEI5QyxRQUE1QixDQU5YO0FBT0g4QyxNQUFBQTtBQVBHLEtBQVA7QUFTSDs7QUFFRDBCLEVBQUFBLHlCQUF5QixDQUFDQyxPQUFELEVBQVV6RSxRQUFWLEVBQW9CO0FBQ3pDLFVBQU07QUFBRXVFLE1BQUFBLFlBQUY7QUFBZ0JMLE1BQUFBLGlCQUFoQjtBQUFtQ0UsTUFBQUEsdUJBQW5DO0FBQTREdEIsTUFBQUE7QUFBNUQsUUFBc0UyQixPQUE1RTs7QUFDQSxVQUFNeEIsZUFBZSxHQUFHLEtBQUt6RCxLQUFMLENBQVdnQixPQUFYLENBQW1CMEMsb0JBQW5CLEdBQTBDbEQsUUFBMUMsTUFBd0RtRCw0QkFBaUJDLE1BQWpHLENBRnlDLENBSXpDOzs7QUFDQSxVQUFNc0IsaUJBQWlCLEdBQUcsS0FBSzNFLG9CQUFMLENBQTBCQyxRQUExQixDQUExQjs7QUFDQSxVQUFNMkUsVUFBVSxHQUFHLEtBQUtsRixLQUFMLENBQVcyQixDQUFYLENBQWEsbUNBQWIsRUFBa0Q7QUFBRXdELE1BQUFBLENBQUMsRUFBRUYsaUJBQWlCLENBQUN4RTtBQUF2QixLQUFsRCxDQUFuQjs7QUFDQSxVQUFNMkUsYUFBYSxHQUFHLEtBQUtwRixLQUFMLENBQVcyQixDQUFYLENBQWEsbUNBQWIsRUFBa0Q7QUFDcEV3RCxNQUFBQSxDQUFDLEVBQUVSLHVCQUF1QixLQUFLLElBQTVCLEdBQW1DbkMsSUFBSSxDQUFDQyxLQUFMLENBQVdrQyx1QkFBWCxDQUFuQyxHQUF5RTtBQURSLEtBQWxELENBQXRCLENBUHlDLENBV3pDOzs7QUFDQSxVQUFNVSwyQkFBMkIsR0FBRztBQUFFQyxNQUFBQSxXQUFXLEVBQUVSLFlBQVksQ0FBQ1Q7QUFBNUIsS0FBcEM7QUFDQSxVQUFNa0Isd0JBQXdCLEdBQUc7QUFBRUQsTUFBQUEsV0FBVyxFQUFFUixZQUFZLENBQUNSO0FBQTVCLEtBQWpDOztBQUNBLFVBQU1rQixzQkFBc0IsZ0JBQUc7QUFBTSxNQUFBLFNBQVMsRUFBQyxlQUFoQjtBQUFnQyxNQUFBLEtBQUssRUFBRUg7QUFBdkMsTUFBL0I7O0FBQ0EsVUFBTUksbUJBQW1CLGdCQUFHO0FBQU0sTUFBQSxTQUFTLEVBQUMsaUJBQWhCO0FBQWtDLE1BQUEsS0FBSyxFQUFFRjtBQUF6QyxNQUE1Qjs7QUFFQSxVQUFNRywyQkFBMkIsR0FDN0JyQyxLQUFLLElBQUlBLEtBQUssQ0FBQ3NDLGVBQU4sR0FBd0IsQ0FBakMsR0FDTW5ELElBQUksQ0FBQ29ELElBQUwsQ0FBV3ZDLEtBQUssQ0FBQ3VCLGdCQUFOLEdBQXlCdkIsS0FBSyxDQUFDc0MsZUFBaEMsR0FBbUQsR0FBN0QsQ0FETixHQUVNLElBSFY7QUFJQSxVQUFNRSx3QkFBd0IsR0FDMUJ4QyxLQUFLLElBQUlBLEtBQUssQ0FBQ3NDLGVBQU4sR0FBd0IsQ0FBakMsR0FDTW5ELElBQUksQ0FBQ29ELElBQUwsQ0FBV1gsaUJBQWlCLENBQUNyRSxRQUFsQixHQUE2QnlDLEtBQUssQ0FBQ3NDLGVBQXBDLEdBQXVELEdBQWpFLENBRE4sR0FFTW5ELElBQUksQ0FBQ29ELElBQUwsQ0FBV1gsaUJBQWlCLENBQUNyRSxRQUFsQixHQUE2QnFFLGlCQUFpQixDQUFDaEUsV0FBaEQsR0FBK0QsR0FBekUsQ0FIVixDQXJCeUMsQ0F3QmdEOztBQUV6RixVQUFNRCxVQUFVLEdBQUcsS0FBS2pCLEtBQUwsQ0FBV2dCLE9BQVgsQ0FBbUJDLFVBQW5CLEVBQW5CO0FBQ0EsVUFBTXNDLGFBQWEsR0FBR0QsS0FBSyxJQUFJQSxLQUFLLENBQUNFLE9BQU4sS0FBa0IsSUFBakQ7QUFDQSxVQUFNdUMsYUFBYSxHQUNmekMsS0FBSyxLQUFLQSxLQUFLLENBQUN1QixnQkFBTixLQUEyQixDQUEzQixJQUFnQ2lCLHdCQUF3QixJQUFJSCwyQkFBakUsQ0FEVDtBQUVBLFVBQU1LLFVBQVUsR0FBR3ZELElBQUksQ0FBQ29ELElBQUwsQ0FBVVgsaUJBQWlCLENBQUNyRSxRQUFsQixHQUE2QnFFLGlCQUFpQixDQUFDaEUsV0FBekQsQ0FBbkI7QUFFQSxVQUFNK0UsdUJBQXVCLEdBQUc7QUFDNUJqRixNQUFBQSxPQUFPLEVBQUUsS0FBS2hCLEtBQUwsQ0FBV1csWUFBWCxDQUF3QkcsT0FETDtBQUU1Qm9GLE1BQUFBLGtCQUFrQixFQUFFLEtBQUtsRyxLQUFMLENBQVdrRyxrQkFGSDtBQUc1QlAsTUFBQUEsMkJBSDRCO0FBSTVCRyxNQUFBQSx3QkFKNEI7QUFLNUJLLE1BQUFBLHNCQUFzQixFQUFFcEIsWUFBWSxDQUFDVCxjQUxUO0FBTTVCOEIsTUFBQUEsbUJBQW1CLEVBQUVyQixZQUFZLENBQUNSLFdBTk47QUFPNUI4QixNQUFBQSxpQkFBaUIsRUFBRXBGLFVBQVUsSUFBSXNDLGFBQWQsSUFBK0J3QyxhQVB0QjtBQVE1Qk8sTUFBQUEsY0FBYyxFQUFFTixVQUFVLEdBQUcsQ0FBYixHQUFpQkEsVUFBakIsR0FBOEIsSUFSbEI7QUFTNUJPLE1BQUFBLFdBQVcsRUFBRSxJQVRlO0FBVTVCQyxNQUFBQSxDQUFDLEVBQUU7QUFWeUIsS0FBaEM7O0FBYUEsVUFBTUMsY0FBYyxnQkFDaEIsMENBQ0tmLG1CQURMLEVBRUtQLFVBRkwsZUFHSTtBQUFNLE1BQUEsS0FBSyxFQUFFO0FBQUV1QixRQUFBQSxVQUFVLEVBQUU7QUFBZDtBQUFiLE9BQ0ssS0FBS3pHLEtBQUwsQ0FBVzJCLENBQVgsQ0FBYSwrQ0FBYixDQURMLENBSEosQ0FESjs7QUFTQSxVQUFNK0UsaUJBQWlCLEdBQ25CO0FBQ0EsS0FBQ2xELGVBQUQsS0FBcUIsQ0FBQyxLQUFLckQsTUFBTCxDQUFZdUYsMkJBQVosQ0FBRCxJQUE2Q0EsMkJBQTJCLElBQUksQ0FBakcsaUJBQ0ksMENBQ0tGLHNCQURMLEVBRUtKLGFBRkwsZUFHSTtBQUFNLE1BQUEsS0FBSyxFQUFFO0FBQUVxQixRQUFBQSxVQUFVLEVBQUU7QUFBZDtBQUFiLE9BQ0ssS0FBS3pHLEtBQUwsQ0FBVzJCLENBQVgsQ0FBYSxrREFBYixDQURMLENBSEosQ0FESixHQVFJLElBVlI7O0FBWUEsVUFBTWdGLGtCQUFrQixHQUFHLG1CQUFNO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixPQUFpQzdCLFlBQVksQ0FBQ2pCLElBQTlDLENBQWpDOztBQUNBLFVBQU0rQyx1QkFBdUIsR0FBRyxtQkFBTTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FBaUM5QixZQUFZLENBQUNiLGlCQUE5QyxDQUF0Qzs7QUFDQSxVQUFNNEMsb0JBQW9CLEdBQUcsbUJBQU07QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLE9BQW9DTCxjQUFwQyxDQUFuQzs7QUFDQSxVQUFNTSx1QkFBdUIsR0FBRyxtQkFDNUI7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLE9BQW9DeEQsYUFBYSxJQUFJb0QsaUJBQWpCLEdBQXFDQSxpQkFBckMsR0FBeUQsSUFBN0YsQ0FESjs7QUFHQSxVQUFNSyx1QkFBdUIsR0FBRyxtQkFDNUI7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLE9BQW9DdEMsaUJBQWlCLEdBQUdRLGlCQUFpQixDQUFDdkQsYUFBckIsR0FBcUMsSUFBMUYsQ0FESjs7QUFJQSx3QkFDSTtBQUFLLE1BQUEsU0FBUyxFQUFDLHVCQUFmO0FBQXVDLE1BQUEsR0FBRyxFQUFHLG9CQUFtQm5CLFFBQVM7QUFBekUsb0JBQ0k7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLG9CQUNJLDZCQUFDLDJCQUFELEVBQXdCeUYsdUJBQXhCLENBREosQ0FESixlQUlJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixPQUNLVyxrQkFBa0IsRUFEdkIsRUFFS0MsdUJBQXVCLEVBRjVCLEVBR0tDLG9CQUFvQixFQUh6QixFQUlLRSx1QkFBdUIsRUFKNUIsRUFLS0QsdUJBQXVCLEVBTDVCLENBSkosQ0FESjtBQWNIOztBQUVERSxFQUFBQSxjQUFjLEdBQUc7QUFDYixVQUFNdEMsU0FBUyxHQUFHLEtBQUszRSxLQUFMLENBQVcyRSxTQUE3QjtBQUNBLFVBQU11QyxRQUFRLEdBQUcsdUNBQWpCO0FBQ0EsVUFBTUMsY0FBYyxHQUFHLDhDQUF2QjtBQUNBLFFBQUlsQyxPQUFKO0FBRUEsd0JBQ0k7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLG9CQUNJO0FBQU0sTUFBQSxTQUFTLEVBQUM7QUFBaEIsT0FDS04sU0FBUyxHQUFHLEtBQUsxRSxLQUFMLENBQVcyQixDQUFYLENBQWF1RixjQUFiLENBQUgsR0FBa0MsS0FBS2xILEtBQUwsQ0FBVzJCLENBQVgsQ0FBYXNGLFFBQWIsQ0FEaEQsQ0FESixFQUlLdkMsU0FBUyxHQUNKQSxTQUFTLENBQUN5QyxHQUFWLENBQWMsQ0FBQzlELEtBQUQsRUFBUTlDLFFBQVIsS0FBcUI7QUFDL0J5RSxNQUFBQSxPQUFPLEdBQUcsS0FBS1IsZ0JBQUwsQ0FBc0JuQixLQUF0QixFQUE2QjlDLFFBQTdCLENBQVY7QUFDQSxhQUFPLEtBQUt3RSx5QkFBTCxDQUErQkMsT0FBL0IsRUFBd0N6RSxRQUF4QyxDQUFQO0FBQ0gsS0FIRCxDQURJLElBS0Z5RSxPQUFPLEdBQUcsS0FBS1IsZ0JBQUwsRUFBWCxFQUFxQyxLQUFLTyx5QkFBTCxDQUErQkMsT0FBL0IsQ0FMbEMsQ0FKZCxDQURKO0FBYUg7O0FBRURvQyxFQUFBQSxVQUFVLEdBQUc7QUFDVCxVQUFNQyxhQUFhLEdBQUcsS0FBSzFFLGdCQUFMLEVBQXRCO0FBRUEsd0JBQ0k7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLG9CQUNJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixPQUEyQixLQUFLM0MsS0FBTCxDQUFXMkIsQ0FBWCxDQUFhLHNDQUFiLENBQTNCLENBREosZUFFSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsb0JBQ0k7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLG9CQUNJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixPQUFnQzBGLGFBQWEsQ0FBQ2xFLEdBQTlDLENBREosZUFFSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FBdUJrRSxhQUFhLENBQUNwRSxJQUFkLENBQW1CYixPQUExQyxDQUZKLGVBR0k7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLE9BQXVCaUYsYUFBYSxDQUFDcEUsSUFBZCxDQUFtQmQsSUFBMUMsQ0FISixDQURKLGVBTUk7QUFBSyxNQUFBLFNBQVMsRUFBQyxnQkFBZjtBQUFnQyxNQUFBLEdBQUcsRUFBRW1GLGNBQUtDLE9BQUwsQ0FBYUMsU0FBYixFQUF3QixzQkFBeEI7QUFBckMsTUFOSixDQUZKLGVBVUk7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLG9CQUNJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixZQUFrQyxLQUFLeEgsS0FBTCxDQUFXMkIsQ0FBWCxDQUFhLG1DQUFiLENBQWxDLENBREosZUFFSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FBb0MwRixhQUFhLENBQUMzRSxRQUFsRCxDQUZKLENBVkosQ0FESjtBQWlCSDs7QUFFRCtFLEVBQUFBLE1BQU0sR0FBRztBQUNMLFVBQU16RyxVQUFVLEdBQUcsS0FBS2pCLEtBQUwsQ0FBV2dCLE9BQVgsQ0FBbUJDLFVBQW5CLEVBQW5CLENBREssQ0FFTDs7QUFDQSxRQUFJQSxVQUFVLEtBQUssQ0FBQyxLQUFLakIsS0FBTCxDQUFXMkUsU0FBWixJQUF5QixLQUFLM0UsS0FBTCxDQUFXVyxZQUFYLENBQXdCQyxJQUF4QixDQUE2QitHLE1BQTdCLEdBQXNDLENBQXBFLENBQWQsRUFBc0Y7QUFDbEYsMEJBQU8sNkJBQUMsMkJBQUQsT0FBUDtBQUNIOztBQUVELHdCQUNJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixPQUNLLEtBQUtWLGNBQUwsRUFETCxlQUVJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixNQUZKLEVBR0ssS0FBS0ksVUFBTCxFQUhMLENBREo7QUFPSDs7QUEvU2lDOztBQWtUdEN4SCxTQUFTLENBQUMrSCxXQUFWLEdBQXdCLFdBQXhCO0FBQ0EvSCxTQUFTLENBQUNnSSxTQUFWLEdBQXNCQyxnQkFBRUMsS0FBRixDQUFRLEVBQVIsRUFBWWpJLHdCQUFjK0gsU0FBMUIsRUFBcUM7QUFDdkQzSCxFQUFBQSxJQUFJLEVBQUU4SCxlQUFNQyxTQUFOLENBQWdCQyxNQUFoQixDQUF1QkMsVUFEMEI7QUFFdkRuSCxFQUFBQSxPQUFPLEVBQUVnSCxlQUFNQyxTQUFOLENBQWdCQyxNQUFoQixDQUF1QkMsVUFGdUI7QUFHdkR4SCxFQUFBQSxZQUFZLEVBQUVxSCxlQUFNQyxTQUFOLENBQWdCQyxNQUFoQixDQUF1QkMsVUFIa0IsQ0FHTjs7QUFITSxDQUFyQyxDQUF0QjtBQU1BQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJ4SSxTQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XHJcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgRmx1eENvbXBvbmVudCBmcm9tICdlYWdsZS1wcmludC92aWV3cy9mbHV4X2NvbXBvbmVudCc7XHJcblxyXG5pbXBvcnQgUHJpbnRNYXRlcmlhbEJhZGdlIGZyb20gJy4vcHJpbnRNYXRlcmlhbEJhZGdlJztcclxuaW1wb3J0IExvYWRpbmcgZnJvbSAnLi9sb2FkaW5nUGxhY2Vob2xkZXInO1xyXG5pbXBvcnQgeyBmb3JtYXRNYXRlcmlhbEFtb3VudCwgZm9ybWF0TWF0ZXJpYWxDb2xvciB9IGZyb20gJy4vdXRpbGl0aWVzL3RpbWVBbmRFc3RpbWF0ZXMvdWlVdGlscyc7XHJcbmltcG9ydCB7IGZpbGFtZW50TGVuZ3RoVG9NYXNzIH0gZnJvbSAnLi4vLi4vdXRpbCc7XHJcbmltcG9ydCB7XHJcbiAgICBCb3RUeXBlRW51bSxcclxuICAgIEV4dHJ1ZGVyVHlwZUVudW0sXHJcbiAgICBTbGljZUNvbmZpZ1N0cmluZ3NUb1ByZXR0eVN0cmluZ3MsXHJcbiAgICBNYXRlcmlhbERlZmF1bHRzLFxyXG4gICAgU3RvY2tNYXRlcmlhbExlbmd0aCxcclxufSBmcm9tICcuLi8uLi9jb25zdGFudHMnO1xyXG5cclxuY2xhc3MgRXN0aW1hdGVzIGV4dGVuZHMgRmx1eENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICB0aGlzLl9pMThuID0gdGhpcy5wcm9wcy5mbHV4LmdldFNlcnZpY2UoJ1RyYW5zbGF0aW9uU2VydmljZScpO1xyXG4gICAgfVxyXG5cclxuICAgIF9pc05pbCh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE1hdGVyaWFsRXN0aW1hdGVzKGJheUluZGV4ID0gMCkge1xyXG4gICAgICAgIGNvbnN0IG1hdGVyaWFsUmVzdWx0cyA9IHt9O1xyXG4gICAgICAgIG1hdGVyaWFsUmVzdWx0cy5ncmFtID0gZm9ybWF0TWF0ZXJpYWxBbW91bnQodGhpcy5wcm9wcy5lc3RpbWF0ZUluZm8ubWFzc1tiYXlJbmRleF0sIDIpO1xyXG4gICAgICAgIG1hdGVyaWFsUmVzdWx0cy5kaXN0YW5jZSA9IHRoaXMucHJvcHMuZXN0aW1hdGVJbmZvLmRpc3RhbmNlW2JheUluZGV4XTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogZGVyaXZlIHN0b2NrIG1hdGVyaWFsIGxlbmd0aCBmb3Igb2ZmbGluZSBlc3RpbWF0ZXMgJiBjcmVhdGUgc3VwcGxlbWVudGFsIHRleHQgYWJvdXQgPCA2dGggZ2VuIHNwb29sIHNpemUuLi5cclxuICAgICAgICAgKiA2dGggZ2VuOiBjaGVjayBib3QgdHlwZSAmIHRvb2xwYXRoIG1hdGVyaWFsIGVzdGltYXRlIGluIGVhY2ggYmF5SW5kZXggLT4gYXNzaWduIHN0b2NrIG1hdGVyaWFsIGxlbmd0aFxyXG4gICAgICAgICAqIGluIGEgd2F5IHdlIGNhbiB1c2UgdG8gY29tcGFyZSB3aXRoIHRvb2xwYXRoJ3MgZXh0cnVzaW9uX2Rpc3RhbmNlXHJcbiAgICAgICAgICogNXRoIGdlbjogY2hlY2sgaWYgYm90IGlzIGEgbWluaSBvciBzdGFuZGFyZCBzaXplIC0+IGFzc2lnbiBzdG9jayBwbGEgbGVuZ3RoXHJcbiAgICAgICAgICogVE9ETzogYWJzdHJhY3Qgc3VwcGxlbWVudGFsIHNwb29sIHRleHQgaW50byBzZXBhcmF0ZSBmdW5jdGlvbiB0byBjbGVhbiB1cCBsb2dpY1xyXG4gICAgICAgICAqKi9cclxuICAgICAgICBjb25zdCBib3RUeXBlID0gdGhpcy5wcm9wcy5lc3RpbWF0ZUluZm8uYm90VHlwZTtcclxuICAgICAgICBjb25zdCBtYXRlcmlhbCA9IHRoaXMucHJvcHMuZXN0aW1hdGVJbmZvLm1hdGVyaWFsW2JheUluZGV4XTtcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5wcmludGVyLmlzU2l4dGhHZW4oKSkge1xyXG4gICAgICAgICAgICBtYXRlcmlhbFJlc3VsdHMuc3Bvb2xMZW5ndGggPSBTdG9ja01hdGVyaWFsTGVuZ3RoLm1ha2VyYm90X2dlbmVyYXRpb242W21hdGVyaWFsXTtcclxuICAgICAgICB9IGVsc2UgaWYgKGJvdFR5cGUgPT09IEJvdFR5cGVFbnVtLnNrZXRjaCkge1xyXG4gICAgICAgICAgICBtYXRlcmlhbFJlc3VsdHMuc3Bvb2xMZW5ndGggPSBTdG9ja01hdGVyaWFsTGVuZ3RoLm1ha2VyYm90X3NrZXRjaFttYXRlcmlhbF07XHJcbiAgICAgICAgfSBlbHNlIGlmIChib3RUeXBlID09PSBCb3RUeXBlRW51bS5taW5pXzgpIHtcclxuICAgICAgICAgICAgbWF0ZXJpYWxSZXN1bHRzLnNwb29sTGVuZ3RoID0gU3RvY2tNYXRlcmlhbExlbmd0aC5tYWtlcmJvdF9nZW5lcmF0aW9uNS5wbGFfc21hbGw7XHJcblxyXG4gICAgICAgICAgICBpZiAobWF0ZXJpYWxSZXN1bHRzLmdyYW0gPCA3Mykge1xyXG4gICAgICAgICAgICAgICAgbWF0ZXJpYWxSZXN1bHRzLnNwb29sRnJhY3Rpb24gPSB0aGlzLl9pMThuLnQoJ21iOmVzdGltYXRlcy5tYXRlcmlhbF9lc3RpbWF0ZXMuc21hbGxfc3Bvb2wuMS8zJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0ZXJpYWxSZXN1bHRzLmdyYW0gPCAxNDUpIHtcclxuICAgICAgICAgICAgICAgIG1hdGVyaWFsUmVzdWx0cy5zcG9vbEZyYWN0aW9uID0gdGhpcy5faTE4bi50KCdtYjplc3RpbWF0ZXMubWF0ZXJpYWxfZXN0aW1hdGVzLnNtYWxsX3Nwb29sLjIvMycpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGVyaWFsUmVzdWx0cy5ncmFtIDwgMjEwKSB7XHJcbiAgICAgICAgICAgICAgICBtYXRlcmlhbFJlc3VsdHMuc3Bvb2xGcmFjdGlvbiA9IHRoaXMuX2kxOG4udCgnbWI6ZXN0aW1hdGVzLm1hdGVyaWFsX2VzdGltYXRlcy5zbWFsbF9zcG9vbC4zLzMnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG1hdGVyaWFsUmVzdWx0cy5zcG9vbEZyYWN0aW9uID0gdGhpcy5faTE4bi50KCdtYjplc3RpbWF0ZXMubWF0ZXJpYWxfZXN0aW1hdGVzLnNtYWxsX3Nwb29sLjMrLzMnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1hdGVyaWFsUmVzdWx0cy5zcG9vbExlbmd0aCA9IFN0b2NrTWF0ZXJpYWxMZW5ndGgubWFrZXJib3RfZ2VuZXJhdGlvbjUucGxhX2xhcmdlO1xyXG5cclxuICAgICAgICAgICAgaWYgKG1hdGVyaWFsUmVzdWx0cy5ncmFtIDwgMzAyKSB7XHJcbiAgICAgICAgICAgICAgICBtYXRlcmlhbFJlc3VsdHMuc3Bvb2xGcmFjdGlvbiA9IHRoaXMuX2kxOG4udCgnbWI6ZXN0aW1hdGVzLm1hdGVyaWFsX2VzdGltYXRlcy5sYXJnZV9zcG9vbC4xLzMnKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRlcmlhbFJlc3VsdHMuZ3JhbSA8IDYwNCkge1xyXG4gICAgICAgICAgICAgICAgbWF0ZXJpYWxSZXN1bHRzLnNwb29sRnJhY3Rpb24gPSB0aGlzLl9pMThuLnQoJ21iOmVzdGltYXRlcy5tYXRlcmlhbF9lc3RpbWF0ZXMubGFyZ2Vfc3Bvb2wuMi8zJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0ZXJpYWxSZXN1bHRzLmdyYW0gPCA5MDkpIHtcclxuICAgICAgICAgICAgICAgIG1hdGVyaWFsUmVzdWx0cy5zcG9vbEZyYWN0aW9uID0gdGhpcy5faTE4bi50KCdtYjplc3RpbWF0ZXMubWF0ZXJpYWxfZXN0aW1hdGVzLmxhcmdlX3Nwb29sLjMvMycpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbWF0ZXJpYWxSZXN1bHRzLnNwb29sRnJhY3Rpb24gPSB0aGlzLl9pMThuLnQoJ21iOmVzdGltYXRlcy5tYXRlcmlhbF9lc3RpbWF0ZXMubGFyZ2Vfc3Bvb2wuMysvMycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbWF0ZXJpYWxSZXN1bHRzO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFRpbWVBTVBNKGRhdGUpIHtcclxuICAgICAgICBsZXQgaG91cnMgPSBkYXRlLmdldEhvdXJzKCk7XHJcbiAgICAgICAgbGV0IG1pbnV0ZXMgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICBjb25zdCBhbXBtID0gaG91cnMgPj0gMTIgPyAncG0nIDogJ2FtJztcclxuICAgICAgICBob3VycyA9IGhvdXJzICUgMTI7XHJcbiAgICAgICAgaG91cnMgPSBob3VycyA/IGhvdXJzIDogMTI7IC8vIHRoZSBob3VyICcwJyBzaG91bGQgYmUgJzEyJ1xyXG4gICAgICAgIG1pbnV0ZXMgPSBtaW51dGVzIDwgMTAgPyBgMCR7bWludXRlc31gIDogYCR7bWludXRlc31gO1xyXG4gICAgICAgIGNvbnN0IHN0clRpbWUgPSBgJHtob3Vyc306JHttaW51dGVzfWA7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN0clRpbWUsIGFtcG0gfTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREdXJhdGlvbihzZWNvbmRzKSB7XHJcbiAgICAgICAgY29uc3QgZGF5cyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvICgzNjAwICogMjQpKTtcclxuICAgICAgICBzZWNvbmRzID0gc2Vjb25kcyAtIGRheXMgKiAzNjAwICogMjQ7XHJcbiAgICAgICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKHNlY29uZHMgLyAzNjAwKTtcclxuICAgICAgICBzZWNvbmRzID0gc2Vjb25kcyAtIGhvdXJzICogMzYwMDtcclxuICAgICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gNjApO1xyXG4gICAgICAgIGxldCBkdXJhdGlvbiA9ICcnO1xyXG4gICAgICAgIGlmIChkYXlzID4gMCkge1xyXG4gICAgICAgICAgICBkdXJhdGlvbiArPSBgJHtkYXlzfWQgYDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGhvdXJzID4gMCkge1xyXG4gICAgICAgICAgICBkdXJhdGlvbiArPSBgJHtob3Vyc31oIGA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYCR7ZHVyYXRpb24gKyBtaW51dGVzfW1gO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFRpbWVFc3RpbWF0ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgdGltZVJlc3VsdHMgPSB7fTtcclxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGNvbnN0IGVzdGltYXRlRGF0ZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgKyAxMDAwICogdGhpcy5wcm9wcy5lc3RpbWF0ZUluZm8udGltZSk7XHJcbiAgICAgICAgLy9EQVkgaS5lLiB0b2RheSwgdG9tb3Jyb3cgb3Igd2hhdGV2ZXIgZGF5IG9mIHRoZSB3ZWVrXHJcbiAgICAgICAgaWYgKG5vdy5nZXREYXkoKSA9PSBlc3RpbWF0ZURhdGUuZ2V0RGF5KCkgJiYgdGhpcy5wcm9wcy5lc3RpbWF0ZUluZm8udGltZSA8IDI0ICogNjAgKiA2MCkge1xyXG4gICAgICAgICAgICAvLyBzYW1lIGRheSBhcyB0b2RheSAmIGxlc3MgdGhhbiAyNCBob3Vyc1xyXG4gICAgICAgICAgICB0aW1lUmVzdWx0cy5kYXkgPSB0aGlzLl9pMThuLnQoJ21iOmVzdGltYXRlcy50aW1lX2VzdGltYXRlcy50b2RheScpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobm93LmdldERheSgpICsgMSA9PSBlc3RpbWF0ZURhdGUuZ2V0RGF5KCkgJiYgdGhpcy5wcm9wcy5lc3RpbWF0ZUluZm8udGltZSA8IDQ4ICogNjAgKiA2MCkge1xyXG4gICAgICAgICAgICAvLyBzYW1lIGRheSBhcyB0b21vcnJvdyAmIGxlc3MgdGhhbiA0OCBob3Vyc1xyXG4gICAgICAgICAgICB0aW1lUmVzdWx0cy5kYXkgPSB0aGlzLl9pMThuLnQoJ21iOmVzdGltYXRlcy50aW1lX2VzdGltYXRlcy50b21vcnJvdycpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRpbWVSZXN1bHRzLmRheSA9IHRoaXMuX2kxOG4udChgbWI6ZXN0aW1hdGVzLnRpbWVfZXN0aW1hdGVzLiR7ZXN0aW1hdGVEYXRlLmdldERheSgpfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL1RJTUUgaGg6bW1cclxuICAgICAgICB0aW1lUmVzdWx0cy50aW1lID0gdGhpcy5nZXRUaW1lQU1QTShlc3RpbWF0ZURhdGUpO1xyXG4gICAgICAgIC8vRFVSQVRJT04gZCBoIG1cclxuICAgICAgICB0aW1lUmVzdWx0cy5kdXJhdGlvbiA9IHRoaXMuZ2V0RHVyYXRpb24odGhpcy5wcm9wcy5lc3RpbWF0ZUluZm8udGltZSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aW1lUmVzdWx0cztcclxuICAgIH1cclxuXHJcbiAgICBnZXRNYXRlcmlhbEluZm8oc3Bvb2wsIGJheUluZGV4KSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2hlY2sgc3Bvb2wgZm9yIHNtYXJ0IG9yIGR1bWIgZGF0YSAtPiBvdGhlcndpc2UgZGVmYXVsdCB0byA1dGggZ2VuLlxyXG4gICAgICAgICAqIFB1bGwgbWF0ZXJpYWwgY29sb3IgZnJvbSBzcG9vbCwgYW5kIHByb2Nlc3MgdGhhdCBpbmZvIHRvIGNyZWF0ZSBuZWVkZWQgY29sb3IuXHJcbiAgICAgICAgICogSWYgbm8gbWF0ZXJpYWwgdHlwZSBvciBjb2xvciBhcmUgcHJlc2VudChkdW1iIHNwb29sKSwgc2hvdyBmYWxsYmFjay5cclxuICAgICAgICAgKiBGb3IgYSA2dGgtZ2VuIExBQlMgZXh0cnVkZXIsIHdlIGlnbm9yZSB0aGUgbG9hZGVkIHNwb29sIG1hdGVyaWFsLCBhbmQgc2hvd1xyXG4gICAgICAgICAqIHRoZSB1c2VyLXNlbGVjdGVkIG1hdGVyaWFsLlxyXG4gICAgICAgICAqKi9cclxuICAgICAgICBjb25zdCBoYXNTbWFydFNwb29sID0gc3Bvb2wgJiYgc3Bvb2wudGFnX3VpZCAhPT0gbnVsbDtcclxuICAgICAgICBjb25zdCBoYXNMYWJzRXh0cnVkZXIgPSB0aGlzLnByb3BzLnByaW50ZXIuZ2V0QXR0YWNoZWRFeHRydWRlcnMoKVswXSA9PT0gRXh0cnVkZXJUeXBlRW51bS5tazE0X2U7XHJcbiAgICAgICAgY29uc3QgbWF0ZXJpYWxJbmZvUmVzdWx0cyA9IHt9O1xyXG5cclxuICAgICAgICBpZiAoaGFzU21hcnRTcG9vbCAmJiAhaGFzTGFic0V4dHJ1ZGVyKSB7XHJcbiAgICAgICAgICAgIG1hdGVyaWFsSW5mb1Jlc3VsdHMudHlwZSA9IHNwb29sLm1hdGVyaWFsX3R5cGVcclxuICAgICAgICAgICAgICAgID8gU2xpY2VDb25maWdTdHJpbmdzVG9QcmV0dHlTdHJpbmdzW3Nwb29sLm1hdGVyaWFsX25hbWVdXHJcbiAgICAgICAgICAgICAgICA6IFNsaWNlQ29uZmlnU3RyaW5nc1RvUHJldHR5U3RyaW5nc1snZ2VuZXJpY19tb2RlbCddO1xyXG4gICAgICAgICAgICBtYXRlcmlhbEluZm9SZXN1bHRzLm1hdGVyaWFsQ29sb3JOYW1lID1cclxuICAgICAgICAgICAgICAgIHNwb29sLm1hdGVyaWFsX2NvbG9yX25hbWUgIT09ICcnXHJcbiAgICAgICAgICAgICAgICAgICAgPyBzcG9vbC5tYXRlcmlhbF9jb2xvcl9uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgOiBgQ29sb3IgJHtNYXRlcmlhbERlZmF1bHRzLmRldGVjdGlvbl9lcnJvcn1gO1xyXG4gICAgICAgICAgICBtYXRlcmlhbEluZm9SZXN1bHRzLnJlbWFpbmluZ0NvbG9yID0gZm9ybWF0TWF0ZXJpYWxDb2xvcihzcG9vbCkucmVtYWluaW5nQ29sb3I7XHJcbiAgICAgICAgICAgIG1hdGVyaWFsSW5mb1Jlc3VsdHMubmVlZGVkQ29sb3IgPSBmb3JtYXRNYXRlcmlhbENvbG9yKHNwb29sKS5uZWVkZWRDb2xvcjtcclxuICAgICAgICAgICAgcmV0dXJuIG1hdGVyaWFsSW5mb1Jlc3VsdHM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYmF5SW5kZXggPSAhdGhpcy5faXNOaWwoYmF5SW5kZXgpID8gYmF5SW5kZXggOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBtYXRlcmlhbCA9IHRoaXMucHJvcHMuZXN0aW1hdGVJbmZvLm1hdGVyaWFsW2JheUluZGV4XTtcclxuXHJcbiAgICAgICAgICAgIG1hdGVyaWFsSW5mb1Jlc3VsdHMudHlwZSA9IFNsaWNlQ29uZmlnU3RyaW5nc1RvUHJldHR5U3RyaW5nc1ttYXRlcmlhbF07XHJcbiAgICAgICAgICAgIG1hdGVyaWFsSW5mb1Jlc3VsdHMubmVlZGVkQ29sb3IgPSBNYXRlcmlhbERlZmF1bHRzLmNvbG9yc1ttYXRlcmlhbF07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbWF0ZXJpYWxJbmZvUmVzdWx0cztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0UGF5bG9hZChzcG9vbCwgYmF5SW5kZXgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzaG93U3Bvb2xGcmFjdGlvbjogIXRoaXMucHJvcHMuc3Bvb2xJbmZvLFxyXG4gICAgICAgICAgICByZW1haW5pbmdNYXRlcmlhbEFtb3VudDpcclxuICAgICAgICAgICAgICAgIHNwb29sICYmIHNwb29sLmFtb3VudF9yZW1haW5pbmcgPj0gMFxyXG4gICAgICAgICAgICAgICAgICAgID8gZmlsYW1lbnRMZW5ndGhUb01hc3Moc3Bvb2wuYW1vdW50X3JlbWFpbmluZywgc3Bvb2wubGluZWFyX2RlbnNpdHkpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBudWxsLFxyXG4gICAgICAgICAgICBtYXRlcmlhbEluZm86IHRoaXMuZ2V0TWF0ZXJpYWxJbmZvKHNwb29sLCBiYXlJbmRleCksXHJcbiAgICAgICAgICAgIHNwb29sLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyT25lTWF0ZXJpYWxFc3RpbWF0ZShwYXlsb2FkLCBiYXlJbmRleCkge1xyXG4gICAgICAgIGNvbnN0IHsgbWF0ZXJpYWxJbmZvLCBzaG93U3Bvb2xGcmFjdGlvbiwgcmVtYWluaW5nTWF0ZXJpYWxBbW91bnQsIHNwb29sIH0gPSBwYXlsb2FkO1xyXG4gICAgICAgIGNvbnN0IGhhc0xhYnNFeHRydWRlciA9IHRoaXMucHJvcHMucHJpbnRlci5nZXRBdHRhY2hlZEV4dHJ1ZGVycygpW2JheUluZGV4XSA9PT0gRXh0cnVkZXJUeXBlRW51bS5tazE0X2U7XHJcblxyXG4gICAgICAgIC8vIE1hdGVyaWFsIGVzdGltYXRlIGluZm9cclxuICAgICAgICBjb25zdCBtYXRlcmlhbEVzdGltYXRlcyA9IHRoaXMuZ2V0TWF0ZXJpYWxFc3RpbWF0ZXMoYmF5SW5kZXgpO1xyXG4gICAgICAgIGNvbnN0IG5lZWRlZEdyYW0gPSB0aGlzLl9pMThuLnQoJ21iOmVzdGltYXRlcy5tYXRlcmlhbF9lc3RpbWF0ZXMuZycsIHsgZzogbWF0ZXJpYWxFc3RpbWF0ZXMuZ3JhbSB9KTtcclxuICAgICAgICBjb25zdCByZW1haW5pbmdHcmFtID0gdGhpcy5faTE4bi50KCdtYjplc3RpbWF0ZXMubWF0ZXJpYWxfZXN0aW1hdGVzLmcnLCB7XHJcbiAgICAgICAgICAgIGc6IHJlbWFpbmluZ01hdGVyaWFsQW1vdW50ICE9PSBudWxsID8gTWF0aC5mbG9vcihyZW1haW5pbmdNYXRlcmlhbEFtb3VudCkgOiBudWxsLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBGaWxhbWVudCBjb2xvciwgcGFzc2VkIHRvIHRoZSBzbWFsbCBmaWxhbWVudCBjaXJjbGVzXHJcbiAgICAgICAgY29uc3QgcmVtYWluaW5nTWF0ZXJpYWxEb251dFN0eWxlID0geyBib3JkZXJDb2xvcjogbWF0ZXJpYWxJbmZvLnJlbWFpbmluZ0NvbG9yIH07XHJcbiAgICAgICAgY29uc3QgbmVlZGVkTWF0ZXJpYWxEb251dFN0eWxlID0geyBib3JkZXJDb2xvcjogbWF0ZXJpYWxJbmZvLm5lZWRlZENvbG9yIH07XHJcbiAgICAgICAgY29uc3QgcmVtYWluaW5nTWF0ZXJpYWxEb251dCA9IDxzcGFuIGNsYXNzTmFtZT0ncHJpbWFyeS1kb251dCcgc3R5bGU9e3JlbWFpbmluZ01hdGVyaWFsRG9udXRTdHlsZX0gLz47XHJcbiAgICAgICAgY29uc3QgbmVlZGVkTWF0ZXJpYWxEb251dCA9IDxzcGFuIGNsYXNzTmFtZT0nc2Vjb25kYXJ5LWRvbnV0JyBzdHlsZT17bmVlZGVkTWF0ZXJpYWxEb251dFN0eWxlfSAvPjtcclxuXHJcbiAgICAgICAgY29uc3QgbWF0ZXJpYWxSZW1haW5pbmdQZXJjZW50YWdlID1cclxuICAgICAgICAgICAgc3Bvb2wgJiYgc3Bvb2wub3JpZ2luYWxfYW1vdW50ID4gMFxyXG4gICAgICAgICAgICAgICAgPyBNYXRoLmNlaWwoKHNwb29sLmFtb3VudF9yZW1haW5pbmcgLyBzcG9vbC5vcmlnaW5hbF9hbW91bnQpICogMTAwKVxyXG4gICAgICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIGNvbnN0IG1hdGVyaWFsTmVlZGVkUGVyY2VudGFnZSA9XHJcbiAgICAgICAgICAgIHNwb29sICYmIHNwb29sLm9yaWdpbmFsX2Ftb3VudCA+IDBcclxuICAgICAgICAgICAgICAgID8gTWF0aC5jZWlsKChtYXRlcmlhbEVzdGltYXRlcy5kaXN0YW5jZSAvIHNwb29sLm9yaWdpbmFsX2Ftb3VudCkgKiAxMDApXHJcbiAgICAgICAgICAgICAgICA6IE1hdGguY2VpbCgobWF0ZXJpYWxFc3RpbWF0ZXMuZGlzdGFuY2UgLyBtYXRlcmlhbEVzdGltYXRlcy5zcG9vbExlbmd0aCkgKiAxMDApOyAvLyB0aGlzIGFjY291bnRzIGZvciBkdW1iIHNwb29scyB3aGVyZSB3ZSBkb24ndCBoYXZlIHNwb29sIG9yaWdpbmFsX3ZhbHVlXHJcblxyXG4gICAgICAgIGNvbnN0IGlzU2l4dGhHZW4gPSB0aGlzLnByb3BzLnByaW50ZXIuaXNTaXh0aEdlbigpO1xyXG4gICAgICAgIGNvbnN0IGhhc1NtYXJ0U3Bvb2wgPSBzcG9vbCAmJiBzcG9vbC50YWdfdWlkICE9PSBudWxsO1xyXG4gICAgICAgIGNvbnN0IG1hdGVyaWFsRXJyb3IgPVxyXG4gICAgICAgICAgICBzcG9vbCAmJiAoc3Bvb2wuYW1vdW50X3JlbWFpbmluZyA9PT0gMCB8fCBtYXRlcmlhbE5lZWRlZFBlcmNlbnRhZ2UgPj0gbWF0ZXJpYWxSZW1haW5pbmdQZXJjZW50YWdlKTtcclxuICAgICAgICBjb25zdCBzcG9vbENvdW50ID0gTWF0aC5jZWlsKG1hdGVyaWFsRXN0aW1hdGVzLmRpc3RhbmNlIC8gbWF0ZXJpYWxFc3RpbWF0ZXMuc3Bvb2xMZW5ndGgpO1xyXG5cclxuICAgICAgICBjb25zdCBQcmludE1hdGVyaWFsQmFkZ2VQcm9wcyA9IHtcclxuICAgICAgICAgICAgcHJpbnRlcjogdGhpcy5wcm9wcy5lc3RpbWF0ZUluZm8uYm90VHlwZSxcclxuICAgICAgICAgICAgcHJpbnRlcklzQ29ubmVjdGVkOiB0aGlzLnByb3BzLnByaW50ZXJJc0Nvbm5lY3RlZCxcclxuICAgICAgICAgICAgbWF0ZXJpYWxSZW1haW5pbmdQZXJjZW50YWdlLFxyXG4gICAgICAgICAgICBtYXRlcmlhbE5lZWRlZFBlcmNlbnRhZ2UsXHJcbiAgICAgICAgICAgIHJlbWFpbmluZ01hdGVyaWFsQ29sb3I6IG1hdGVyaWFsSW5mby5yZW1haW5pbmdDb2xvcixcclxuICAgICAgICAgICAgbmVlZGVkTWF0ZXJpYWxDb2xvcjogbWF0ZXJpYWxJbmZvLm5lZWRlZENvbG9yLFxyXG4gICAgICAgICAgICBzaG93TWF0ZXJpYWxFcnJvcjogaXNTaXh0aEdlbiAmJiBoYXNTbWFydFNwb29sICYmIG1hdGVyaWFsRXJyb3IsXHJcbiAgICAgICAgICAgIHNob3dTcG9vbENvdW50OiBzcG9vbENvdW50ID4gMSA/IHNwb29sQ291bnQgOiBudWxsLFxyXG4gICAgICAgICAgICBzdHJva2VXaWR0aDogNS42NyxcclxuICAgICAgICAgICAgcjogMjQsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgbmVlZGVkTWF0ZXJpYWwgPSAoXHJcbiAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICB7bmVlZGVkTWF0ZXJpYWxEb251dH1cclxuICAgICAgICAgICAgICAgIHtuZWVkZWRHcmFtfVxyXG4gICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9e3sgbWFyZ2luTGVmdDogJzNweCcgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAge3RoaXMuX2kxOG4udCgnbWI6ZXN0aW1hdGVzLm1hdGVyaWFsX2VzdGltYXRlcy5zdGF0dXMubmVlZGVkJyl9XHJcbiAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgcmVtYWluaW5nTWF0ZXJpYWwgPVxyXG4gICAgICAgICAgICAvLyBGb3IgYSA2dGgtZ2VuIExBQlMgZXh0cnVkZXIsIHdlIGlnbm9yZSB0aGUgbG9hZGVkIHNwb29sXHJcbiAgICAgICAgICAgICFoYXNMYWJzRXh0cnVkZXIgJiYgKCF0aGlzLl9pc05pbChtYXRlcmlhbFJlbWFpbmluZ1BlcmNlbnRhZ2UpIHx8IG1hdGVyaWFsUmVtYWluaW5nUGVyY2VudGFnZSA+PSAwKSA/IChcclxuICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAge3JlbWFpbmluZ01hdGVyaWFsRG9udXR9XHJcbiAgICAgICAgICAgICAgICAgICAge3JlbWFpbmluZ0dyYW19XHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9e3sgbWFyZ2luTGVmdDogJzNweCcgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLl9pMThuLnQoJ21iOmVzdGltYXRlcy5tYXRlcmlhbF9lc3RpbWF0ZXMuc3RhdHVzLnJlbWFpbmluZycpfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICApIDogbnVsbDtcclxuXHJcbiAgICAgICAgY29uc3QgcmVuZGVyTWF0ZXJpYWxUeXBlID0gKCkgPT4gPGRpdiBjbGFzc05hbWU9J2VzdGltYXRlLXRpdGxlJz57bWF0ZXJpYWxJbmZvLnR5cGV9PC9kaXY+O1xyXG4gICAgICAgIGNvbnN0IHJlbmRlck1hdGVyaWFsQ29sb3JOYW1lID0gKCkgPT4gPGRpdiBjbGFzc05hbWU9J2VzdGltYXRlLXRpdGxlJz57bWF0ZXJpYWxJbmZvLm1hdGVyaWFsQ29sb3JOYW1lfTwvZGl2PjtcclxuICAgICAgICBjb25zdCByZW5kZXJOZWVkZWRNYXRlcmlhbCA9ICgpID0+IDxkaXYgY2xhc3NOYW1lPSdlc3RpbWF0ZS1zdWJ0aXRsZSc+e25lZWRlZE1hdGVyaWFsfTwvZGl2PjtcclxuICAgICAgICBjb25zdCByZW5kZXJSZW1haW5pbmdNYXRlcmlhbCA9ICgpID0+IChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2VzdGltYXRlLXN1YnRpdGxlJz57aGFzU21hcnRTcG9vbCAmJiByZW1haW5pbmdNYXRlcmlhbCA/IHJlbWFpbmluZ01hdGVyaWFsIDogbnVsbH08L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbnN0IHJlbmRlcnNob3dTcG9vbEZyYWN0aW9uID0gKCkgPT4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZXN0aW1hdGUtc3VidGl0bGUnPntzaG93U3Bvb2xGcmFjdGlvbiA/IG1hdGVyaWFsRXN0aW1hdGVzLnNwb29sRnJhY3Rpb24gOiBudWxsfTwvZGl2PlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtYXRlcmlhbC1pbmZvLXdyYXBwZXInIGtleT17YG1hdGVyaWFsRXN0aW1hdGVfJHtiYXlJbmRleH1gfT5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdzcG9vbCc+XHJcbiAgICAgICAgICAgICAgICAgICAgPFByaW50TWF0ZXJpYWxCYWRnZSB7Li4uUHJpbnRNYXRlcmlhbEJhZGdlUHJvcHN9IC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdlc3RpbWF0ZS1kZXRhaWxzJz5cclxuICAgICAgICAgICAgICAgICAgICB7cmVuZGVyTWF0ZXJpYWxUeXBlKCl9XHJcbiAgICAgICAgICAgICAgICAgICAge3JlbmRlck1hdGVyaWFsQ29sb3JOYW1lKCl9XHJcbiAgICAgICAgICAgICAgICAgICAge3JlbmRlck5lZWRlZE1hdGVyaWFsKCl9XHJcbiAgICAgICAgICAgICAgICAgICAge3JlbmRlcnNob3dTcG9vbEZyYWN0aW9uKCl9XHJcbiAgICAgICAgICAgICAgICAgICAge3JlbmRlclJlbWFpbmluZ01hdGVyaWFsKCl9XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJNYXRlcmlhbCgpIHtcclxuICAgICAgICBjb25zdCBzcG9vbEluZm8gPSB0aGlzLnByb3BzLnNwb29sSW5mbztcclxuICAgICAgICBjb25zdCBlc3RUaXRsZSA9ICdtYjplc3RpbWF0ZXMubWF0ZXJpYWxfZXN0aW1hdGVzLnRpdGxlJztcclxuICAgICAgICBjb25zdCBlc3RUaXRsZVBsdXJhbCA9ICdtYjplc3RpbWF0ZXMubWF0ZXJpYWxfZXN0aW1hdGVzLnRpdGxlX3BsdXJhbCc7XHJcbiAgICAgICAgbGV0IHBheWxvYWQ7XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtYXRlcmlhbC1lc3RpbWF0ZSc+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J2VzdGltYXRlLXRpdGxlLW1vZGFsJz5cclxuICAgICAgICAgICAgICAgICAgICB7c3Bvb2xJbmZvID8gdGhpcy5faTE4bi50KGVzdFRpdGxlUGx1cmFsKSA6IHRoaXMuX2kxOG4udChlc3RUaXRsZSl9XHJcbiAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICB7c3Bvb2xJbmZvXHJcbiAgICAgICAgICAgICAgICAgICAgPyBzcG9vbEluZm8ubWFwKChzcG9vbCwgYmF5SW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBwYXlsb2FkID0gdGhpcy5jb25zdHJ1Y3RQYXlsb2FkKHNwb29sLCBiYXlJbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyT25lTWF0ZXJpYWxFc3RpbWF0ZShwYXlsb2FkLCBiYXlJbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIDogKChwYXlsb2FkID0gdGhpcy5jb25zdHJ1Y3RQYXlsb2FkKCkpLCB0aGlzLnJlbmRlck9uZU1hdGVyaWFsRXN0aW1hdGUocGF5bG9hZCkpfVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclRpbWUoKSB7XHJcbiAgICAgICAgY29uc3QgdGltZUVzdGltYXRlcyA9IHRoaXMuZ2V0VGltZUVzdGltYXRlcygpO1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndGltZS1lc3RpbWF0ZSc+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ncmVhZHktYnknPnt0aGlzLl9pMThuLnQoJ21iOmVzdGltYXRlcy50aW1lX2VzdGltYXRlcy5yZWFkeV9ieScpfTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2NhbGVuZGFyJz5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nY2FsZW5kYXItZGV0YWlscyc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdlc3RpbWF0ZWQtZGF5Jz57dGltZUVzdGltYXRlcy5kYXl9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0aW1lJz57dGltZUVzdGltYXRlcy50aW1lLnN0clRpbWV9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdhbXBtJz57dGltZUVzdGltYXRlcy50aW1lLmFtcG19PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGltZyBjbGFzc05hbWU9J2ltYWdlLWNhbGVuZGFyJyBzcmM9e3BhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICdpbWFnZXMvZGF0ZS10aW1lLnN2ZycpfSAvPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZXN0aW1hdGUtZGV0YWlscyc+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2VzdGltYXRlLXRpdGxlJz4ge3RoaXMuX2kxOG4udCgnbWI6ZXN0aW1hdGVzLnRpbWVfZXN0aW1hdGVzLnRpdGxlJyl9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2VzdGltYXRlLXN1YnRpdGxlJz57dGltZUVzdGltYXRlcy5kdXJhdGlvbn08L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCBpc1NpeHRoR2VuID0gdGhpcy5wcm9wcy5wcmludGVyLmlzU2l4dGhHZW4oKTtcclxuICAgICAgICAvLyBUaGUgZXN0aW1hdGVJbmZvIG1heSBuZWVkIHRpbWUgdG8gY2F0Y2ggdXAgdG8gdGhlIG5ld2x5IHNlbGVjdGVkIGJvdFxyXG4gICAgICAgIGlmIChpc1NpeHRoR2VuICYmICghdGhpcy5wcm9wcy5zcG9vbEluZm8gfHwgdGhpcy5wcm9wcy5lc3RpbWF0ZUluZm8ubWFzcy5sZW5ndGggPCAyKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gPExvYWRpbmcgLz47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZXN0aW1hdGUtd2lkZ2V0Jz5cclxuICAgICAgICAgICAgICAgIHt0aGlzLnJlbmRlck1hdGVyaWFsKCl9XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbWlkLW1hcmdpbicgLz5cclxuICAgICAgICAgICAgICAgIHt0aGlzLnJlbmRlclRpbWUoKX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuRXN0aW1hdGVzLmRpc3BsYXlOYW1lID0gJ0VzdGltYXRlcyc7XHJcbkVzdGltYXRlcy5wcm9wVHlwZXMgPSBfLm1lcmdlKHt9LCBGbHV4Q29tcG9uZW50LnByb3BUeXBlcywge1xyXG4gICAgZmx1eDogUmVhY3QuUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxyXG4gICAgcHJpbnRlcjogUmVhY3QuUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxyXG4gICAgZXN0aW1hdGVJbmZvOiBSZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsIC8ve3RpbWUsIG1hc3MsIGJvdFR5cGV9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBFc3RpbWF0ZXM7XHJcbiJdfQ==
