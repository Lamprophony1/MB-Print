'use strict';

const Button = require('eagle-print/views/ui/button.js');

const React = require('react');

const _ = require('lodash');

const FluxComponent = require('eagle-print/views/flux_component');

const Isvg = require('react-inlinesvg');

const UrlConst = require('../../constants/urls').url;

const LinkClickUtils = require('../../utils/linkClick');

const BirdWingError = require('../../croissant').BirdWingError;

const Errors = require('../../errors');

class PrinterDetailsError extends FluxComponent {
  constructor(props) {
    super(props);
    this._actions = this.getFlux().actions.PrinterDetailsActions;
  }

  _getErrStringOverrides(err) {
    const i18n = this.props.flux.getService('TranslationService');
    const bwErrors = BirdWingError.Error;

    switch (err.code) {
      case Errors.MBPluginError.GeneralAuthError:
        return {
          title: i18n.t('mb:errors.authenticating.title'),
          message: i18n.t('mb:errors.authenticating.general')
        };

      case Errors.MBPluginError.DisconnectWhileAuthingError:
        return {
          title: i18n.t('mb:errors.authenticating.title'),
          message: i18n.t('mb:errors.authenticating.connection')
        };

      case bwErrors.kToolNotCalibrated:
        return {
          title: i18n.t('mb:errors.calibration_error.title'),
          message: i18n.t('mb:errors.calibration_error.message')
        };

      case bwErrors.kOutOfFilament:
        return this.props.printer.currentProcess.methods.indexOf('load_filament') > -1 ? {
          title: i18n.t('mb:errors.out_of_filament_error.load_filament_title'),
          message: i18n.t('mb:errors.out_of_filament_error.load_filament_message')
        } : {};

      default:
        return {};
    }
  }

  _getErrInfo(err) {
    const errInfo = Errors.getErrInfo(this.props.printer, err); // apply overrides, for things where we don't want the default message
    // from bwcoreutils (and plugin-generated errors which don't have default
    // messages)

    _.extend(errInfo, this._getErrStringOverrides(err));

    return errInfo;
  }

  _renderButtons(err) {
    const i18n = this.props.flux.getService('TranslationService');
    const printer = this.props.printer;
    const bwAction = BirdWingError.Action;

    const errInfo = this._getErrInfo(err);

    switch (errInfo.action) {
      case Errors.MBPluginErrAction.NONE:
        return [];

      case Errors.MBPluginErrAction.RETRY_AUTH:
        return [this._renderButton('tryAgainButton', i18n.t('mb:errors.button_text.tryAgain'), () => {
          printer.acknowledgeError(err.error_id);
          this.props.flux.actions.printer.authenticate(printer);
        })];

      case Errors.MBPluginErrAction.ACKNOWLEDGE_AND_CLOSE:
        return [this._renderButton('okButton', i18n.t('mb:errors.button_text.OK'), () => {
          printer.acknowledgeError(err.error_id);
          this.props.closePanel();
        })];

      case bwAction.ACKNOWLEDGE:
        return [this._renderButton('okButton', i18n.t('mb:errors.button_text.OK'), () => this._actions.acknowledgeError(printer.getId(), err.error_id))];

      case bwAction.CALIBRATE_Z:
        return [this._renderButton('runZCalButton', i18n.t('mb:errors.button_text.runZCal'), () => {
          printer.acknowledgeError(err.error_id);
          printer.invoke('CalibrateZOffset').done();
        })];

      case Errors.MBPluginErrAction.LOAD_FILAMENT:
        return [this._renderButton('loadFilamentButton', i18n.t('mb:errors.button_text.loadFilament'), () => {
          printer.acknowledgeError(err.error_id);
          const lf = 'load_filament';
          printer.currentProcess.methods.indexOf(lf) > -1 ? printer.invoke('ProcessMethod', [lf]).done() : printer.invoke('LoadFilament').done();
        })];
      //case bwAction.CHANGE_FILAMENT:
      //case bwAction.PREHEAT_TIMEOUT:
      //case bwAction.ZPAUSED:
      //case bwAction.UNLOAD_FILAMENT:

      case bwAction.ATTACH_TOOL:
        return [this._renderButton('okButton', i18n.t('mb:errors.button_text.OK'), () => this._actions.attachExtruder(printer.getId()))];
      //case bwAction.ACKNOWLEDGE_OR_CONTINUE:

      default:
        return [this._renderButton('okButton', i18n.t('mb:errors.button_text.OK'), () => {
          printer.acknowledgeError(err.error_id);
        })];
    }
  }

  _renderButton(key, text, action) {
    return /*#__PURE__*/React.createElement("li", {
      key: key
    }, /*#__PURE__*/React.createElement(Button, {
      type: "secondary confirmButton printerStatusButton",
      label: text,
      onClick: action
    }));
  }

  render() {
    const errInfo = this._getErrInfo(this.props.error);

    if (UrlConst.error[errInfo.error]) {
      return /*#__PURE__*/React.createElement("div", {
        id: "PrinterDetailsInfoContainer"
      }, /*#__PURE__*/React.createElement("div", {
        className: "printerStatus"
      }, /*#__PURE__*/React.createElement("a", {
        className: "supportLink",
        onClick: () => {
          LinkClickUtils.clickAction(this.getFlux(), `{$errInfo.error}_link_clicked`, UrlConst.error[errInfo.error]);
        }
      }, errInfo.title, /*#__PURE__*/React.createElement(Isvg, {
        className: "helperLinkIcon",
        src: "icons/helpful-link.svg"
      }))), /*#__PURE__*/React.createElement("div", null, errInfo.message, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("ul", {
        style: {
          listStyleType: 'none',
          margin: 0,
          padding: 0
        }
      }, this._renderButtons(this.props.error)))));
    } else {
      return /*#__PURE__*/React.createElement("div", {
        id: "PrinterDetailsInfoContainer"
      }, /*#__PURE__*/React.createElement("div", {
        className: "printerStatus"
      }, errInfo.title), /*#__PURE__*/React.createElement("div", null, errInfo.message, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("ul", {
        style: {
          listStyleType: 'none',
          margin: 0,
          padding: 0
        }
      }, this._renderButtons(this.props.error)))));
    }
  }

}

PrinterDetailsError.displayName = 'PrinterDetailsError';
PrinterDetailsError.propTypes = {
  flux: React.PropTypes.object.isRequired,
  printer: React.PropTypes.object.isRequired,
  error: React.PropTypes.object.isRequired,
  closePanel: React.PropTypes.func.isRequired
};
module.exports = PrinterDetailsError;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlByaW50ZXJEZXRhaWxzRXJyb3IuanMiXSwibmFtZXMiOlsiQnV0dG9uIiwicmVxdWlyZSIsIlJlYWN0IiwiXyIsIkZsdXhDb21wb25lbnQiLCJJc3ZnIiwiVXJsQ29uc3QiLCJ1cmwiLCJMaW5rQ2xpY2tVdGlscyIsIkJpcmRXaW5nRXJyb3IiLCJFcnJvcnMiLCJQcmludGVyRGV0YWlsc0Vycm9yIiwiY29uc3RydWN0b3IiLCJwcm9wcyIsIl9hY3Rpb25zIiwiZ2V0Rmx1eCIsImFjdGlvbnMiLCJQcmludGVyRGV0YWlsc0FjdGlvbnMiLCJfZ2V0RXJyU3RyaW5nT3ZlcnJpZGVzIiwiZXJyIiwiaTE4biIsImZsdXgiLCJnZXRTZXJ2aWNlIiwiYndFcnJvcnMiLCJFcnJvciIsImNvZGUiLCJNQlBsdWdpbkVycm9yIiwiR2VuZXJhbEF1dGhFcnJvciIsInRpdGxlIiwidCIsIm1lc3NhZ2UiLCJEaXNjb25uZWN0V2hpbGVBdXRoaW5nRXJyb3IiLCJrVG9vbE5vdENhbGlicmF0ZWQiLCJrT3V0T2ZGaWxhbWVudCIsInByaW50ZXIiLCJjdXJyZW50UHJvY2VzcyIsIm1ldGhvZHMiLCJpbmRleE9mIiwiX2dldEVyckluZm8iLCJlcnJJbmZvIiwiZ2V0RXJySW5mbyIsImV4dGVuZCIsIl9yZW5kZXJCdXR0b25zIiwiYndBY3Rpb24iLCJBY3Rpb24iLCJhY3Rpb24iLCJNQlBsdWdpbkVyckFjdGlvbiIsIk5PTkUiLCJSRVRSWV9BVVRIIiwiX3JlbmRlckJ1dHRvbiIsImFja25vd2xlZGdlRXJyb3IiLCJlcnJvcl9pZCIsImF1dGhlbnRpY2F0ZSIsIkFDS05PV0xFREdFX0FORF9DTE9TRSIsImNsb3NlUGFuZWwiLCJBQ0tOT1dMRURHRSIsImdldElkIiwiQ0FMSUJSQVRFX1oiLCJpbnZva2UiLCJkb25lIiwiTE9BRF9GSUxBTUVOVCIsImxmIiwiQVRUQUNIX1RPT0wiLCJhdHRhY2hFeHRydWRlciIsImtleSIsInRleHQiLCJyZW5kZXIiLCJlcnJvciIsImNsaWNrQWN0aW9uIiwibGlzdFN0eWxlVHlwZSIsIm1hcmdpbiIsInBhZGRpbmciLCJkaXNwbGF5TmFtZSIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsIm9iamVjdCIsImlzUmVxdWlyZWQiLCJmdW5jIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsZ0NBQUQsQ0FBdEI7O0FBQ0EsTUFBTUMsS0FBSyxHQUFHRCxPQUFPLENBQUMsT0FBRCxDQUFyQjs7QUFDQSxNQUFNRSxDQUFDLEdBQUdGLE9BQU8sQ0FBQyxRQUFELENBQWpCOztBQUNBLE1BQU1HLGFBQWEsR0FBR0gsT0FBTyxDQUFDLGtDQUFELENBQTdCOztBQUNBLE1BQU1JLElBQUksR0FBR0osT0FBTyxDQUFDLGlCQUFELENBQXBCOztBQUVBLE1BQU1LLFFBQVEsR0FBR0wsT0FBTyxDQUFDLHNCQUFELENBQVAsQ0FBZ0NNLEdBQWpEOztBQUNBLE1BQU1DLGNBQWMsR0FBR1AsT0FBTyxDQUFDLHVCQUFELENBQTlCOztBQUNBLE1BQU1RLGFBQWEsR0FBR1IsT0FBTyxDQUFDLGlCQUFELENBQVAsQ0FBMkJRLGFBQWpEOztBQUNBLE1BQU1DLE1BQU0sR0FBR1QsT0FBTyxDQUFDLGNBQUQsQ0FBdEI7O0FBRUEsTUFBTVUsbUJBQU4sU0FBa0NQLGFBQWxDLENBQWdEO0FBQzVDUSxFQUFBQSxXQUFXLENBQUNDLEtBQUQsRUFBUTtBQUNmLFVBQU1BLEtBQU47QUFFQSxTQUFLQyxRQUFMLEdBQWdCLEtBQUtDLE9BQUwsR0FBZUMsT0FBZixDQUF1QkMscUJBQXZDO0FBQ0g7O0FBRURDLEVBQUFBLHNCQUFzQixDQUFDQyxHQUFELEVBQU07QUFDeEIsVUFBTUMsSUFBSSxHQUFHLEtBQUtQLEtBQUwsQ0FBV1EsSUFBWCxDQUFnQkMsVUFBaEIsQ0FBMkIsb0JBQTNCLENBQWI7QUFDQSxVQUFNQyxRQUFRLEdBQUdkLGFBQWEsQ0FBQ2UsS0FBL0I7O0FBQ0EsWUFBUUwsR0FBRyxDQUFDTSxJQUFaO0FB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Q0FESjtBQW1CSDtBQUNKOztBQXJMMkM7O0FBd0xoRHhELG1CQUFtQixDQUFDNkQsV0FBcEIsR0FBa0MscUJBQWxDO0FBQ0E3RCxtQkFBbUIsQ0FBQzhELFNBQXBCLEdBQWdDO0FBQzVCcEQsRUFBQUEsSUFBSSxFQUFFbkIsS0FBSyxDQUFDd0UsU0FBTixDQUFnQkMsTUFBaEIsQ0FBdUJDLFVBREQ7QUFFNUIxQyxFQUFBQSxPQUFPLEVBQUVoQyxLQUFLLENBQUN3RSxTQUFOLENBQWdCQyxNQUFoQixDQUF1QkMsVUFGSjtBQUc1QlQsRUFBQUEsS0FBSyxFQUFFakUsS0FBSyxDQUFDd0UsU0FBTixDQUFnQkMsTUFBaEIsQ0FBdUJDLFVBSEY7QUFJNUJ0QixFQUFBQSxVQUFVLEVBQUVwRCxLQUFLLENBQUN3RSxTQUFOLENBQWdCRyxJQUFoQixDQUFxQkQ7QUFKTCxDQUFoQztBQU1BRSxNQUFNLENBQUNDLE9BQVAsR0FBaUJwRSxtQkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG5jb25zdCBCdXR0b24gPSByZXF1aXJlKCdlYWdsZS1wcmludC92aWV3cy91aS9idXR0b24uanMnKTtcclxuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xyXG5jb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XHJcbmNvbnN0IEZsdXhDb21wb25lbnQgPSByZXF1aXJlKCdlYWdsZS1wcmludC92aWV3cy9mbHV4X2NvbXBvbmVudCcpO1xyXG5jb25zdCBJc3ZnID0gcmVxdWlyZSgncmVhY3QtaW5saW5lc3ZnJyk7XHJcblxyXG5jb25zdCBVcmxDb25zdCA9IHJlcXVpcmUoJy4uLy4uL2NvbnN0YW50cy91cmxzJykudXJsO1xyXG5jb25zdCBMaW5rQ2xpY2tVdGlscyA9IHJlcXVpcmUoJy4uLy4uL3V0aWxzL2xpbmtDbGljaycpO1xyXG5jb25zdCBCaXJkV2luZ0Vycm9yID0gcmVxdWlyZSgnLi4vLi4vY3JvaXNzYW50JykuQmlyZFdpbmdFcnJvcjtcclxuY29uc3QgRXJyb3JzID0gcmVxdWlyZSgnLi4vLi4vZXJyb3JzJyk7XHJcblxyXG5jbGFzcyBQcmludGVyRGV0YWlsc0Vycm9yIGV4dGVuZHMgRmx1eENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuXHJcbiAgICAgICAgdGhpcy5fYWN0aW9ucyA9IHRoaXMuZ2V0Rmx1eCgpLmFjdGlvbnMuUHJpbnRlckRldGFpbHNBY3Rpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRFcnJTdHJpbmdPdmVycmlkZXMoZXJyKSB7XHJcbiAgICAgICAgY29uc3QgaTE4biA9IHRoaXMucHJvcHMuZmx1eC5nZXRTZXJ2aWNlKCdUcmFuc2xhdGlvblNlcnZpY2UnKTtcclxuICAgICAgICBjb25zdCBid0Vycm9ycyA9IEJpcmRXaW5nRXJyb3IuRXJyb3I7XHJcbiAgICAgICAgc3dpdGNoIChlcnIuY29kZSkge1xyXG4gICAgICAgICAgICBjYXNlIEVycm9ycy5NQlBsdWdpbkVycm9yLkdlbmVyYWxBdXRoRXJyb3I6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ21iOmVycm9ycy5hdXRoZW50aWNhdGluZy50aXRsZScpLFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGkxOG4udCgnbWI6ZXJyb3JzLmF1dGhlbnRpY2F0aW5nLmdlbmVyYWwnKSxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNhc2UgRXJyb3JzLk1CUGx1Z2luRXJyb3IuRGlzY29ubmVjdFdoaWxlQXV0aGluZ0Vycm9yOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogaTE4bi50KCdtYjplcnJvcnMuYXV0aGVudGljYXRpbmcudGl0bGUnKSxcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBpMThuLnQoJ21iOmVycm9ycy5hdXRoZW50aWNhdGluZy5jb25uZWN0aW9uJyksXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjYXNlIGJ3RXJyb3JzLmtUb29sTm90Q2FsaWJyYXRlZDpcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGkxOG4udCgnbWI6ZXJyb3JzLmNhbGlicmF0aW9uX2Vycm9yLnRpdGxlJyksXHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogaTE4bi50KCdtYjplcnJvcnMuY2FsaWJyYXRpb25fZXJyb3IubWVzc2FnZScpLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY2FzZSBid0Vycm9ycy5rT3V0T2ZGaWxhbWVudDpcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLnByaW50ZXIuY3VycmVudFByb2Nlc3MubWV0aG9kcy5pbmRleE9mKCdsb2FkX2ZpbGFtZW50JykgPiAtMVxyXG4gICAgICAgICAgICAgICAgICAgID8ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBpMThuLnQoJ21iOmVycm9ycy5vdXRfb2ZfZmlsYW1lbnRfZXJyb3IubG9hZF9maWxhbWVudF90aXRsZScpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGkxOG4udCgnbWI6ZXJyb3JzLm91dF9vZl9maWxhbWVudF9lcnJvci5sb2FkX2ZpbGFtZW50X21lc3NhZ2UnKSxcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICA6IHt9O1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfZ2V0RXJySW5mbyhlcnIpIHtcclxuICAgICAgICBjb25zdCBlcnJJbmZvID0gRXJyb3JzLmdldEVyckluZm8odGhpcy5wcm9wcy5wcmludGVyLCBlcnIpO1xyXG5cclxuICAgICAgICAvLyBhcHBseSBvdmVycmlkZXMsIGZvciB0aGluZ3Mgd2hlcmUgd2UgZG9uJ3Qgd2FudCB0aGUgZGVmYXVsdCBtZXNzYWdlXHJcbiAgICAgICAgLy8gZnJvbSBid2NvcmV1dGlscyAoYW5kIHBsdWdpbi1nZW5lcmF0ZWQgZXJyb3JzIHdoaWNoIGRvbid0IGhhdmUgZGVmYXVsdFxyXG4gICAgICAgIC8vIG1lc3NhZ2VzKVxyXG4gICAgICAgIF8uZXh0ZW5kKGVyckluZm8sIHRoaXMuX2dldEVyclN0cmluZ092ZXJyaWRlcyhlcnIpKTtcclxuICAgICAgICByZXR1cm4gZXJySW5mbztcclxuICAgIH1cclxuXHJcbiAgICBfcmVuZGVyQnV0dG9ucyhlcnIpIHtcclxuICAgICAgICBjb25zdCBpMThuID0gdGhpcy5wcm9wcy5mbHV4LmdldFNlcnZpY2UoJ1RyYW5zbGF0aW9uU2VydmljZScpO1xyXG4gICAgICAgIGNvbnN0IHByaW50ZXIgPSB0aGlzLnByb3BzLnByaW50ZXI7XHJcbiAgICAgICAgY29uc3QgYndBY3Rpb24gPSBCaXJkV2luZ0Vycm9yLkFjdGlvbjtcclxuXHJcbiAgICAgICAgY29uc3QgZXJySW5mbyA9IHRoaXMuX2dldEVyckluZm8oZXJyKTtcclxuXHJcbiAgICAgICAgc3dpdGNoIChlcnJJbmZvLmFjdGlvbikge1xyXG4gICAgICAgICAgICBjYXNlIEVycm9ycy5NQlBsdWdpbkVyckFjdGlvbi5OT05FOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICBjYXNlIEVycm9ycy5NQlBsdWdpbkVyckFjdGlvbi5SRVRSWV9BVVRIOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJCdXR0b24oJ3RyeUFnYWluQnV0dG9uJywgaTE4bi50KCdtYjplcnJvcnMuYnV0dG9uX3RleHQudHJ5QWdhaW4nKSwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmludGVyLmFja25vd2xlZGdlRXJyb3IoZXJyLmVycm9yX2lkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5mbHV4LmFjdGlvbnMucHJpbnRlci5hdXRoZW50aWNhdGUocHJpbnRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICBjYXNlIEVycm9ycy5NQlBsdWdpbkVyckFjdGlvbi5BQ0tOT1dMRURHRV9BTkRfQ0xPU0U6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckJ1dHRvbignb2tCdXR0b24nLCBpMThuLnQoJ21iOmVycm9ycy5idXR0b25fdGV4dC5PSycpLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZXIuYWNrbm93bGVkZ2VFcnJvcihlcnIuZXJyb3JfaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmNsb3NlUGFuZWwoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIGNhc2UgYndBY3Rpb24uQUNLTk9XTEVER0U6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckJ1dHRvbignb2tCdXR0b24nLCBpMThuLnQoJ21iOmVycm9ycy5idXR0b25fdGV4dC5PSycpLCAoKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hY3Rpb25zLmFja25vd2xlZGdlRXJyb3IocHJpbnRlci5nZXRJZCgpLCBlcnIuZXJyb3JfaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIGNhc2UgYndBY3Rpb24uQ0FMSUJSQVRFX1o6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckJ1dHRvbigncnVuWkNhbEJ1dHRvbicsIGkxOG4udCgnbWI6ZXJyb3JzLmJ1dHRvbl90ZXh0LnJ1blpDYWwnKSwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmludGVyLmFja25vd2xlZGdlRXJyb3IoZXJyLmVycm9yX2lkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRlci5pbnZva2UoJ0NhbGlicmF0ZVpPZmZzZXQnKS5kb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICBjYXNlIEVycm9ycy5NQlBsdWdpbkVyckFjdGlvbi5MT0FEX0ZJTEFNRU5UOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJCdXR0b24oJ2xvYWRGaWxhbWVudEJ1dHRvbicsIGkxOG4udCgnbWI6ZXJyb3JzLmJ1dHRvbl90ZXh0LmxvYWRGaWxhbWVudCcpLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZXIuYWNrbm93bGVkZ2VFcnJvcihlcnIuZXJyb3JfaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZiA9ICdsb2FkX2ZpbGFtZW50JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRlci5jdXJyZW50UHJvY2Vzcy5tZXRob2RzLmluZGV4T2YobGYpID4gLTFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcHJpbnRlci5pbnZva2UoJ1Byb2Nlc3NNZXRob2QnLCBbbGZdKS5kb25lKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogcHJpbnRlci5pbnZva2UoJ0xvYWRGaWxhbWVudCcpLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIC8vY2FzZSBid0FjdGlvbi5DSEFOR0VfRklMQU1FTlQ6XHJcbiAgICAgICAgICAgIC8vY2FzZSBid0FjdGlvbi5QUkVIRUFUX1RJTUVPVVQ6XHJcbiAgICAgICAgICAgIC8vY2FzZSBid0FjdGlvbi5aUEFVU0VEOlxyXG4gICAgICAgICAgICAvL2Nhc2UgYndBY3Rpb24uVU5MT0FEX0ZJTEFNRU5UOlxyXG4gICAgICAgICAgICBjYXNlIGJ3QWN0aW9uLkFUVEFDSF9UT09MOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJCdXR0b24oJ29rQnV0dG9uJywgaTE4bi50KCdtYjplcnJvcnMuYnV0dG9uX3RleHQuT0snKSwgKCkgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9ucy5hdHRhY2hFeHRydWRlcihwcmludGVyLmdldElkKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIC8vY2FzZSBid0FjdGlvbi5BQ0tOT1dMRURHRV9PUl9DT05USU5VRTpcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyQnV0dG9uKCdva0J1dHRvbicsIGkxOG4udCgnbWI6ZXJyb3JzLmJ1dHRvbl90ZXh0Lk9LJyksICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRlci5hY2tub3dsZWRnZUVycm9yKGVyci5lcnJvcl9pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfcmVuZGVyQnV0dG9uKGtleSwgdGV4dCwgYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGxpIGtleT17a2V5fT5cclxuICAgICAgICAgICAgICAgIDxCdXR0b24gdHlwZT0nc2Vjb25kYXJ5IGNvbmZpcm1CdXR0b24gcHJpbnRlclN0YXR1c0J1dHRvbicgbGFiZWw9e3RleHR9IG9uQ2xpY2s9e2FjdGlvbn0gLz5cclxuICAgICAgICAgICAgPC9saT5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCBlcnJJbmZvID0gdGhpcy5fZ2V0RXJySW5mbyh0aGlzLnByb3BzLmVycm9yKTtcclxuXHJcbiAgICAgICAgaWYgKFVybENvbnN0LmVycm9yW2VyckluZm8uZXJyb3JdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2IGlkPSdQcmludGVyRGV0YWlsc0luZm9Db250YWluZXInPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdwcmludGVyU3RhdHVzJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0nc3VwcG9ydExpbmsnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlua0NsaWNrVXRpbHMuY2xpY2tBY3Rpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Rmx1eCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgeyRlcnJJbmZvLmVycm9yfV9saW5rX2NsaWNrZWRgLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVcmxDb25zdC5lcnJvcltlcnJJbmZvLmVycm9yXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXJySW5mby50aXRsZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJc3ZnIGNsYXNzTmFtZT0naGVscGVyTGlua0ljb24nIHNyYz0naWNvbnMvaGVscGZ1bC1saW5rLnN2ZycgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtlcnJJbmZvLm1lc3NhZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dWxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0U3R5bGVUeXBlOiAnbm9uZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbjogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLl9yZW5kZXJCdXR0b25zKHRoaXMucHJvcHMuZXJyb3IpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC91bD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgPGRpdiBpZD0nUHJpbnRlckRldGFpbHNJbmZvQ29udGFpbmVyJz5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ncHJpbnRlclN0YXR1cyc+e2VyckluZm8udGl0bGV9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAge2VyckluZm8ubWVzc2FnZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx1bFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RTdHlsZVR5cGU6ICdub25lJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RoaXMuX3JlbmRlckJ1dHRvbnModGhpcy5wcm9wcy5lcnJvcil9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3VsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuUHJpbnRlckRldGFpbHNFcnJvci5kaXNwbGF5TmFtZSA9ICdQcmludGVyRGV0YWlsc0Vycm9yJztcclxuUHJpbnRlckRldGFpbHNFcnJvci5wcm9wVHlwZXMgPSB7XHJcbiAgICBmbHV4OiBSZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXHJcbiAgICBwcmludGVyOiBSZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXHJcbiAgICBlcnJvcjogUmVhY3QuUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxyXG4gICAgY2xvc2VQYW5lbDogUmVhY3QuUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcclxufTtcclxubW9kdWxlLmV4cG9ydHMgPSBQcmludGVyRGV0YWlsc0Vycm9yO1xyXG4iXX0=
