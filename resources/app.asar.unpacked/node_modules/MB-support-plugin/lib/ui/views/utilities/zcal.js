'use strict';

const React = require('react');

const DOM = React.DOM;
const ce = React.createElement;

const Isvg = require('react-inlinesvg');

const _ = require('lodash');

const Tooltip = require('eagle-print/views/util/tooltip');

const FluxComponent = require('eagle-print/views/flux_component');

const Button = require('eagle-print/views/ui/button');

const LinkClickUtils = require('../../../utils/linkClick');

const UrlConst = require('../../../constants/urls').url;

const PrinterStateEnum = require('../../../constants').PrinterStateEnum;

const HeaderSelectButton = require('../headerSelectButton');

class ZCal extends FluxComponent {
  constructor(props, context) {
    super(props, context);
    this.i18n = this.props.flux.getService('TranslationService');
    this.logger = this.props.flux.getService('LoggingService');
    this.tracking = this.props.flux.getService('TrackingService');
  }

  onCalibrate() {
    this.props.printer.invoke('CalibrateZOffset').then(() => this.tracking.addEvent({
      name: 'z-calibration'
    })).catch(err => this.logger.error(err));
    this.props.onFinish();
  }

  render() {
    const selectedPrinter = this.props.printer;
    const status = selectedPrinter.getStatus() || {};
    const disabled = status.state === PrinterStateEnum.Busy;
    const button = ce(Button, {
      type: `secondary ${disabled ? 'disabled' : ''}`,
      onClick: disabled ? () => undefined : () => this.onCalibrate()
    }, DOM.span({}, this.i18n.t('mb:zcalibration.button')));
    const buttonTooltip = ce(Tooltip, {
      id: 'zcalTooltip',
      addTo: button,
      placement: 'left',
      content: this.i18n.t('mb:zcalibration.tooltip')
    });
    return DOM.div(_.assign({}, this.props, {
      className: `${this.props.className || ''} printerPanel`
    }), DOM.div({
      className: 'printerPanelHeader'
    }, DOM.div({
      className: 'printerPanelBackButton',
      onClick: this.props.onBack
    }, ce(Isvg, {
      src: 'icons/back-arrow.svg'
    })), DOM.div({
      className: 'printerPanelHeaderLabel'
    }, DOM.h1({}, DOM.a({
      className: 'supportLink',
      onClick: () => {
        LinkClickUtils.clickAction(this.getFlux(), 'Zcal_link_clicked', UrlConst.zCal);
      }
    }, this.i18n.t('mb:zcalibration.header'), ce(Isvg, {
      className: 'helperLinkIcon',
      src: 'icons/helpful-link.svg'
    })))), ce(HeaderSelectButton, {
      flux: this.getFlux(),
      printer: this.props.printer
    }), DOM.div({
      className: 'printerPanelArrowDown',
      onClick: this.props.onClose
    }, ce(Isvg, {
      src: 'icons/back-arrow.svg'
    }))), DOM.div({
      className: 'panel-body'
    }, this.i18n.t('mb:zcalibration.paragraph').split('\n').map(t => DOM.p({
      style: {
        marginBottom: 24
      }
    }, t)), buttonTooltip, status.state === PrinterStateEnum.Busy ? DOM.p('mb:zcalibration.busy') : null));
  }

}

ZCal.propTypes = {
  onBack: React.PropTypes.func,
  onClose: React.PropTypes.func,
  flux: React.PropTypes.object.isRequired,
  printer: React.PropTypes.object.isRequired
};
ZCal.defaultProps = {
  onBack: () => {},
  onClose: () => {},
  onFinish: () => {}
};
module.exports = ZCal;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInpjYWwuanMiXSwibmFtZXMiOlsiUmVhY3QiLCJyZXF1aXJlIiwiRE9NIiwiY2UiLCJjcmVhdGVFbGVtZW50IiwiSXN2ZyIsIl8iLCJUb29sdGlwIiwiRmx1eENvbXBvbmVudCIsIkJ1dHRvbiIsIkxpbmtDbGlja1V0aWxzIiwiVXJsQ29uc3QiLCJ1cmwiLCJQcmludGVyU3RhdGVFbnVtIiwiSGVhZGVyU2VsZWN0QnV0dG9uIiwiWkNhbCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJjb250ZXh0IiwiaTE4biIsImZsdXgiLCJnZXRTZXJ2aWNlIiwibG9nZ2VyIiwidHJhY2tpbmciLCJvbkNhbGlicmF0ZSIsInByaW50ZXIiLCJpbnZva2UiLCJ0aGVuIiwiYWRkRXZlbnQiLCJuYW1lIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsIm9uRmluaXNoIiwicmVuZGVyIiwic2VsZWN0ZWRQcmludGVyIiwic3RhdHVzIiwiZ2V0U3RhdHVzIiwiZGlzYWJsZWQiLCJzdGF0ZSIsIkJ1c3kiLCJidXR0b24iLCJ0eXBlIiwib25DbGljayIsInVuZGVmaW5lZCIsInNwYW4iLCJ0IiwiYnV0dG9uVG9vbHRpcCIsImlkIiwiYWRkVG8iLCJwbGFjZW1lbnQiLCJjb250ZW50IiwiZGl2IiwiYXNzaWduIiwiY2xhc3NOYW1lIiwib25CYWNrIiwic3JjIiwiaDEiLCJhIiwiY2xpY2tBY3Rpb24iLCJnZXRGbHV4IiwiekNhbCIsIm9uQ2xvc2UiLCJzcGxpdCIsIm1hcCIsInAiLCJzdHlsZSIsIm1hcmdpbkJvdHRvbSIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsImZ1bmMiLCJvYmplY3QiLCJpc1JlcXVpcmVkIiwiZGVmYXVsdFByb3BzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFyQjs7QUFDQSxNQUFNQyxHQUFHLEdBQUdGLEtBQUssQ0FBQ0UsR0FBbEI7QUFDQSxNQUFNQyxFQUFFLEdB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bEIsRUFBQUEsTUFBTSxFQUFFLE1BQU0sQ0FBRSxDQURBO0FBRWhCTyxFQUFBQSxPQUFPLEVBQUUsTUFBTSxDQUFFLENBRkQ7QUFHaEI3QixFQUFBQSxRQUFRLEVBQUUsTUFBTSxDQUFFO0FBSEYsQ0FBcEI7QUFNQXlDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjVELElBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xyXG5jb25zdCBET00gPSBSZWFjdC5ET007XHJcbmNvbnN0IGNlID0gUmVhY3QuY3JlYXRlRWxlbWVudDtcclxuY29uc3QgSXN2ZyA9IHJlcXVpcmUoJ3JlYWN0LWlubGluZXN2ZycpO1xyXG5jb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XHJcbmNvbnN0IFRvb2x0aXAgPSByZXF1aXJlKCdlYWdsZS1wcmludC92aWV3cy91dGlsL3Rvb2x0aXAnKTtcclxuY29uc3QgRmx1eENvbXBvbmVudCA9IHJlcXVpcmUoJ2VhZ2xlLXByaW50L3ZpZXdzL2ZsdXhfY29tcG9uZW50Jyk7XHJcbmNvbnN0IEJ1dHRvbiA9IHJlcXVpcmUoJ2VhZ2xlLXByaW50L3ZpZXdzL3VpL2J1dHRvbicpO1xyXG5cclxuY29uc3QgTGlua0NsaWNrVXRpbHMgPSByZXF1aXJlKCcuLi8uLi8uLi91dGlscy9saW5rQ2xpY2snKTtcclxuY29uc3QgVXJsQ29uc3QgPSByZXF1aXJlKCcuLi8uLi8uLi9jb25zdGFudHMvdXJscycpLnVybDtcclxuY29uc3QgUHJpbnRlclN0YXRlRW51bSA9IHJlcXVpcmUoJy4uLy4uLy4uL2NvbnN0YW50cycpLlByaW50ZXJTdGF0ZUVudW07XHJcbmNvbnN0IEhlYWRlclNlbGVjdEJ1dHRvbiA9IHJlcXVpcmUoJy4uL2hlYWRlclNlbGVjdEJ1dHRvbicpO1xyXG5cclxuY2xhc3MgWkNhbCBleHRlbmRzIEZsdXhDb21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMsIGNvbnRleHQpIHtcclxuICAgICAgICBzdXBlcihwcm9wcywgY29udGV4dCk7XHJcbiAgICAgICAgdGhpcy5pMThuID0gdGhpcy5wcm9wcy5mbHV4LmdldFNlcnZpY2UoJ1RyYW5zbGF0aW9uU2VydmljZScpO1xyXG4gICAgICAgIHRoaXMubG9nZ2VyID0gdGhpcy5wcm9wcy5mbHV4LmdldFNlcnZpY2UoJ0xvZ2dpbmdTZXJ2aWNlJyk7XHJcbiAgICAgICAgdGhpcy50cmFja2luZyA9IHRoaXMucHJvcHMuZmx1eC5nZXRTZXJ2aWNlKCdUcmFja2luZ1NlcnZpY2UnKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNhbGlicmF0ZSgpIHtcclxuICAgICAgICB0aGlzLnByb3BzLnByaW50ZXJcclxuICAgICAgICAgICAgLmludm9rZSgnQ2FsaWJyYXRlWk9mZnNldCcpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHRoaXMudHJhY2tpbmcuYWRkRXZlbnQoeyBuYW1lOiAnei1jYWxpYnJhdGlvbicgfSkpXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gdGhpcy5sb2dnZXIuZXJyb3IoZXJyKSk7XHJcbiAgICAgICAgdGhpcy5wcm9wcy5vbkZpbmlzaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZFByaW50ZXIgPSB0aGlzLnByb3BzLnByaW50ZXI7XHJcbiAgICAgICAgY29uc3Qgc3RhdHVzID0gc2VsZWN0ZWRQcmludGVyLmdldFN0YXR1cygpIHx8IHt9O1xyXG4gICAgICAgIGNvbnN0IGRpc2FibGVkID0gc3RhdHVzLnN0YXRlID09PSBQcmludGVyU3RhdGVFbnVtLkJ1c3k7XHJcblxyXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNlKFxyXG4gICAgICAgICAgICBCdXR0b24sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IGBzZWNvbmRhcnkgJHtkaXNhYmxlZCA/ICdkaXNhYmxlZCcgOiAnJ31gLFxyXG4gICAgICAgICAgICAgICAgb25DbGljazogZGlzYWJsZWQgPyAoKSA9PiB1bmRlZmluZWQgOiAoKSA9PiB0aGlzLm9uQ2FsaWJyYXRlKCksXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIERPTS5zcGFuKHt9LCB0aGlzLmkxOG4udCgnbWI6emNhbGlicmF0aW9uLmJ1dHRvbicpKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGNvbnN0IGJ1dHRvblRvb2x0aXAgPSBjZShUb29sdGlwLCB7XHJcbiAgICAgICAgICAgIGlkOiAnemNhbFRvb2x0aXAnLFxyXG4gICAgICAgICAgICBhZGRUbzogYnV0dG9uLFxyXG4gICAgICAgICAgICBwbGFjZW1lbnQ6ICdsZWZ0JyxcclxuICAgICAgICAgICAgY29udGVudDogdGhpcy5pMThuLnQoJ21iOnpjYWxpYnJhdGlvbi50b29sdGlwJyksXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIERPTS5kaXYoXHJcbiAgICAgICAgICAgIF8uYXNzaWduKHt9LCB0aGlzLnByb3BzLCB7IGNsYXNzTmFtZTogYCR7dGhpcy5wcm9wcy5jbGFzc05hbWUgfHwgJyd9IHByaW50ZXJQYW5lbGAgfSksXHJcbiAgICAgICAgICAgIERPTS5kaXYoXHJcbiAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ3ByaW50ZXJQYW5lbEhlYWRlcicgfSxcclxuICAgICAgICAgICAgICAgIERPTS5kaXYoXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdwcmludGVyUGFuZWxCYWNrQnV0dG9uJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljazogdGhpcy5wcm9wcy5vbkJhY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjZShJc3ZnLCB7IHNyYzogJ2ljb25zL2JhY2stYXJyb3cuc3ZnJyB9KVxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIERPTS5kaXYoXHJcbiAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdwcmludGVyUGFuZWxIZWFkZXJMYWJlbCcgfSxcclxuICAgICAgICAgICAgICAgICAgICBET00uaDEoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBET00uYShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzdXBwb3J0TGluaycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljazogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5rQ2xpY2tVdGlscy5jbGlja0FjdGlvbih0aGlzLmdldEZsdXgoKSwgJ1pjYWxfbGlua19jbGlja2VkJywgVXJsQ29uc3QuekNhbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmkxOG4udCgnbWI6emNhbGlicmF0aW9uLmhlYWRlcicpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2UoSXN2Zywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2hlbHBlckxpbmtJY29uJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6ICdpY29ucy9oZWxwZnVsLWxpbmsuc3ZnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgY2UoSGVhZGVyU2VsZWN0QnV0dG9uLCB7IGZsdXg6IHRoaXMuZ2V0Rmx1eCgpLCBwcmludGVyOiB0aGlzLnByb3BzLnByaW50ZXIgfSksXHJcbiAgICAgICAgICAgICAgICBET00uZGl2KFxyXG4gICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAncHJpbnRlclBhbmVsQXJyb3dEb3duJywgb25DbGljazogdGhpcy5wcm9wcy5vbkNsb3NlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2UoSXN2ZywgeyBzcmM6ICdpY29ucy9iYWNrLWFycm93LnN2ZycgfSlcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgRE9NLmRpdihcclxuICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAncGFuZWwtYm9keScgfSxcclxuICAgICAgICAgICAgICAgIHRoaXMuaTE4blxyXG4gICAgICAgICAgICAgICAgICAgIC50KCdtYjp6Y2FsaWJyYXRpb24ucGFyYWdyYXBoJylcclxuICAgICAgICAgICAgICAgICAgICAuc3BsaXQoJ1xcbicpXHJcbiAgICAgICAgICAgICAgICAgICAgLm1hcCh0ID0+IERPTS5wKHsgc3R5bGU6IHsgbWFyZ2luQm90dG9tOiAyNCB9IH0sIHQpKSxcclxuICAgICAgICAgICAgICAgIGJ1dHRvblRvb2x0aXAsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXMuc3RhdGUgPT09IFByaW50ZXJTdGF0ZUVudW0uQnVzeSA/IERPTS5wKCdtYjp6Y2FsaWJyYXRpb24uYnVzeScpIDogbnVsbFxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuWkNhbC5wcm9wVHlwZXMgPSB7XHJcbiAgICBvbkJhY2s6IFJlYWN0LlByb3BUeXBlcy5mdW5jLFxyXG4gICAgb25DbG9zZTogUmVhY3QuUHJvcFR5cGVzLmZ1bmMsXHJcbiAgICBmbHV4OiBSZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXHJcbiAgICBwcmludGVyOiBSZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXHJcbn07XHJcblxyXG5aQ2FsLmRlZmF1bHRQcm9wcyA9IHtcclxuICAgIG9uQmFjazogKCkgPT4ge30sXHJcbiAgICBvbkNsb3NlOiAoKSA9PiB7fSxcclxuICAgIG9uRmluaXNoOiAoKSA9PiB7fSxcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gWkNhbDtcclxuIl19
