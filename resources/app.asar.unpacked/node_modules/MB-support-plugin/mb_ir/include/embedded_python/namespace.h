// Copyright 2015 MakerBot Industries

#ifndef INCLUDE_EMBEDDED_PYTHON_NAMESPACE_H_
#define INCLUDE_EMBEDDED_PYTHON_NAMESPACE_H_

#include "embedded_python/ref.h"

namespace embedded_python {

/// A namespace object is a context in which local python code can run.
/// It is a simple, if slightly inefficient, alternative to using the
/// python C API.  The namespace is initialized to contain only
/// __builtins__, so builtin functions are available.
class EMBEDDED_PYTHON_API Namespace {
  public:
    Namespace();
    ~Namespace();

    /// Bind the given name to the object obj in this namespace.  The
    /// namespace hold its own reference to the object, so the object
    /// will persist even when all other references are destroyed,
    /// until it is removed from the namespace or the namespace is
    /// destroyed.
    void assign(const char * name, const Ref & obj);

    /// Evaluate the single line of given code in the context of this
    /// namespace, and return a new reference to the object that is
    /// the result of this evaluation.
    Ref eval(const char * code);

    /// Execute the given block of code in the context of this namespace
    void exec(const char * code);
  private:
    Ref globals;
};

}  // namespace embedded_python

#endif  // INCLUDE_EMBEDDED_PYTHON_NAMESPACE_H_
