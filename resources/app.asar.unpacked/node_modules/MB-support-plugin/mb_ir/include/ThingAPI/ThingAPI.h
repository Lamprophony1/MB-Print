#pragma once

#include <stddef.h>

#include "ThingAPI/TH_Defines.h"
#include "ThingAPI/TH_GeometricPrimitives.h"

#ifdef __cplusplus
extern "C" {  // only need to export C interface if
              // used by C++ source code
#endif

// General
THING_C_API void THHello();

// Version
THING_C_API void THVersionAPI(unsigned short& oMajor /*out*/,
                           unsigned short& oMinor /*out*/,
                           unsigned short& oPatch /*out*/);

// Returns the version of LibThing binary API uses
THING_C_API void THVersionLibThing(unsigned short& oMajor /*out*/,
	unsigned short& oMinor /*out*/,
	unsigned short& oPatch /*out*/);

THING_C_API void THPrintResultString(THResult result /*in*/);

// Thing
THING_C_API THResult THThingCreate(const char* filePath /*in*/,
                                   THThingRef& oThing /*out*/);
THING_C_API THResult THThingRelease(THThingRef& oThing /*in/out*/);
THING_C_API THResult THThingGetNumModels(const THThingRef& thing /*in*/,
                                         size_t& oCount /*out*/);
THING_C_API THResult THThingGetModels(const THThingRef& thing /*in*/,
                                      size_t length /*in*/,
                                      THModelRef oModels[] /*out*/,
                                      size_t& oCount /*out*/);
THING_C_API THResult THThingGetLimits(const THThingRef& thing /*in*/,
                                      THLimits& limits /*out*/);

THING_C_API THResult THThingGetNumZSlices(const THThingRef& thing /*in*/,
	THScalar layerResolution /*in*/, size_t& oCount /*out*/);

// Thing deos not store the Zlice data. It is generated on the fly for the
// a specified zheight. So the client of the API is repsonsible for
// creating the ZSlizes and releasing it through TZSliceRelease
THING_C_API THResult THThingCreateZSlices(const THThingRef& thing /*in*/,
	THScalar layerResolution /*in*/, 
	size_t length /*in - number of zslices obtained from THThingGetNumZSlices*/, 
	THZSliceRef oZSlices[] /*out*/,
	size_t& oCount /*out - number of slices created*/);

// Model

// Model does not store ZSlice data. It is generated on the fly for the
// a specified zheight. So the client of the API is repsonsible for
// creating the ZSlizes and releasing it through TZSliceRelease
THING_C_API THResult THModelCreateZSlice(const THModelRef& model /*in*/,
                                         THScalar height /*in*/,
                                         THZSliceRef& oZSlice /*out*/);
// ZSlice
THING_C_API THResult THZSliceGetNumLoops(const THZSliceRef& zSlice /*in*/,
                                         size_t& oCount /*out*/);
THING_C_API THResult THZSliceCreateLoops(const THZSliceRef& zSlice /*in*/,
                                      size_t length /*in*/,
                                      THLoopRef oLoops[] /*out*/,
                                      size_t& oCount /*out*/);

THING_C_API THResult THZSliceReleaseLoops(const THZSliceRef& zSlice /*in*/,
	size_t length /*in*/,
	THLoopRef oLoops[] /*out*/,
	size_t& oCount /*out*/);

// See: THModelCreateZSlice
THING_C_API THResult THZSliceRelease(THZSliceRef& oZSlice /*in/out*/);
THING_C_API THResult THZSlicesRelease(size_t length /*in*/, THZSliceRef oZSlice[] /*in/out*/);

// Loops
THING_C_API THResult THLoopGetNumLineSegments(const THLoopRef& loop /*in*/,
                                              size_t& oCount /*out*/);
THING_C_API THResult
THLoopGetLineSegments(const THLoopRef& loop /*in*/,
                      size_t length /*in*/,
                      THLineSegment2D oLineSegments[] /*out*/,
                      size_t& oCount /*out*/);

// Loops created through THZSliceCreateLoops should be relelased through THLoopsRelease
THING_C_API THResult THLoopsRelease(size_t length /*in*/, THLoopRef oLoops[] /*in/out*/);

#ifdef __cplusplus
}
#endif
