// Copyright 2013 Makerbot Industries

#ifndef INCLUDE_GEOMUTILS_LIMITS_H_
#define INCLUDE_GEOMUTILS_LIMITS_H_

#include <cmath>
#include <iostream>  // NOLINT

#include "geomutils/Scalar.h"
#include "geomutils/Vector3.h"
#include "geomutils/Region.h"
#include "geomutils/OpenPath.h"

namespace geomutils {

// That's a few kilometers larger than the build platform in 2012
static const Scalar large = 1e20;

/// Represents a bounding box in three space.
class GEOMUTILS_API Limits {
 public:
  Scalar xMin, xMax, yMin, yMax, zMin, zMax;

  Limits();

  Limits(const Vector3& min, const Vector3& max);

  /// return true if any bound is not set to its limit. false otherwise.
  bool uninitialized() const;

  /// grows the limits to contain a point
  void grow(Scalar p0, Scalar p1, Scalar p2);

  /// tests if a point is contained by the limits
  bool contains(Scalar x, Scalar y, Scalar z) const;

  /// grows the limits to contain a point
  void grow(const Vector3 &p);

  /// grows the limits to contain another limits object (union?)
  void grow(const Limits &other);

  /// grows the limits to contain a region
  void grow(const Region& region);

  /// grows the limits to contain a path
  void grow(const OpenPath& path);

  /// adds inflate to all sides of the limits
  ///
  /// each axis gets inflated half in the positive direction and half in the
  /// negative direction
  void inflate(Scalar inflateX, Scalar inflateY, Scalar inflateZ);

  /// Limits now contains only this one point
  ///
  /// minimum and maximum now equal to p (p written to all mins and maxes)
  void reset(Scalar x, Scalar y, Scalar z);

  /// set each limit to its corresponding limit in other
  void reset(const Limits &other);

  /// how wide is this limit in the x direction
  Scalar deltaX() const;

  /// how wide is this limit in the y direction
  Scalar deltaY() const;

  /// returns a limit centered on x and y, spanning the entire z height
  Limits centeredLimits() const;

  /// return center of the limit's bounds
  Vector3 center() const;

  /// grow the limits about the center in the x-y plane so that deltaX = deltaY
  void tubularZ();
};

/// ostream method for Limits
GEOMUTILS_API std::ostream& operator <<(std::ostream& os, const Limits& l);

}  // namespace geomutils

#endif  // INCLUDE_GEOMUTILS_LIMITS_H_
